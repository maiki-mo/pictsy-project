(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{10:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"update",function(){return U});var r={};n.r(r),n.d(r,"postComment",function(){return Yn}),n.d(r,"postChild",function(){return Zn}),n.d(r,"postArbitraryData",function(){return Jn}),n.d(r,"postJQuerySerialize",function(){return Qn}),n.d(r,"getHtmlForArbitraryData",function(){return Xn}),n.d(r,"showPickupPost",function(){return ea});var i={};n.r(i),n.d(i,"unjoin",function(){return ta}),n.d(i,"changePermission",function(){return na}),n.d(i,"getHtmlForArbitraryData",function(){return aa});var o={};n.r(o),n.d(o,"View",function(){return pa}),n.d(o,"setup",function(){return ma}),n.d(o,"Header",function(){return va}),n.d(o,"Invite",function(){return ga}),n.d(o,"Timeline",function(){return ba}),n.d(o,"Edit",function(){return ya}),n.d(o,"GroupList",function(){return ka}),n.d(o,"ImageList",function(){return wa}),n.d(o,"MemberList",function(){return _a}),n.d(o,"Document",function(){return xa}),n.d(o,"Create",function(){return ja}),n.d(o,"PickupPost",function(){return Ca});var s=n(3),c=n.n(s),l=n(6),u=(n(231),n(2)),d=n(0),h=n.n(d),p=n(31),f=n(294),m=n(118),v=n(189),g=n(34),b=n(66);var y=n(1),k=n(4),w=n.n(k),_=n(45),x=n.n(_),j=n(55),O=n(102),C=n(7),S=n(8),T=n(16),I=n(61);function M(e){return E.apply(this,arguments)}function E(){return(E=Object(l.a)(c.a.mark(function e(t){var n,a,r=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"default",e.next=3,t.fetch("/rpc/notify_count.php?op=count_unread",{},{cache:n});case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function N(e){return e.get("/rpc/index.php",{},{mode:"latest_message_threads2",num:5})}var D=n(300),P=n(28),L=new Map;function U(e,t){"string"==typeof e?L.set(e,t):Object.entries(e).forEach(function(e){var t=Object(P.a)(e,2),n=t[0],a=t[1];L.set(n,a)});var n=Array.from(L.values()).reduce(function(e,t){return e+t},0);b.c(function(e,t){return n>0?"(".concat(n,") ").concat(t):null})}var z=n(14),A=n(12),R=n(13),F=n(44),B=n.n(F),$=n(15),W=n(166),H=n(18),q=n.n(H),G=n(26),K=n(19),V=n(37),Y=n.n(V),Z=n(169),J=n(72),Q=function(e){function t(){return Object(C.a)(this,t),Object(z.a)(this,Object(A.a)(t).apply(this,arguments))}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props.item;return Object(y.a)("li",{className:q()(J.item,Object(T.a)({},J.unread,parseInt(e.unread_num,10)>0))},void 0,Object(y.a)("a",{className:J.link,href:"/messages.php?".concat(Y.a.stringify({thread_id:e.thread_id}))},void 0,e.is_active_thread?Object(y.a)("div",{className:q()(J.icon),style:{backgroundImage:Object(K.b)(e.icon_url["100x100"])}}):Object(y.a)("div",{className:q()(J.icon)}),Object(y.a)("div",{className:J.contentContainer},void 0,Object(y.a)("div",{className:J.name},void 0,e.is_active_thread?w.a.createElement(w.a.Fragment,null,e.is_fanbox_subscriber&&Object(y.a)("span",{className:J.fanboxSubscribingBadge},void 0,"FAN"),e.thread_name,e.is_official&&(e.is_mendako?Object(y.a)("span",{className:J.systemBadge},void 0,"official"):Object(y.a)("span",{className:J.officialBadge},void 0,"official"))):Object($.d)("退会・停止ユーザー")),Object(y.a)("div",{className:J.text},void 0,e.latest_content),Object(y.a)("p",{className:J.date},void 0,Object(Z.b)(Object(G.default)(e.modified_at,"X"))))))}}]),t}(w.a.Component),X=n(125);var ee=function(){var e;return{promise:new Promise(function(t){e=t}),resolve:e,resolved:!1}}(),te=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).state={},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){B()(!ee.resolved,"Mounted a singleton twice"),ee.resolved=!0,ee.resolve(this)}},{key:"componentWillUnmount",value:function(){B()(!1,"Unmounted a singleton")}},{key:"show",value:function(e){this.setState({data:e})}},{key:"close",value:function(){this.setState({data:void 0})}},{key:"render",value:function(){return Object(y.a)(ne,{data:this.state.data})}}]),t}(w.a.Component),ne=function(e){function t(){return Object(C.a)(this,t),Object(z.a)(this,Object(A.a)(t).apply(this,arguments))}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props.data;return Object(y.a)("div",{className:X.container},void 0,Object(y.a)("div",{className:X.header},void 0,Object($.d)("メッセージ")),void 0===e?Object(y.a)("div",{className:X.loadingArea},void 0,Object(y.a)(W.a,{loading:!0})):w.a.createElement(w.a.Fragment,null,Object(y.a)("div",{className:X.scrollArea},void 0,e.message_threads.length>0&&Object(y.a)("ul",{className:X.messageList},void 0,e.message_threads.map(function(e){return Object(y.a)(Q,{item:e},e.thread_id)}))),Object(y.a)("a",{href:"/messages.php",className:X.footer},void 0,Object($.d)("すべて見る"))))}}]),t}(w.a.Component),ae=n(267),re=n(62);var ie,oe=function(){var e;return{promise:new Promise(function(t){e=t}),resolve:e,resolved:!1}}();!function(e){e.All="all",e.Reactions="reaction"}(ie||(ie={}));var se=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).state={filter:ie.All},e.handleFilterChange=function(t){t!==e.state.filter&&e.setState({filter:t})},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){B()(!oe.resolved,"Mounted a singleton twice"),oe.resolved=!0,oe.resolve(this)}},{key:"componentWillUnmount",value:function(){B()(!1,"Unmounted a singleton")}},{key:"show",value:function(e){this.setState({data:e})}},{key:"close",value:function(){this.setState({data:void 0})}},{key:"render",value:function(){return Object(y.a)(ce,{data:this.state.data,filter:this.state.filter,onFilterChange:this.handleFilterChange})}}]),t}(w.a.Component),ce=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).handleClickFilterAll=function(){var t=e.props.onFilterChange;t&&t(ie.All)},e.handleClickFilterReactions=function(){var t=e.props.onFilterChange;t&&t(ie.Reactions)},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this,t=void 0!==this.props.data?this.props.data.items.filter(function(t){return e.props.data.filter.reactions.includes(t.type)}).length:0,n=void 0!==this.props.data&&(this.props.data.imageResponseCount>0||this.props.data.quotationCount>0||this.props.data.isNotAuthorized);return Object(y.a)("div",{className:re.container},void 0,Object(y.a)("div",{className:re.header},void 0,Object($.d)("通知"),Object(y.a)("a",{href:"/setting_info.php",className:re.settingsLink},void 0,Object($.d)("設定"))),void 0===this.props.data?Object(y.a)("div",{className:re.loadingArea},void 0,Object(y.a)(W.a,{loading:!0})):Object(y.a)(w.a.Fragment,{},void 0,t>0&&Object(y.a)("div",{className:re.filter},void 0,Object(y.a)("button",{onClick:this.handleClickFilterAll,className:this.props.filter===ie.All?re.current:""},void 0,Object($.d)("すべて")),Object(y.a)("button",{onClick:this.handleClickFilterReactions,className:this.props.filter===ie.Reactions?re.current:""},void 0,Object($.d)("リアクション"))),Object(y.a)("div",{className:re.scrollArea},void 0,n&&Object(y.a)("ul",{className:re.staticNotifications},void 0,this.props.data.imageResponseCount>0&&Object(y.a)("li",{},void 0,Object(y.a)("a",{href:"/response.php?mode=chk"},void 0,Object(y.a)("span",{className:re.staticNotificationIcon}),Object(y.a)("span",{},void 0,Object($.d)("イメージレスポンスの申請が%(count)件きています",{count:this.props.data.imageResponseCount})))),this.props.data.quotationCount>0&&Object(y.a)("li",{},void 0,Object(y.a)("a",{href:"/quotation.php?type=illust&mode=chk"},void 0,Object(y.a)("span",{className:re.staticNotificationIcon}),Object(y.a)("span",{},void 0,Object($.d)("挿絵利用の申請が%(count)件きています",{count:this.props.data.quotationCount})))),this.props.data.isNotAuthorized&&Object(y.a)("li",{},void 0,Object(y.a)("a",{href:"/setting_user.php"},void 0,Object(y.a)("span",{className:re.staticNotificationIcon}),Object(y.a)("span",{},void 0,Object($.d)("登録したメールアドレスに確認のメールを送りました。メールを開いて認証を完了してください"))))),this.props.data.items.length>0?Object(y.a)("ul",{className:re.notificationList},void 0,this.props.data.items.map(function(t){return e.props.filter===ie.Reactions?e.props.data.filter.reactions.includes(t.type)&&Object(y.a)(ae.a,{item:t,highlight:!0,isNew:!0},t.id):Object(y.a)(ae.a,{item:t,highlight:!0,isNew:!0},t.id)})):!n&&Object(y.a)("div",{className:re.nothing},void 0,Object($.d)("通知はありません")))))}}]),t}(w.a.Component),le=n(63),ue=function(){function e(t){var n=this;Object(C.a)(this,e),this.type=t,this.container="#notification-".concat(this.type),this.buttonContainer=h()(".".concat(this.type),e.container),this.countContainer=h()(".count",this.buttonContainer),this.board="popboard"===t?oe.promise:ee.promise,u.a.d.on("notificationCount",function(e,t){null!=t&&null!=t[n.type]&&n.updateUnreadCount(t[n.type])}),h()(".notification-button",this.buttonContainer).on("click",function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),n.toggle())})}return Object(S.a)(e,null,[{key:"setup",value:function(t){var n=this;this.unreadCount={};var a=h()(".notifications");a.length<1||(this.container=a,e.apiClient=Object(le.b)(t.getState()),t.subscribe(function(){e.apiClient=Object(le.b)(t.getState())}),e.message=new e("message"),e.popboard=new e("popboard"),I.b("Notification.updateCount",function(e){n.updateCount(e)}),I.c("Notification.updateCount",Va.user.unreadCount),this.updateCount(Va.user.unreadCount),this.start())}},{key:"handleTimer",value:function(){var t=Object(l.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.request();case 2:e.timerCount++,e.timer=setTimeout(e.handleTimer,6e4*Math.min(Math.pow(2,e.timerCount),8));case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"start",value:function(){u.a.test.storage&&(this.stop(),this.timer=setTimeout(this.handleTimer,0))}},{key:"stop",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null}},{key:"request",value:function(){var t=Object(l.a)(c.a.mark(function t(){var n,a,r=arguments;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:"default",t.prev=1,t.next=4,M(e.apiClient,n);case 4:a=t.sent,I.c("Notification.updateCount",a),this.updateCount(a),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),t.t0 instanceof le.a&&this.stop();case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return function(){return t.apply(this,arguments)}}()},{key:"updateCount",value:function(e){u.a.d.trigger("notificationCount",e),Object.assign(this.unreadCount,e),"/messages.php"===location.pathname&&e.popboard&&delete e.popboard,U(e)}}]),Object(S.a)(e,[{key:"updateUnreadCount",value:function(e){var t=e,n=h()(".notification-button",this.buttonContainer);t?(t>10&&(t="10+"),this.countContainer.text(t),n.addClass("unread")):(this.countContainer.text("0"),n.removeClass("unread"))}},{key:"toggle",value:function(){var t=this,n=h()(this.container);if(this.buttonContainer.hasClass("active"))u.a.ui.modal.pop();else{u.a.d.trigger({type:"click",button:0});var a=h()(".active",e.container);a.length&&(a.removeClass("active"),u.a.ui.modal.pop()),this.buttonContainer.addClass("active"),n.one("uimodalclose",Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.buttonContainer.removeClass("active"),!t.board){e.next=5;break}return e.next=4,t.board;case 4:e.sent.close();case 5:case"end":return e.stop()}},e,this)}))),u.a.ui.modal.push(n),Object(l.a)(c.a.mark(function n(){var a;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("popboard"!==t.type){n.next=6;break}return n.next=3,D.b(e.apiClient);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,N(e.apiClient);case 8:n.t0=n.sent;case 9:return a=n.t0,n.next=12,t.board;case 12:if(n.t1=a,n.sent.show(n.t1),"message"!==t.type){n.next=16;break}return n.abrupt("return");case 16:t.updateUnreadCount(a.remaining_unread_count),Va.user.unreadCount[t.type]=a.remaining_unread_count,I.c("Notification.updateCount",Va.user.unreadCount),e.updateCount(Va.user.unreadCount),e.request("no-cache");case 21:case"end":return n.stop()}},n,this)}))()}}}]),e}();Object(T.a)(ue,"apiClient",void 0),Object(T.a)(ue,"timerCount",0);var de,he,pe=n(281),fe=n(94),me=n(95),ve=n(401),ge=n(400),be=n(175),ye=n(11),ke=n(32),we=n(36);function _e(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;return{type:he.Show,payload:{open:e,page:t}}}!function(e){e.BugReport="bug",e.FeatureFeedback="feedback",e.FeatureRequest="request",e.Freeform="other"}(de||(de={})),function(e){e.SetPage="pixiv/FeedbackForm/SET_PAGE",e.Show="pixiv/FeedbackForm/SHOW"}(he||(he={}));var xe=function(e){return e.feedback},je=Object(ke.createSelector)(xe,function(e){return e.open}),Oe=Object(ke.createSelector)(xe,function(e){return e.page}),Ce=n(54),Se=n(177),Te=n(291),Ie=n(391),Me=n(153),Ee={isShownExportModal:!1,exportSelectedWork:null};var Ne=n(399),De=n.n(Ne),Pe=n(202),Le={products:null},Ue=me.combineReducers({api:fe.a,feedback:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{open:!1,page:de.BugReport},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.SetPage:var n=t.payload;if(n!==e.page)return Object(ye.a)({},e,{page:n});break;case he.Show:var a=t.payload,r=a.open,i=a.page,o=void 0===i?e.page:i;if(r!==e.open||o!==e.page)return Object(ye.a)({},e,{open:r,page:o});break;default:Object(we.b)(t)}return e},illustGoods:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Pe.a.SuccessFetchItemGroupDetails:var n=t.payload;return Object(ye.a)({},e,{products:n});case Pe.a.ItemGroupDetailReloaded:var a=t.payload,r=a.itemGroup.product.id;return Object(ye.a)({},e,{products:e.products.map(function(e){return e.product.id!==r?e:{product:e.product,goods:a}})});case Pe.a.SuccessEditItemSelling:var i=t.payload,o=i.pixivItemUID,s=i.newSellingState,c=De()(e.products);return c.filter(function(e){return e.goods&&e.goods.pixivItemUID===o}).forEach(function(e){e.goods.isSelling=s}),Object(ye.a)({},e,{products:c});default:Object(we.b)(t)}return e},mute:Ce.a,router:O.e,search:Te.h,spa:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];arguments.length>1&&arguments[1];return e},test:be.a,title:Se.a,chatstory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Me.a.SetNovelBody:var n=t.payload.work;return Object(ye.a)({},e,{exportSelectedWork:n});case Me.a.UnsetNovelBody:return Object(ye.a)({},e,{exportSelectedWork:null});case Me.a.ShowChatstoryExportModal:return Object(ye.a)({},e,{isShownExportModal:!0});case Me.a.HideChatstoryExportModal:return Object(ye.a)({},e,{isShownExportModal:!1});default:Object(we.b)(t)}return e},tagTranslationSuggestion:Ie.b});var ze=n(104),Ae=n(27),Re=n(299),Fe=n(1154),Be=n(317),$e=n(562);var We=function(e){function t(){return Object(C.a)(this,t),Object(z.a)(this,Object(A.a)(t).apply(this,arguments))}return Object(R.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){this.props.spa&&this.trackPageview()}},{key:"componentDidUpdate",value:function(e){var t=e.location.pathname+e.location.search,n=this.props.location.pathname+this.props.location.search;t!==n&&this.trackPageview(n)}},{key:"render",value:function(){return null}},{key:"trackPageview",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.location.pathname+this.props.location.search;void 0!==this.props.ignore&&this.props.ignore.some(function(t){return"string"==typeof t?e===t:t.test(e)})||(this.props.spa?_gaq.push(["_trackPageview",encodeURI(e)]):Object(Be.a)().ga.trackPageview(encodeURI(e)))}}]),t}(w.a.Component);We.defaultProps={ignore:[]};var He=Object($e.a)(Object(j.b)(function(e){return{spa:e.spa}})(We));var qe,Ge={showModal:_e},Ke=Object(j.b)(function(e){return{open:je(e)}},Ge)(function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).state={open:!1},e.handleClick=function(){e.props.showModal()},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return Object(y.a)("div",{className:"toolbar-item"},void 0,Object(y.a)("span",{className:"label","aria-haspopup":"true",onClick:this.handleClick},void 0,Object($.d)("フィードバックを送る")))}}]),t}(w.a.Component)),Ve=n(122),Ye=n(89),Ze=n(42),Je=n(167),Qe=n(65),Xe=n(46);!function(e){e.PC="pc",e.Touch="touch",e.AndroidApp="android",e.iOSApp="ios"}(qe||(qe={}));var et=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).deviceOptions=[{label:Object($.d)("パソコン版"),value:qe.PC},{label:Object($.d)("スマートフォン版"),value:qe.Touch},{label:Object($.d)("Androidアプリ"),value:qe.AndroidApp},{label:Object($.d)("iOSアプリ"),value:qe.iOSApp}],e.handleDeviceChange=function(t){var n=t.value;(0,e.props.onDeviceChange)(n)},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props.disabled;return Object(y.a)(Ze.a,{},void 0,Object(y.a)(Qe.b,{title:Object($.d)("バグが発生した環境を教えてください")},void 0,Object(y.a)(Je.b,{disabled:e,value:this.props.device,options:this.deviceOptions,onChange:this.handleDeviceChange})),Object(y.a)(Qe.b,{title:Object($.d)("バグが起きたページ・機能を教えてください")},void 0,Object(y.a)(Xe.b,{disabled:e,placeholder:Object($.d)("ページや機能名、URLをご入力ください"),value:this.props.reportUrl,onChange:this.props.onReportUrlChange})),Object(y.a)(Qe.b,{title:Object($.d)("バグが起きたのは何をしている時ですか？")},void 0,Object(y.a)(Xe.b,{disabled:e,multiline:!0,rows:3,placeholder:Object($.d)("例：コメントを入力した時\n例：マイピク限定作品を見ようとした時　等"),value:this.props.reproduction,onChange:this.props.onReproductionChange,multilineEnterBehavior:Xe.a.PreferNewline,multilineUseCtrl:!0})),Object(y.a)(Qe.b,{title:Object($.d)("どういうバグが起きましたか？")},void 0,Object(y.a)(Xe.b,{disabled:e,multiline:!0,rows:6,placeholder:Object($.d)("例：コメントの送信ボタンが押せなくなった\n例：画面が真っ白になった　等"),value:this.props.explanation,onChange:this.props.onExplanationChange,multilineEnterBehavior:Xe.a.PreferNewline,multilineUseCtrl:!0})))}}]),t}(w.a.PureComponent);function tt(e){var t=e.disabled;return Object(y.a)(Ze.a,{},void 0,Object(y.a)(Qe.b,{title:Object($.d)("対象の機能と、機能に対するご意見・ご要望を教えてください")},void 0,Object(y.a)(Xe.b,{disabled:t,multiline:!0,rows:4,value:e.opinion,onChange:e.onOpinionChange,multilineEnterBehavior:Xe.a.PreferNewline,multilineUseCtrl:!0})),Object(y.a)(Qe.b,{title:Object($.d)("どのような時に困っていますか？")},void 0,Object(y.a)(Xe.b,{disabled:t,multiline:!0,rows:4,value:e.problem,onChange:e.onProblemChange,multilineEnterBehavior:Xe.a.PreferNewline,multilineUseCtrl:!0})),Object(y.a)(Qe.b,{title:Object($.d)("これまではどのように利用されていましたか？")},void 0,Object(y.a)(Xe.b,{disabled:t,multiline:!0,rows:4,value:e.pastUsage,onChange:e.onPastUsageChange,multilineEnterBehavior:Xe.a.PreferNewline,multilineUseCtrl:!0})))}function nt(e){var t=e.disabled;return Object(y.a)(Ze.a,{},void 0,Object(y.a)(Qe.b,{title:Object($.d)("どんな新機能追加・機能変更を行いたいですか？")},void 0,Object(y.a)(Xe.b,{disabled:t,multiline:!0,rows:4,value:e.request,onChange:e.onRequestChange,multilineEnterBehavior:Xe.a.PreferNewline,multilineUseCtrl:!0})),Object(y.a)(Qe.b,{title:Object($.d)("新機能追加・機能変更で便利になることや、解決する困りごとを教えてください")},void 0,Object(y.a)(Xe.b,{disabled:t,multiline:!0,rows:4,value:e.pitch,onChange:e.onPitchChange,multilineEnterBehavior:Xe.a.PreferNewline,multilineUseCtrl:!0})))}function at(e){return Object(y.a)(Ze.a,{},void 0,Object(y.a)(Qe.b,{title:Object($.d)("ご意見・ご要望をご記入ください")},void 0,Object(y.a)(Xe.b,{disabled:e.disabled,multiline:!0,rows:6,value:e.value,onChange:e.onChange,multilineEnterBehavior:Xe.a.PreferNewline,multilineUseCtrl:!0})))}var rt=function(e,t){return e.post("/rpc/index.php",{},Y.a.stringify(Object(ye.a)({},t,{screen_width:t.screen_width.toString(),screen_height:t.screen_height.toString(),window_width:t.window_width.toString(),window_height:t.window_height.toString(),mode:"post_feedback"})))};function it(){var e=Object(Ve.a)(["\n# その他のご意見・ご要望\n\n## ご意見・ご要望をご記入ください\n\n","\n"]);return it=function(){return e},e}function ot(){var e=Object(Ve.a)(["\n# 新機能・機能変更のリクエスト\n\n## どんな新機能追加・機能変更を行いたいですか？\n\n","\n\n## 新機能追加・機能変更で便利になることや、解決する困りごとを教えてください\n\n","\n"]);return ot=function(){return e},e}function st(){var e=Object(Ve.a)(["\n# 機能変更へのフィードバック\n\n## 対象の機能と、機能に対するご意見・ご要望を教えてください\n\n","\n\n## どのような時に困っていますか？\n\n","\n\n## これまではどのように利用されていましたか？\n\n","\n"]);return st=function(){return e},e}function ct(){var e=Object(Ve.a)(["\n# バグの報告\n\n## バグが発生した環境を教えてください\n\n","\n\n## バグが起きたページ・機能を教えてください\n\n","\n\n## バグが起きたのは何をしている時ですか？\n\n","\n\n## どういうバグが起きましたか？\n\n","\n"]);return ct=function(){return e},e}var lt=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).state={invalid:!0,busy:!1,finished:!1,device:qe.PC,reportUrl:location.href,reproduction:"",explanation:"",opinion:"",pastUsage:"",problem:"",request:"",pitch:"",freeform:""},e.pageOptions=[{label:Object($.d)("バグの報告"),value:de.BugReport},{label:Object($.d)("機能変更へのフィードバック"),value:de.FeatureFeedback},{label:Object($.d)("新機能・機能変更のリクエスト"),value:de.FeatureRequest},{label:Object($.d)("その他のご意見・ご要望"),value:de.Freeform}],e.initialReportUrl=e.state.reportUrl,e.handleChangePage=function(t){(0,e.props.onPageChange)(t.value)},e.handleDeviceChange=function(t){e.setState({device:t})},e.handleReportUrlChange=function(t){e.setState({reportUrl:t})},e.handleReproductionChange=function(t){e.setState({reproduction:t})},e.handleExplanationChange=function(t){e.setState({explanation:t})},e.handleOpinionChange=function(t){e.setState({opinion:t})},e.handleProblemChange=function(t){e.setState({problem:t})},e.handlePastUsageChange=function(t){e.setState({pastUsage:t})},e.handleRequestChange=function(t){e.setState({request:t})},e.handlePitchChange=function(t){e.setState({pitch:t})},e.handleFreeformChange=function(t){e.setState({freeform:t})},e.handleSubmit=function(){var t=Object(l.a)(c.a.mark(function t(n){var a,r,i,o,s;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),!e.state.invalid&&!e.state.busy){t.next=3;break}return t.abrupt("return");case 3:return e.setState({busy:!0}),t.prev=4,a=e.props,r=a.client,i=a.page,o=i===de.BugReport?"bug":i===de.FeatureFeedback?"feedback":i===de.FeatureRequest?"request":i===de.Freeform?"freeform":Object(K.i)(i),s=ut(i,e.state),t.next=10,Promise.all([rt(r,{text:s,kind:o,origin_url:location.href,screen_width:window.screen.width||"?",screen_height:window.screen.height||"?",window_width:window.outerWidth||"?",window_height:window.outerHeight||"?"}),Object(Ye.b)(500)]);case 10:e.setState({finished:!0}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),alert(Object($.d)("フィードバックの送信に失敗しました"));case 16:return t.prev=16,e.setState({busy:!1}),t.finish(16);case 19:case"end":return t.stop()}},t,this,[[4,13,16,19]])}));return function(e){return t.apply(this,arguments)}}(),e.handleFinishedSubmit=function(t){t.preventDefault(),(0,e.props.onFinish)()},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"componentDidUpdate",value:function(e,t){var n=function(e,t){switch(e){case de.BugReport:var n=t.reportUrl,a=t.reproduction,r=t.explanation;return!(n&&a&&r);case de.FeatureFeedback:var i=t.opinion,o=t.problem,s=t.pastUsage;return!(i&&o&&s);case de.FeatureRequest:var c=t.request,l=t.pitch;return!(c&&l);case de.Freeform:return!t.freeform}return Object(K.i)(e)}(this.props.page,this.state);n!==this.state.invalid&&this.setState({invalid:n}),t.device!==this.state.device&&(this.state.device===qe.PC?""===this.state.reportUrl.trim()&&this.setState({reportUrl:this.initialReportUrl}):this.state.reportUrl===this.initialReportUrl&&this.setState({reportUrl:""}))}},{key:"render",value:function(){var e=this.props.page,t=this.state.finished;return Object(y.a)(Ze.d,{show:!0,onBackgroundClick:this.props.onClose,minWidth:500,topAlign:!0,onSubmit:t?this.handleFinishedSubmit:this.handleSubmit},void 0,t?Object(y.a)(ht,{onClose:this.props.onClose}):Object(y.a)("div",{},void 0,Object(y.a)(Ze.c,{onCloseClick:this.props.onClose},void 0,Object($.d)("フィードバックを送る")),Object(y.a)(Ze.a,{},void 0,Object(y.a)("p",{style:{margin:"24px 0",lineHeight:1.5}},void 0,Object($.d)("pixivでは今後の開発の参考にするため、フィードバックを募集しています。%(br)あなたが使っていて感じたこと、見つけた問題をお寄せください。%(br)いただいた内容すべてに返信することはできませんが、開発メンバーみんなで目を通しています。",{br:Object(y.a)("br",{})}))),Object(y.a)(Ze.a,{},void 0,Object(y.a)(Je.b,{disabled:this.state.busy,value:e,options:this.pageOptions,onChange:this.handleChangePage})),e===de.BugReport?Object(y.a)(et,{disabled:this.state.busy,device:this.state.device,reportUrl:this.state.reportUrl,reproduction:this.state.reproduction,explanation:this.state.explanation,onDeviceChange:this.handleDeviceChange,onReportUrlChange:this.handleReportUrlChange,onReproductionChange:this.handleReproductionChange,onExplanationChange:this.handleExplanationChange}):e===de.FeatureFeedback?Object(y.a)(tt,{disabled:this.state.busy,opinion:this.state.opinion,problem:this.state.problem,pastUsage:this.state.pastUsage,onOpinionChange:this.handleOpinionChange,onProblemChange:this.handleProblemChange,onPastUsageChange:this.handlePastUsageChange}):e===de.FeatureRequest?Object(y.a)(nt,{disabled:this.state.busy,request:this.state.request,pitch:this.state.pitch,onRequestChange:this.handleRequestChange,onPitchChange:this.handlePitchChange}):e===de.Freeform?Object(y.a)(at,{disabled:this.state.busy,value:this.state.freeform,onChange:this.handleFreeformChange}):Object(K.i)(e),Object(y.a)(Ze.b,{cancelButton:!1,okButtonLabel:Object($.d)("送信"),okButtonDisabled:this.state.invalid||this.state.busy})))}}]),t}(w.a.PureComponent);function ut(e,t){switch(e){case de.BugReport:var n=t.device,a=t.reportUrl,r=t.reproduction,i=t.explanation;return dt(ct(),n===qe.PC?"パソコン版":n===qe.Touch?"スマートフォン版":n===qe.AndroidApp?"Androidアプリ":n===qe.iOSApp?"iOSアプリ":Object(K.i)(n),a,r,i).trim();case de.FeatureFeedback:var o=t.opinion,s=t.problem,c=t.pastUsage;return dt(st(),o,s,c).trim();case de.FeatureRequest:var l=t.request,u=t.pitch;return dt(ot(),l,u).trim();case de.Freeform:return dt(it(),t.freeform).trim()}return Object(K.i)(e)}function dt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return e.reduce(function(e,t,a,r){return a<r.length-1?e.concat(t,n[a].toString().replace(/^/gm,"> ")):e.concat(t)},"")}function ht(e){var t=e.onClose;return Object(y.a)("div",{},void 0,Object(y.a)(Ze.c,{onCloseClick:t},void 0,Object($.d)("ありがとうございました！")),Object(y.a)(Ze.a,{},void 0,Object(y.a)("p",{style:{margin:"24px 0",lineHeight:1.5}},void 0,Object($.d)("サイトは随時アップデートしていきます。%(br)また何かお気付きの点ありましたら、お気軽にフィードバックをお寄せください。",{br:Object(y.a)("br",{})}))),Object(y.a)(Ze.b,{cancelButton:!1,okButtonLabel:Object($.d)("閉じる")}))}var pt={setPage:function(e){return{type:he.SetPage,payload:e}},showModal:_e};var ft=Object(j.b)(function(e){return{client:Object(le.b)(e),open:je(e),page:Oe(e)}},pt)(function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).handleClose=function(){e.props.showModal(!1)},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return this.props.open?Object(y.a)(lt,{client:this.props.client,page:this.props.page,onPageChange:this.props.setPage,onFinish:this.handleClose,onClose:this.handleClose}):null}}]),t}(w.a.Component)),mt=n(160),vt=n(96),gt=n(145),bt=n(303),yt=n(271),kt=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).handleClose=function(){(0,e.props.onClose)()},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return Object(y.a)(Ze.d,{onBackgroundClick:this.handleClose,show:this.props.show,isForm:!1},void 0,Object(y.a)(Ze.c,{onCloseClick:this.handleClose},void 0,Object($.d)("ミュート設定")),Object(y.a)("section",{className:q()(yt.body,{premium:this.props.isPremium})},void 0,Object(y.a)("div",{className:yt.description},void 0,Object($.d)("特定のクリエイターの作品や、タグのついた作品を非表示にすることができます。")),Object(y.a)(bt.a,{isPremium:this.props.isPremium,muteItems:this.props.muteItems,context:this.props.context})))}}]),t}(w.a.PureComponent);var wt=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).handleClose=function(){e.props.dispatch(gt.close())},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return void 0!==this.props.context?Object(y.a)(kt,{show:!0,isPremium:this.props.isPremium,muteItems:this.props.items,context:this.props.context,onClose:this.handleClose},"".concat(this.props.context,"-").concat(this.props.contextId)):null}}]),t}(w.a.Component),_t=Object(j.b)(function(e){return{isPremium:vt.b(e),items:e.mute.modal.items,context:e.mute.modal.context,contextId:e.mute.modal.contextId}})(wt),xt=n(200),jt=n(24),Ot=n(278),Ct=n(41);function St(e){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ct.a("/ajax/sketch/live/following",{},t));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var It,Mt,Et=n(284),Nt=n(146),Dt=n.n(Nt),Pt=n(97),Lt=Object(K.g)("card",Pt),Ut=3;function zt(){var e=u.a.storage.localStorage(It.LastShownItemIds)||[];return new Set(e)}function At(e){var t=e.map(function(e){return e.id});u.a.storage.localStorage(It.LastShownItemIds,t,864e5)}!function(e){e.LastShownItemIds="SketchLive.LastShownItemIds"}(It||(It={})),function(e){e.LastFetchedItems="SketchLive.lastFetchedItems"}(Mt||(Mt={}));var Rt=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).state={lastShownItemIds:new Set,visibleItems:[],queuedItems:new Map},e.updateVisibleItems=Object(l.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.hovered){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Promise.resolve();case 4:e.setState(function(t){var n=Ut-t.visibleItems.length;if(n<=0||0===t.queuedItems.size)return null;var a=Bt(n,t.queuedItems),r=Object(P.a)(a,2),i=r[0],o=r[1],s=i.map(function(e){return e[1]}),c=new Map(o),l=t.visibleItems.concat(s);return s.forEach(function(t){e.livingItemIds.add(t.id),setTimeout(function(){e.killItemById(t.id)},5e3)}),{visibleItems:l,queuedItems:c}});case 5:case"end":return t.stop()}},t,this)})),e.handleMouseEnter=function(){e.hovered=!0},e.handleMouseLeave=function(){e.hovered=!1;var t=!0,n=!1,a=void 0;try{for(var r,i=e.state.visibleItems[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;e.livingItemIds.has(o.id)||e.removeItemById(o.id)}}catch(e){n=!0,a=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}},e.handleClick=function(t){var n=t.currentTarget.dataset.id;e.killItemById(n)},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.livingItemIds=new Set,this.hovered=!1,I.b(Mt.LastFetchedItems,function(e){t.updateFetchedItemsAndQueuedItems(e)}),this.setState({lastShownItemIds:zt()}),e.t0=this,e.next=7,this.getLives();case 7:e.t1=e.sent,e.t0.updateFetchedItemsAndQueuedItems.call(e.t0,e.t1),this.intervalId=window.setInterval(Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,t.getLives();case 3:e.t1=e.sent,e.t0.updateFetchedItemsAndQueuedItems.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)})),3e5);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){I.a(Mt.LastFetchedItems),clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this;return Object(y.a)(Nt.TransitionGroup,{className:Pt.cardContainer,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},void 0,this.state.visibleItems.map(function(t){return Object(y.a)(Nt.CSSTransition,{classNames:Lt,timeout:2e3,onExited:e.updateVisibleItems},t.id,Object(y.a)(Ft,{item:t,onClick:e.handleClick}))}))}},{key:"getLives",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,St({cache:3e5});case 2:return At(t=e.sent),I.c(Mt.LastFetchedItems,t),e.abrupt("return",t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateFetchedItemsAndQueuedItems",value:function(e){this.setState(function(t){var n=new Map(t.queuedItems);return e.filter(function(e){return!t.lastShownItemIds.has(e.id)}).forEach(function(e){return n.set(e.id,e)}),{lastShownItemIds:new Set(e.map(function(e){return e.id})),queuedItems:n}},this.updateVisibleItems)}},{key:"killItemById",value:function(e){this.livingItemIds.delete(e),this.hovered||this.removeItemById(e)}},{key:"removeItemById",value:function(e){this.setState(function(t){return{visibleItems:t.visibleItems.filter(function(t){return t.id!==e})}})}}]),t}(w.a.Component);function Ft(e){var t=e.item,n=e.onClick;return Object(y.a)("a",{className:Pt.notificationCard,href:t.url,target:"_blank",rel:"noopener","data-id":t.id,onClick:n},void 0,Object(y.a)("div",{className:Pt.userIcon},void 0,Object(y.a)(Et.a,{size:48,url:t.iconUrl})),Object(y.a)("div",{className:Pt.text},void 0,Object(y.a)("div",{className:Pt.line},void 0,Object(u.b)("%(userName)さんがお絵描き配信をしています",{userName:t.userName})),Object(y.a)("div",{className:q()(Pt.line,Pt.name)},void 0,t.name)))}function Bt(e,t){var n=Array.from(t);return[n.splice(0,e),n]}var $t=Object(jt.b)(function(){return n.e(13).then(n.bind(null,1153))});function Wt(){return Object(y.a)(w.a.Fragment,{},void 0,Object(y.a)(jt.a,{id:"notification-message",allowMissing:!0},void 0,Object(y.a)(te,{})),Object(y.a)(jt.a,{id:"notification-popboard",allowMissing:!0},void 0,Object(y.a)(se,{})),Object(y.a)(jt.a,{id:"js-mount-point-following-edit-menu",allowMissing:!0},void 0,Object(y.a)(Ht,{modalType:"followingEdit",isPremium:!!Va.user.premium})),Object(y.a)(jt.a,{id:"js-mount-point-sketch-notification",allowMissing:!0},void 0,Object(y.a)(Rt,{})),Object(y.a)(jt.a,{id:"js-mount-point-touch-switcher-tutorial-modal",allowMissing:!0},void 0,Object(y.a)($t,{})))}var Ht=Object(Ot.a)(function(e){return{userId:e.userId,menuText:e.menuText}})(Object(jt.b)(function(){return n.e(12).then(n.bind(null,1152))})),qt=Object(jt.b)(function(){return n.e(14).then(n.bind(null,1086))});function Gt(){return Object(y.a)(w.a.Fragment,{},void 0,Object(y.a)(Ae.b,{path:"/howto/search",id:"js-knowhow-thumbnail-collection",optional:!0,component:qt}),Object(y.a)(Ae.b,{path:"/howto",exact:!0,id:"js-knowhow-thumbnail-collection",optional:!0,component:qt}),Object(y.a)(Ae.b,{path:"/howto/category/:parentCategoryId/:childCategoryName",id:"js-knowhow-thumbnail-collection",optional:!0,component:qt}))}n(314);var Kt,Vt=n(201),Yt=["/discovery/category"],Zt=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).staticRoutes=function(){0;return Object(y.a)(w.a.Fragment,{},void 0,Object(y.a)(Re.a,{exact:!0,path:"/",component:Va.user.loggedIn?Object(jt.b)(function(){return Promise.all([n.e(0),n.e(51)]).then(n.bind(null,1093))}):Object(jt.b)(function(){return n.e(50).then(n.bind(null,1085))})}),Object(y.a)(Re.a,{path:"(/member_illust\\.php|/novel/show\\.php)",exact:!0,component:Object(jt.b)(function(){return n.e(49).then(n.bind(null,1092))})}),Object(y.a)(Re.a,{path:"/novel/preview.php",exact:!0,component:Object(jt.b)(function(){return n.e(48).then(n.bind(null,1147))})}),Object(y.a)(Re.a,{path:"/howto",component:Gt}),Object(y.a)(Re.a,{path:"(/manage/illusts/|/manage/novels/)",exact:!0,component:Object(jt.b)(function(){return n.e(47).then(n.bind(null,1075))})}),Object(y.a)(Re.a,{path:"/content_upload_fix.php",component:Object(jt.b)(function(){return n.e(46).then(n.bind(null,1145))})}),Object(y.a)(Re.a,{path:"(/upload\\.php|/member_illust_mod\\.php)",exact:!0,component:Object(jt.b)(function(){return n.e(45).then(n.bind(null,1076))})}),Object(y.a)(Ae.b,{path:"/user/:userId/series",exact:!0,id:"js-mount-point-illust-series-creator",optional:!0,component:Object(jt.b)(function(){return Promise.all([n.e(2),n.e(1),n.e(44)]).then(n.bind(null,1142))})}),Object(y.a)(Ae.b,{path:"/search.php",id:"js-mount-point-search-result-list",component:Object(jt.b)(function(){return Promise.all([n.e(0),n.e(43)]).then(n.bind(null,1179))})}),Object(y.a)(Ae.b,{path:"/bookmark_new_illust(|_r18).php",id:"js-mount-point-latest-following",component:Object(jt.b)(function(){return Promise.all([n.e(0),n.e(42)]).then(n.bind(null,1140))})}),Object(y.a)(Ae.b,{path:"/discovery",id:"js-mount-point-discovery",component:Object(jt.b)(function(){return Promise.all([n.e(0),n.e(41)]).then(n.bind(null,1101))})}),Object(y.a)(Ae.b,{path:"/setting_mute.php",id:"js-mount-point-setting-mute",component:Object(jt.b)(function(){return n.e(40).then(n.bind(null,1094))})}),Object(y.a)(Ae.b,{path:"/upload.php",id:"js-mount-point-booth-link-tutorial",optional:!0,component:Object(jt.b)(function(){return n.e(39).then(n.bind(null,1139))})}),Object(y.a)(Ae.b,{path:"/notify_all.php",id:"js-mount-point-notification-all",component:Object(jt.b)(function(){return n.e(38).then(n.bind(null,1138))})}),Object(y.a)(Ae.b,{path:"/setting_info.php",id:"js-mount-point-setting-info",optional:!0,component:Object(jt.b)(function(){return n.e(37).then(n.bind(null,1137))})}),Object(y.a)(Ae.b,{path:"(/bookmark_new_illust\\.php|bookmark_new_illust_r18\\.php)",id:"js-mount-point-web-push-follow-new-banner",optional:!0,component:Object(jt.b)(function(){return n.e(36).then(n.bind(null,1136))})}),Object(y.a)(Ae.b,{path:"(/novel/upload\\.php|/novel/mod\\.php)",id:"js-mount-point-novel-upload-form",optional:!0,component:Object(jt.b)(function(){return n.e(35).then(n.bind(null,1099))})}),Object(y.a)(Ae.b,{path:"(/novel/upload\\.php|/novel/mod\\.php)",id:"js-mount-point-novel-reserve-form",optional:!0,component:Object(jt.b)(function(){return n.e(34).then(n.bind(null,1135))})}),Object(y.a)(Re.a,{path:"/novel/show.php",optional:!0,component:Object(jt.b)(function(){return n.e(33).then(n.bind(null,1134))})}),Object(y.a)(Ae.b,{path:"/showcase/",id:"js-mount-point-showcase",component:Object(jt.b)(function(){return n.e(32).then(n.bind(null,1104))})}),Object(y.a)(Ae.b,{path:"/idea/",exact:!0,id:"js-mount-point-idea-anniversary",component:Object(jt.b)(function(){return Promise.all([n.e(0),n.e(31)]).then(n.bind(null,1087))})}),Object(y.a)(Re.a,{path:"/history.php",exact:!0,component:Object(jt.b)(Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(8).then(n.bind(null,392));case 2:return e.abrupt("return",e.sent.HistoryController);case 3:case"end":return e.stop()}},e,this)})))}),Object(y.a)(Ae.b,{path:"/user/:userId/illust/:illustId/goods",exact:!0,id:"js-mount-point-illust-goods",component:Object(jt.b)(function(){return n.e(30).then(n.bind(null,1097))})}),Object(y.a)(Re.a,{path:"(/bookmark\\.php|/bookmark_detail\\.php|/bookmark_add\\.php)",exact:!0,component:Object(jt.b)(function(){return n.e(29).then(n.bind(null,1090))})}),Object(y.a)(Ae.b,{path:"/goods/orders",exact:!0,id:"js-mount-point-goods-orders-index",component:Object(jt.b)(function(){return n.e(28).then(n.bind(null,1074))})}),Object(y.a)(Ae.b,{path:"/goods/orders/:orderId",exact:!0,id:"js-mount-point-goods-orders-detail",component:Object(jt.b)(function(){return n.e(27).then(n.bind(null,1133))})}),Object(y.a)(Ae.b,{path:"/goods/sales",exact:!0,id:"js-mount-point-goods-sales",component:Object(jt.b)(function(){return n.e(26).then(n.bind(null,1078))})}),Object(y.a)(Ae.b,{path:"/goods/deposits",exact:!0,id:"js-mount-point-goods-deposits",component:Object(jt.b)(function(){return n.e(25).then(n.bind(null,1132))})}),Object(y.a)(Ae.b,{path:"/goods/deposit_request",exact:!0,id:"js-mount-point-goods-deposit-request",component:Object(jt.b)(function(){return n.e(24).then(n.bind(null,1131))})}),Object(y.a)(Ae.b,{path:"/point/",exact:!0,id:"js-mount-point-p-point-page",component:Object(jt.b)(function(){return Promise.all([n.e(4),n.e(23)]).then(n.bind(null,1091))})}),Object(y.a)(Ae.b,{path:"/point/gained/",exact:!0,id:"js-mount-point-p-point-page",component:Object(jt.b)(function(){return Promise.all([n.e(4),n.e(22)]).then(n.bind(null,1130))})}),Object(y.a)(Ae.b,{path:"/point/charge/",exact:!0,id:"js-mount-point-p-point-page",component:Object(jt.b)(function(){return n.e(21).then(n.bind(null,1129))})}),Object(y.a)(Ae.b,{path:"/upload.php",exact:!0,optional:!0,id:"js-mount-point-twitter-connect",component:Object(jt.b)(function(){return n.e(20).then(n.bind(null,1128))})}),Object(y.a)(Ae.b,{path:"/setting_sns_post/",exact:!0,id:"js-mount-point-setting-sns-post",component:Object(jt.b)(function(){return n.e(19).then(n.bind(null,1127))})}),Object(y.a)(Ae.b,{path:"/premium/edit/term",optional:!0,id:"js-mount-point-premium-edit-term",component:Object(jt.b)(function(){return n.e(18).then(n.bind(null,1126))})}),Object(y.a)(Ae.b,{path:"/",exact:!0,optional:!0,id:"js-mount-point-index-long-term-plan-tutorial",component:Object(jt.b)(function(){return n.e(17).then(n.bind(null,1125))})}),Object(y.a)(Ae.b,{path:"/premium.php",optional:!0,id:"js-mount-point-lp-long-term-plan-tutorial",component:Object(jt.b)(function(){return n.e(16).then(n.bind(null,1124))})}),Object(y.a)(Ae.b,{path:"/premium/edit/select/",optional:!0,id:"js-mount-point-premium-edit-long-term-plan-tutorial",component:Object(jt.b)(function(){return n.e(15).then(n.bind(null,1123))})}))}(),e.renderGlobalToolbar=function(e){var t=e.match&&!Va.user.loggedIn||e.location.pathname.startsWith("/fanbox")?null:Object(y.a)(Ke,{});return Object(y.a)(mt.a,{},void 0,t)},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return Object(y.a)(xt.b,{},void 0,Object(y.a)(Vt.b,{},void 0,Object(y.a)(He,{ignore:Yt}),Object(y.a)(ze.a,{}),Object(y.a)(_t,{}),Object(y.a)(ft,{}),Object(y.a)(Re.a,{path:"/",exact:!0},void 0,this.renderGlobalToolbar),Object(y.a)(Wt,{}),this.staticRoutes))}}]),t}(w.a.Component),Jt=Object(Fe.a)(Zt);function Qt(e){var t=document.createElement("div");t.style.display="none",document.body.appendChild(t);var n=function(){void 0===Kt&&(Kt=Object(pe.a)());return Kt}(),a=function(e,t){var n=me.applyMiddleware.apply(me,[ge.a,Object(O.d)(e)].concat([])),a=Object(ve.composeWithDevTools)(n);return me.createStore(Ue,t,a)}(n);Object(Se.c)(a),a.dispatch(Object(be.d)()),e&&a.dispatch(Object(fe.d)(e));var r=Object(ze.b)();void 0!==r&&(Object(ze.e)(a),a.dispatch(r)),ue.setup(a),x.a.render(Object(y.a)(j.a,{store:a},void 0,Object(y.a)(O.a,{history:n},void 0,Object(y.a)(Jt,{}))),t)}var Xt=n(78);function en(){return(en=Object(l.a)(c.a.mark(function e(){var t,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]?a[0]:Object($.a)(),e.t0=t,e.next="ja"===e.t0?4:"zh-CN"===e.t0?8:"zh-TW"===e.t0?12:"ko"===e.t0?16:20;break;case 4:return e.next=6,n.e(59).then(n.bind(null,1122));case 6:return G.default.locale("ja"),e.abrupt("return");case 8:return e.next=10,n.e(58).then(n.bind(null,1121));case 10:return G.default.locale("zh-cn"),e.abrupt("return");case 12:return e.next=14,n.e(57).then(n.bind(null,1120));case 14:return G.default.locale("zh-tw"),e.abrupt("return");case 16:return e.next=18,n.e(56).then(n.bind(null,1119));case 18:return G.default.locale("ko"),e.abrupt("return");case 20:G.default.locale("en");case 21:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var tn=n(162),nn=n(287),an=n(29),rn=n(213);function on(){window.addEventListener("message",function(e){var t=e.data;if("https://d.pixiv.org"!==e.origin)return;null!==t&&"object"===Object(an.a)(t)&&"ad_group_increment"===t.status&&function(e){var t=rn.a("ads_".concat(e.zone)),n=u.a.storage.cookie("limited_ads"),a={};n&&(a=JSON.parse(n));t||(t={});for(var r=Object.keys(t),i=[],o=[],s=0;s<e.ad_groups.length;s++){var c=e.ad_groups[s];if(t[c.id])t[c.id].il=c.impLimit,t[c.id].cl=c.clickLimit,t[c.id].e||(t[c.id].e=c.expire);else{var l=new Date;c.expire?l.setTime(l.getTime()+36e5*parseInt(c.expire,10)):l.setTime(l.getTime()+2592e6),t[c.id]={i:0,il:c.impLimit,c:0,cl:c.clickLimit,e:l.toUTCString()}}parseInt(e.id,10)===c.id&&(t[c.id].i+=1),i.push(c.id),t[c.id].i>=t[c.id].il&&o.push(c.id)}for(var d=new Date,h=0;h<r.length;h++)if(i.includes(parseInt(r[h],10))||delete t[r[h]],t[r[h]]){var p=new Date(t[r[h]].e);p<d&&delete t[r[h]]}a[e.zone]=o.join("~"),u.a.storage.cookie("limited_ads",JSON.stringify(a),{expires:5184e6}),rn.b("ads_".concat(e.zone),t)}(t)},!1)}var sn=n(30),cn=function(){function e(){Object(C.a)(this,e),Object(T.a)(this,"type","bookuser"),this.preference=void 0,this.button=void 0,this.groups=void 0}return Object(S.a)(e,[{key:"initialize",value:function(){var e=this;this.preference=h()("#favorite-preference"),this.button=h()("#favorite-button").on("click",function(t){return e.toggle(t)})}},{key:"toggle",value:function(e){e.preventDefault(),this.preference.is(":visible")?this.close():this.open()}},{key:"open",value:function(){this.groups||this.initializePreferenceContainer(),this.preference.show(),this.button.hasClass("added")&&this.button.addClass("open")}},{key:"initializePreferenceContainer",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,a=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(g.screen.register(this),h()("div.close",this.preference).on("click",this.close.bind(this)),h()("input.remove",this.preference).on("click",this.remove.bind(this)),Va.user.premium){e.next=5;break}return e.abrupt("return");case 5:return h()("select",this.preference).on("change",function(e){var t=e.currentTarget;"new"===t.value&&1===t.selectedIndex&&a.addGroup()}),e.next=8,p.e.getList(this.type);case 8:t=e.sent,n=t.tag_a,this.groups=Array.isArray(n)?n:Object.keys(n),h()("select",this.preference).append(this.makeGroup(this.groups)).parent().removeClass("loading").end().prop("disabled",!1);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"makeGroup",value:function(e){return[].concat(e).map(u.a.html.escape).map(function(e){return'<option value="'.concat(e,'">').concat(e,"</option>")}).join("")}},{key:"addGroup",value:function(){var e=window.prompt("新規フォルダー名を指定してください");if(e&&(e=e.replace(/ +/g,"").trim())){this.groups.push(e),this.groups.sort();var t=this.groups.indexOf(e);t=-1===t?1:t+1,h()(this.makeGroup(e)).insertAfter(h()("option",this.preference).eq(t)).prop("selected",!0)}}},{key:"close",value:function(){return this.preference.hide(),this.button.removeClass("open"),!1}},{key:"add",value:function(){}},{key:"remove",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.e.remove(this.type,Va.context.userId),this.removed(),e.next=4,t;case 4:this.preference.hasClass("js-renewal-mypixiv")&&location.reload();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removed",value:function(){this.button.removeClass("following").addClass("follow").find(".text").text(this.button.dataset("textFollow")),e.toggleIcons(this.button,!1),h()("form",this.preference).attr("action","/bookmark_add.php").append('<input type="hidden" name="mode" value="add">').find("input.remove").remove(),this.close()}}],[{key:"toggleIcons",value:function(e,t){e.find("._icon.on").toggleClass("_hidden",!t),e.find("._icon.off").toggleClass("_hidden",t)}},{key:"toggleWhenFavorites",value:function(e){h()(".js-toggle-when-favorite.on").toggleClass("_hidden",!e),h()(".js-toggle-when-favorite.off").toggleClass("_hidden",e)}},{key:"follow",value:function(){var e=h()("#favorite-button");e.hasClass("js-toggle-when-favorite")||e.removeClass("follow").addClass("following").find(".text").text(e.dataset("textFollowing")),this.toggleIcons(e,!0),this.toggleWhenFavorites(!0),h()("#favorite-preference").find(".remove").removeClass("_hidden")}},{key:"unfollow",value:function(){var e=h()("#favorite-button");e.hasClass("js-toggle-when-favorite")||e.removeClass("following").addClass("follow").find(".text").text(e.dataset("textFollow")),this.toggleIcons(e,!1),this.toggleWhenFavorites(!1)}}]),e}(),ln=n(98),un=function(e){function t(){var e,n;Object(C.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return n=Object(z.a)(this,(e=Object(A.a)(t)).call.apply(e,[this].concat(r))),Object(T.a)(Object(ln.a)(Object(ln.a)(n)),"type","mypixiv"),n}return Object(R.a)(t,e),Object(S.a)(t,[{key:"initialize",value:function(){var e=this;this.preference=h()("#mypixiv-preference"),this.button=h()("#mypixiv-button"),Va.context.myPixiv&&(this.button.on("click",function(t){return e.toggle(t)}),h()(".js-delete-mypixiv-from-dot-menu").on("click",function(){var t=Object(l.a)(c.a.mark(function t(n){var a,r,i;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.currentTarget.dataset,r=a.userId,i=a.confirmMessage,!confirm(i)){t.next=5;break}return t.next=4,p.e.remove(e.type,r);case 4:location.reload();case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()))}},{key:"removed",value:function(){location.reload()}}]),t}(cn);function dn(){h()(document.body).on("submit",".js-submit-confirm",hn),h()(document.body).on("click",".js-click-confirm",hn)}function hn(e){var t=h()(e.currentTarget).dataset();if(void 0===t.confirmMessage)throw new Error("data-confirm-message is required with class js-submit-confirm");confirm(t.confirmMessage)||e.preventDefault()}var pn=n(117);var fn=n(280),mn=n(152),vn=n.n(mn),gn=n(128),bn=n.n(gn),yn=n(265),kn=n(88),wn=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).state={marginLeft:0},e.handleLeft=function(){e.setState(function(e,t){var n=e.marginLeft+t.itemWidth;return n>0&&(n=0),{marginLeft:n}})},e.handleRight=function(){var t=e.props.itemNum*e.props.itemWidth;e.setState(function(e,n){var a=e.marginLeft-n.itemWidth;return-1*a>t&&(a=t),{marginLeft:a}})},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=Math.floor(-1*this.state.marginLeft/this.props.itemWidth);return Object(y.a)("div",{className:kn.carouselContainer},void 0,Object(y.a)("div",{className:kn.buttonContainer},void 0,e>0&&Object(y.a)("div",{className:q()(kn.button,kn.left),onClick:this.handleLeft})),Object(y.a)("div",{className:kn.itemsContainer},void 0,Object(y.a)("div",{className:kn.carousel,style:{marginLeft:this.state.marginLeft}},void 0,this.props.children)),Object(y.a)("div",{className:kn.buttonContainer},void 0,e<this.props.itemNum-1&&Object(y.a)("div",{className:q()(kn.button,kn.right),onClick:this.handleRight})))}}]),t}(w.a.Component),_n=n(288),xn=n(165),jn=n(56),On=function(e){function t(){return Object(C.a)(this,t),Object(z.a)(this,Object(A.a)(t).apply(this,arguments))}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.inCarousel,a=e.gaCategory,r=e.onFollow;return Object(y.a)("div",{className:q()(jn.recommendUser,Object(T.a)({},jn.carousel,n))},void 0,Object(y.a)("div",{className:jn.userContainer},void 0,Object(y.a)("div",{className:jn.userMetaContainer},void 0,Object(y.a)("div",{className:jn.userIconContainer},void 0,Object(y.a)(xn.a,{later:!0,href:t.linkUrl,gaCategory:"recommend-user-bar",gaAction:"click",gaLabel:"profile"},void 0,Object(y.a)("div",{className:jn.userIcon,style:{backgroundImage:Object(K.b)(t.profileImage)}}))),Object(y.a)("div",{className:jn.userNameContainer},void 0,Object(y.a)(xn.a,{later:!0,className:jn.userName,href:t.linkUrl,gaCategory:"recommend-user-bar",gaAction:"click",gaLabel:"profile"},void 0,t.userName))),Object(y.a)("div",{className:jn.followButtonContainer},void 0,Object(y.a)(_n.a,{userId:t.userId,isFollowing:t.isFollowing,gaCategory:a,onFollow:r}))),Object(y.a)("div",{className:jn.thumbnailContainer},void 0,t.works.map(function(e,t){return e.isMuted?Object(y.a)("div",{className:q()(jn.thumbnail,jn.muted)},"_".concat(t),e.isMuted&&Object(y.a)("div",{className:jn.mutedText},void 0,Object($.d)("ミュート中"))):Object(y.a)(xn.a,{later:!0,href:e.linkUrl,className:q()(jn.thumbnail,Object(T.a)({},jn.novel,"novel"===e.type)),gaCategory:a,gaAction:"click",gaLabel:"work",style:{backgroundImage:Object(K.b)(e.imageUrl)}},e.id,"novel"===e.type&&Object(y.a)("span",{},void 0,e.title))})))}}]),t}(w.a.Component),Cn=n(208),Sn=Object(K.g)("item",Cn);function Tn(e){return Array.from(e,function(e){return{userId:parseInt(e.user_id,10),userName:e.user_name,profileImage:e.profile_img,linkUrl:e.link_url,isFollowing:e.is_follow,works:e.illusts.map(function(e){return{id:e.illust_id,title:e.illust_title,imageUrl:e.url["128x128"],linkUrl:e.link_url,isMuted:e.is_muted,type:"illust"}}).concat(e.novels.map(function(e){return{id:e.id,title:e.title,imageUrl:e.url,linkUrl:e.link_url,isMuted:e.is_muted,type:"novel"}})).slice(0,3)}})}var In=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).state={users:[]},e.handleFollow=function(){var t=Object(l.a)(c.a.mark(function t(n){var a,r,i;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=parseInt(n.currentTarget.dataset.userId,10),t.next=3,yn.a(a,10,3);case 3:if(0!==(r=t.sent).length){t.next=6;break}return t.abrupt("return");case 6:i=Tn(r),e.setState(function(e){return{users:e.users.map(function(e){return e.userId===a?i[0]:e})}});case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yn.a(this.props.userId,10,3);case 2:if(!((t=e.sent).length<2)){e.next=5;break}return e.abrupt("return");case 5:n=Tn(t),this.setState({users:n});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Object(y.a)(bn.a,{component:"div",className:q()(Cn.usersContainer,Object(T.a)({},Cn.carousel,this.props.carousel))},void 0,this.state.users.map(function(t){return Object(y.a)(vn.a,{classNames:Sn,timeout:400},t.userId,Object(y.a)(On,{user:t,inCarousel:e.props.carousel,gaCategory:e.props.gaCategory,onFollow:e.handleFollow}))}));return this.state.users.length>0?this.props.carousel?Object(y.a)(wn,{itemNum:this.state.users.length,itemWidth:336},void 0,t):Object(y.a)("div",{},void 0,t):null}}]),t}(w.a.Component),Mn=n(147),En=Dt.a.TransitionGroup,Nn=Dt.a.CSSTransition,Dn=Object(K.g)("module",Mn);function Pn(e){return Ln.apply(this,arguments)}function Ln(){return(Ln=Object(l.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=function(){x.a.unmountComponentAtNode(n)},null!==(n=document.getElementById("js-mount-point-recommend-users"))&&x.a.render(Object(y.a)(zn,{userId:t,onDismiss:a}),n);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Un,zn=function(e){function t(){var e;return Object(C.a)(this,t),(e=Object(z.a)(this,Object(A.a)(t).apply(this,arguments))).state={visible:!0},e.handleClose=function(){e.setState({visible:!1})},e}return Object(R.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return Object(y.a)(fn.f,{},void 0,Object(y.a)(En,{},void 0,this.state.visible&&Object(y.a)(Nn,{classNames:Dn,appear:!0,enter:!1,timeout:{enter:800,exit:400},onExited:this.props.onDismiss},void 0,Object(y.a)("div",{className:Mn.RecommendUsers},void 0,Object(y.a)("h2",{className:Mn.title},void 0,Object(u.b)("こちらのユーザーもおすすめです")),Object(y.a)(In,{userId:this.props.userId,carousel:!1,gaCategory:"recommend-user-bar"}),Object(y.a)("div",{onClick:this.handleClose,className:Mn.closeButtonContainer},void 0,Object(y.a)("div",{className:Mn.closeButton}))))))}}]),t}(w.a.Component);function An(e,t){var n=h()('.js-follow-button[data-user-id="'.concat(e,'"]'));n.filter(".off").toggleClass("_hidden",t),n.filter(".on").toggleClass("_hidden",!t)}function Rn(e){var t=h()(".js-toggle-message");t.filter(".off").toggleClass("_hidden",e),t.filter(".on").toggleClass("_hidden",!e)}function Fn(e,t){h()('.js-follow-button[data-user-id="'.concat(e,'"]')).toggleClass("busy",t)}function Bn(e){return $n.apply(this,arguments)}function $n(){return($n=Object(l.a)(c.a.mark(function e(t){var n,a,r=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],e.prev=1,Fn(t,!0),e.next=5,p.c(t,n);case 5:if(An(t,!0),t!==Va.context.userId){e.next=13;break}if(cn.follow(),Rn(!0),t===Un){e.next=13;break}return e.next=12,Pn(parseInt(t,10));case 12:Un=t;case 13:(a=h()(".js-follow-edit-tooltip")).length>0&&(a.addClass("show"),u.a.storage.cookie("closed_follow_edit_tooltip","1",{expires:31536e6})),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),alert(u.a.t("フォローに失敗しました"));case 20:return e.prev=20,Fn(t,!1),e.finish(20);case 23:case"end":return e.stop()}},e,this,[[1,17,20,23]])}))).apply(this,arguments)}function Wn(e){return Hn.apply(this,arguments)}function Hn(){return(Hn=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Fn(t,!0),e.next=4,p.m(t);case 4:An(t,!1),t===Va.context.userId&&(cn.unfollow(),Rn(!1)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),alert(u.a.t("フォローの解除に失敗しました"));case 11:return e.prev=11,Fn(t,!1),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}))).apply(this,arguments)}function qn(){h()(".js-gdpr-notify-agree-button").on("click",function(){h()("._gdpr-notify-header").toggleClass("_hidden",!0),h()(".newindex").removeClass("newindex-gdpr"),h()("#header-banner").removeClass("gdpr-notify"),Ct.b("/ajax/privacy_policy_agree")})}var Gn=n(22),Kn=n.n(Gn),Vn=n(50),Yn=function(e,t,n){return sa.post("/group/comment.php",{group_id:e,format:"partial_html",mode:"post",body:t,paint:n})},Zn=function(e,t,n,a,r){return sa.post("/group/comment.php",{group_id:e,format:"partial_html",mode:"post_child",parent_id:t,reply_id:n,body:a,paint:r})},Jn=function(e){return sa.post("/group/comment.php?format=json",e)},Qn=function(e){return sa.post("/group/comment.php",e)},Xn=function(e){return sa.get("/group/comment.php?format=partial_html",e)},ea=function(e,t){return sa.get("/group/comment.php",{format:"json",mode:"show_pickup_post",group_id:e,comment_id:t})},ta=function(e,t){return sa.post("/group/members.php",Object(ye.a)({group_id:e,format:"json",mode:"unjoin"},t))},na=function(e,t){return sa.post("/group/members.php",Object(ye.a)({group_id:e,format:"json",mode:"change_permission"},t))},aa=function(e){return sa.get("/group/members.php?format=partial_html",e)};function ra(e,t,n,a){return ia.apply(this,arguments)}function ia(){return(ia=Object(l.a)(c.a.mark(function e(t,n,a,r){var i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.resolve(u.a.req.to(t,n,a,r));case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),400!==e.t0.status){e.next=15;break}if(!e.t0.responseJSON){e.next=11;break}throw e.t0.responseJSON;case 11:if(!e.t0.responseText){e.next=15;break}try{i=JSON.parse(e.t0.responseText)}catch(e){}if(void 0===i){e.next=15;break}throw i;case 15:if(!e.t0.statusText){e.next=18;break}throw o=e.t0,new Vn.a(o.status,o.statusText);case 18:if(e.t0 instanceof Error){e.next=20;break}throw new Error(e.t0);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,this,[[0,6]])}))).apply(this,arguments)}var oa,sa={get:function(e,t,n){return ra("GET",e,t,n)},post:function(e,t,n){return ra("POST",e,t,n)}};function ca(e){this.container=h()(e).addClass("parsed"),oa||(oa=Kn.a.compile(h()("#template-drawr-paint-ui").html()));var t=u.a.ua.ie&&u.a.ua.v<=8;if(this.container.append(oa({outdated:t})),!t){this.toolbar=this.container.find(".drawr-tools"),this.funcbar=this.container.find(".drawr-functions"),this.width=Math.min(Number(this.container.data("width")),this._maxWidth),this.height=Math.min(Number(this.container.data("height")),this._maxHeight),this.bgColor=this.container.data("bgcolor")||this.bgColor,this.outputTarget=h()("#"+this.container.data("outputid"));var n=this.outputTarget.parents("form");n&&n.on("submit",{self:this},this.convert),this.baseCanvas=h()("<canvas>").css("position","absolute").attr("width",this.width).attr("height",this.height),this.strokeCanvas=this.baseCanvas.clone().css("opacity",""+this.lineAlpha),this.baseCanvas.addClass("base"),this.historyCanvas=h()("<canvas>").attr("width",this._maxWidth).attr("height",this._maxHeight*(this.historyMax+1)),this.canvases=h()(".drawr-canvases",this.container).append(this.baseCanvas).append(this.strokeCanvas).append(h()("<div>").width(this.width).height(this.height)).css("position","relative"),this.baseContext=this.baseCanvas[0].getContext("2d"),this.baseContext.fillStyle=this.bgColor,this.strokeContext=this.strokeCanvas[0].getContext("2d"),this.strokeContext.lineCap="round",this.strokeContext.lineJoin="round",this.historyContext=this.historyCanvas[0].getContext("2d"),this.historyContext.fillStyle=this.bgColor,this.historyContext.fillRect(0,0,this.historyContext.canvas.width,this.historyContext.canvas.height),this.clearCanvas(),this.addHistory(),this.bindStrokeCanvas("brush"),this.strokeCanvas.on("contextmenu",{self:this},this.oncontextmenu),h()(window).on("beforeunload",function(){return"ページを移動すると、お絵かきデータは破棄されます。"}),this.initToolbar(),this.initFuncbar()}}ca.prototype={_mode:null,width:400,height:300,_maxWidth:600,_maxHeight:600,zoomScale:1,maxZoomScale:2,minZoomScale:.5,mouseX:null,mouseY:null,_isMouseDown:!1,_bPrevX:0,_bPrevY:0,container:null,toolbar:null,canvases:null,funcbar:null,baseCanvas:null,baseContext:null,strokeCanvas:null,strokeContext:null,historyCanvas:null,historyContext:null,outputTarget:null,lineAlpha:null,lineWidth:null,lineColor:"#000000",curColorBlock:null,widthSlider:null,alphaToggle:null,bgColor:"#ffffff",colorList:["#000000","#808080","#C0C0C0","#FFFFFF","#FF3B21","#FFBD16","#F5F30F","#A5E975","#71DBFB","#FA80F9","#8E0000","#FFCC99","#877D30","#008F47","#313BCD","#C02E97","#3F037E"],widthList:[1,2,4,6,10,15,30],historyMax:5,_historyIndex:null,_historyUndo:null,_historyRedo:null,_strokeRect:{},bindStrokeCanvas:function(e){var t="mousedown mouseup mousemove mouseout mouseover";this._isMouseDown||this._mode!==e&&(this._mode=e,this.strokeCanvas.off(t),this.strokeCanvas.on(t,{self:this},this["on"+this._mode]))},sliderMouseDown:function(e){var t=e.data.self;t.setUserSelect("none"),h()(document).on("mousemove",{self:t,slider:this},t.sliderMouseMove),h()(document).on("mouseup",{self:t,slider:this},t.sliderMouseUp),t.sliderMouseMove(e)},sliderMouseMove:function(e){var t=e.data.self,n=h()(e.data.slider),a=n.outerWidth(!1)-1,r=n.width()-1,i=t.widthList.length-1,o=e.pageX-(a-r)/2-n.offset().left,s=Math.round(Math.min(Math.max(o,0),r)*i/r),c=t.widthList[s];t.setLineWidth(c),n.find(".nob").trigger("mouseleave").trigger("mouseenter")},sliderMouseUp:function(e){var t=e.data.self,n=h()(e.data.slider).find(".nob");t.setUserSelect("text"),h()(document).off("mousemove",t.sliderMouseMove).off("mouseup",t.sliderMouseUp),e.target!==n[0]&&n.trigger("mouseleave")},canvasResizeMouseMove:function(e){var t=h()(".resize-preview div:first-child"),n=10*Math.round(Math.min(600,Math.max(180,e.pageY-t.offset().top))/10);t.height()!==n&&(t.height(n).css("lineHeight",n+"px"),t.text(t.width()+" x "+t.height()))},canvasResizeMouseDown:function(e){var t=e.data.self,n=h()(".resize-preview div:first-child");h()(document).off("mousemove",t.canvasResizeMouseMove).off("mousedown",t.canvasResizeMouseDown),t.resizeCanvas(n.height()),n.parent().remove()},beginResize:function(){this.container.find(".resize-preview").remove(),h()('<div class="resize-preview" style="position:absolute; z-index: 999;">').append('<div style="width:420px; height:180px; background-color:rgba(80,80,80,0.75); text-align:center; font-weight:bold; font-size:200%; color:#ffffff;">').append('<div style="width:420px; height:40px;">').insertAfter(this.canvases).css("top",this.canvases.position().top),h()(document).on("mousemove",{self:this},this.canvasResizeMouseMove).on("mousedown",{self:this},this.canvasResizeMouseDown)},resizeCanvas:function(e){this.height=e,this.baseCanvas[0].height=this.strokeCanvas[0].height=this.height,this.baseContext.fillStyle=this.bgColor,this.strokeContext.lineCap=this.strokeContext.lineJoin="round",this.strokeCanvas.next().height(this.height),this.clearCanvas(),this._doHistory(0),this._doZoom(1)},saveBackup:function(){try{if(!confirm("一時保存します。すでにこのブラウザに一時保存されているキャンバスは上書きされます。よろしいですか？"))return;localStorage["canvas_backup"+Va.user.id]=JSON.stringify({image:this.baseCanvas[0].toDataURL(),created_at:new Date})}catch(e){alert("一時保存できませんでした")}},loadBackup:function(){try{var e=JSON.parse(localStorage["canvas_backup"+Va.user.id]),t=new Image;t.src=e.image,t.onload=function(e){return function(){e.clearCanvas(),e.baseContext.drawImage(this,0,0),e.addHistory()}}(this)}catch(e){alert("一時保存されたキャンバスが見つかりませんでした")}},initToolbar:function(){var e=this;this.curColorBlock=this.toolbar.find(".drawr-tool-curcolor"),this.widthSlider=this.toolbar.find(".drawr-tool-width"),this.widthSlider.on("mousedown",{self:e,slider:this.widthSlider},this.sliderMouseDown);var t=this.toolbar.find(".drawr-tool-color"),n=t,a=!0,r=!1,i=void 0;try{for(var o,s=function(){var a=o.value;n=t.clone().attr("data-tooltip","色:"+a.toString()).addClass("_ui-tooltip").css("background-color",a.toString()).insertAfter(n).on("click",{self:e,value:a},function(e){e.data.self.setLineColor(e.data.value),e.data.self.toolbar.find(".drawr-tool-color.current").removeClass("current"),h()(a).addClass("current")}),a.toString()===e.lineColor&&n.addClass("current")},c=this.colorList[Symbol.iterator]();!(a=(o=c.next()).done);a=!0)s()}catch(e){r=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}t.remove(),this.alphaToggle=this.toolbar.find(".drawr-tool-alpha").on("change",{self:e},function(e){e.data.self.setLineAlpha(h()(this).is(":checked")?.5:1)}),this.setLineColor(this.container.data("linecolor")||this.lineColor),this.setLineWidth(this.container.data("linewidth")||this.lineWidth||this.widthList[0]),this.setLineAlpha("on"===this.container.data("linealpha")?.5:1)},initFuncbar:function(){this.funcbar.find(".drawr-function-undo").on("click",{self:this},function(e){e.data.self.undo()}),this.funcbar.find(".drawr-function-redo").on("click",{self:this},function(e){e.data.self.redo()}),this.funcbar.find(".drawr-function-zoomin").on("click",{self:this},function(e){e.data.self.zoomin()}),this.funcbar.find(".drawr-function-zoomout").on("click",{self:this},function(e){e.data.self.zoomout()}),this.funcbar.find(".drawr-function-brush").on("click",{self:this},function(e){e.data.self.bindStrokeCanvas("brush")}),this.funcbar.find(".drawr-function-hand").on("click",{self:this},function(e){e.data.self.bindStrokeCanvas("hand")}),this.funcbar.find(".drawr-function-clear").on("click",{self:this},function(e){window.confirm("全消しします。よろしいですか？(この操作はアンドゥ可能です)")&&(e.data.self.clearCanvas(),e.data.self.addHistory())}),this.funcbar.find(".drawr-function-resize").on("click",{self:this},function(e){e.data.self.beginResize()}),u.a.test.storage&&window.JSON&&(this.funcbar.find(".drawr-function-save-backup").on("click",{self:this},function(e){e.data.self.saveBackup()}),this.funcbar.find(".drawr-function-load-backup").on("click",{self:this},function(e){e.data.self.loadBackup()}))},addHistory:function(){var e=this.historyMax+1;null===this._historyUndo?this._historyUndo=1:this._historyIndex-this._historyUndo>=this.historyMax&&(this._historyUndo=this._historyRedo-this.historyMax+1),this._historyIndex++,this._historyRedo=this._historyIndex,this.historyContext.putImageData(this.baseContext.getImageData(0,0,this.width,this.height),0,this._historyIndex%e*this._maxHeight),this.updateHistoryUI()},undo:function(){this._historyIndex>this._historyUndo&&this._doHistory(-1)},redo:function(){this._historyIndex<this._historyRedo&&this._doHistory(1)},_doHistory:function(e){var t=this.historyMax+1;this._historyIndex+=e,this.baseContext.putImageData(this.historyContext.getImageData(0,this._historyIndex%t*this._maxHeight,this._maxWidth,this._maxHeight),0,0),this.updateHistoryUI()},zoomin:function(){this.zoomScale<this.maxZoomScale&&this._doZoom(2)},zoomout:function(){this.zoomScale>this.minZoomScale&&this._doZoom(.5)},_doZoom:function(e){this.zoomScale*=e;for(var t=this.width*this.zoomScale,n=this.height*this.zoomScale,a=[this.baseCanvas,this.strokeCanvas],r=0;r<a.length;r++){var i=a[r];h()(i).css("width",t+"px").css("height",n+"px")}},drag:function(){},updateHistoryUI:function(){this.funcbar.find(".drawr-function-undo").attr("disabled",this._historyIndex<=this._historyUndo),this.funcbar.find(".drawr-function-redo").attr("disabled",this._historyIndex>=this._historyRedo)},clearContext:function(e,t){t?e.clearRect(t.left,t.top,t.right-t.left,t.bottom-t.top):e.clearRect(0,0,this.width,this.height)},clearCanvas:function(){this.baseContext.fillRect(0,0,this._maxWidth,this._maxHeight)},setLineAlpha:function(e){this.lineAlpha!==e&&(this.lineAlpha=e.toString(),this.strokeCanvas.css("opacity",this.lineAlpha),this.curColorBlock.css("opacity",this.lineAlpha),.5===e?this.alphaToggle.prop("checked",!0):this.alphaToggle.removeAttr("checked"))},toggleLineAlpha:function(){this.setLineAlpha(this.alphaToggle.is(":checked")?1:.5)},setLineWidthIndex:function(e){if(!this._isMouseDown){var t,n;switch(Object(an.a)(e)){case"string":t=this.widthList.indexOf(this.lineWidth)+parseInt(e,10);break;case"number":t=e}(n=this.widthList[t])&&(this.setLineWidth(n),this.displayBrushPreview({},this._bPrevX,this._bPrevY))}},setLineWidth:function(e){var t=(this.widthSlider.width()-1)/(this.widthList.length-1);if(this.lineWidth!==e){this.lineWidth=e;var n=this.widthList.indexOf(e);this.widthSlider.find(".nob").css("left",Math.floor(n*t)+"px").attr("data-tooltip","太さ:"+e),this.curColorBlock.css("width",e+"px").css("height",e+"px")}},setLineColor:function(e){this.lineColor=e,this.curColorBlock.css("background-color",this.lineColor).parent().attr("data-tooltip","現在の色:"+this.lineColor.toString()).addClass("_ui-tooltip")},displayBrushPreview:function(e,t,n){var a=.5*this.lineWidth;this.strokeContext.clearRect(this._bPrevX-15,this._bPrevY-15,30,30),"mouseout"!==e.type&&(this.strokeContext.save(),this.strokeContext.beginPath(),this.strokeContext.arc(t,n,a,0,2*Math.PI,!1),this.strokeContext.fillStyle=this.lineColor,this.strokeContext.fill(),this.strokeContext.restore(),this._bPrevX=t,this._bPrevY=n)},setUserSelect:function(e){e=e||"none",h()(document.body).css({"-moz-user-select":e,"-webkit-user-select":e})},getMousePosition:function(e){var t=h()(e.target).offset();return{x:Math.round((e.pageX-t.left)/this.zoomScale),y:Math.round((e.pageY-t.top)/this.zoomScale)}},oncontextmenu:function(e){var t=e.data.self,n=t.getMousePosition(e),a=t.baseContext.getImageData(n.x,n.y,1,1),r=(a.data[0]<<16)+(a.data[1]<<8)+a.data[2];return r="#"+("000000"+r.toString(16)).slice(-6),t.setLineColor(r),t.toolbar.find(".drawr-tool-color.current").removeClass("current"),!1},onbrush:function(e){var t=e.data.self,n=t.getMousePosition(e);if(2!==e.button){if("mousedown"!==e.type&&!t._isMouseDown)return"mouseout"===e.type&&t.setUserSelect("text"),t.displayBrushPreview(e,n.x,n.y),void(t.mouseX=t.mouseY=null);switch(e.type){case"mousedown":t._isMouseDown=!0,t.strokeContext.lineWidth=t.lineWidth,t.strokeContext.strokeStyle=t.lineColor,t._strokeRect={left:n.x-t.lineWidth-2,top:n.y-t.lineWidth-2,right:n.x+t.lineWidth+2,bottom:n.y+t.lineWidth+2},t.setUserSelect("none"),h()(document).on("mouseup",e.data,t.onbrush),t.mouseX=n.x,t.mouseY=n.y;break;case"mouseout":case"mouseover":case"mousemove":t._isMouseDown&&null!==t.mouseX&&null!==t.mouseY&&(t._strokeRect.left=Math.max(Math.min(t._strokeRect.left,n.x-t.lineWidth-2),0),t._strokeRect.top=Math.max(Math.min(t._strokeRect.top,n.y-t.lineWidth-2),0),t._strokeRect.right=Math.min(Math.max(t._strokeRect.right,n.x+t.lineWidth+2),t.width),t._strokeRect.bottom=Math.min(Math.max(t._strokeRect.bottom,n.y+t.lineWidth+2),t.height),t.strokeContext.beginPath(),t.strokeContext.moveTo(t.mouseX,t.mouseY),t.strokeContext.lineTo(n.x,n.y),t.strokeContext.stroke()),"mouseout"===e.type&&(n.x=null,n.y=null),t.mouseX=n.x,t.mouseY=n.y;break;case"mouseup":if(!t._isMouseDown)return;var a=t._strokeRect;t.baseContext.save(),t.baseContext.globalAlpha=t.lineAlpha,t.baseContext.drawImage(t.strokeCanvas[0],a.left,a.top,a.right-a.left,a.bottom-a.top,a.left,a.top,a.right-a.left,a.bottom-a.top),t.baseContext.restore(),t.clearContext(t.strokeContext,t._strokeRect),t.addHistory(),t.mouseX=null,t.mouseY=null,e.currentTarget!==t.strokeCanvas[0]&&t.setUserSelect("text"),h()(document).off("mouseup",t.onbrush),t._isMouseDown=!1}e.preventDefault()}},onhand:function(e){var t=e.data.self,n=t.getMousePosition(e);if(2!==e.button){if("mousedown"!==e.type&&!t._isMouseDown)return"mouseout"===e.type&&t.setUserSelect("text"),void(t.mouseX=t.mouseY=null);switch(e.type){case"mousedown":t._isMouseDown=!0,t.setUserSelect("none"),h()(document).on("mouseup",e.data,t.onhand),t.mouseX=n.x,t.mouseY=n.y;break;case"mouseout":case"mouseover":case"mousemove":if(t._isMouseDown&&t.zoomScale>1){var a=n.x-t.mouseX,r=n.y-t.mouseY,i=h()(".drawr-canvases");if(Math.abs(a)<5&&Math.abs(r)<5)break;i.scrollLeft(i.scrollLeft()-a*t.zoomScale).scrollTop(i.scrollTop()-r*t.zoomScale)}break;case"mouseup":if(!t._isMouseDown)return;h()(document).off("mouseup",t.onhand),t._isMouseDown=!1}e.preventDefault()}},convert:function(e){try{var t=e.data.self;t.outputTarget.val(t.baseCanvas[0].toDataURL().replace(/^.*,/,"")),h()(window).off("beforeunload")}catch(e){return!1}return!0},dummy:null};var la,ua={setup:function(){var e=this;u.a.ui.shortcut.bind("A",function(){return e.applyMethod("toggleLineAlpha")}).bind("Z",function(){return e.applyMethod("undo")}).bind("Y",function(){return e.applyMethod("redo")}).bind("J",function(){return e.applyMethod("zoomin")}).bind("K",function(){return e.applyMethod("zoomout")}).bind(",",function(){return e.applyMethod("setLineWidthIndex","-1")}).bind(".",function(){return e.applyMethod("setLineWidthIndex","+1")})},painterList:[],applyMethod:function(e,t){var n=h()("form.focus .drawr-paint").first().dataset("paintid");this.painterList[n]&&this.painterList[n][e](t);return!1}};h.a.fn.findBy=function(e,t){return this.closest(t).find(e)},h()(function(){la=h()(document.body)});var da=function(){},ha=function(e){return function(){return e++}}(0),pa=function(e){if(this.container=e||this.container||"<div/>",this.compile("container"),this.container.length){this.addEvent(),this.parent&&this.parent.register(this),this.loadOnce=function(e){e||(e={});return function(t,n,a){return e[t]||(e[t]=n.call(a)),e[t]}}();for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.initialize&&this.initialize.apply(this,[e].concat(n))}};pa.extend=function(e){var t=this,n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t.apply(this,n)};return Object.assign(n,this),da.prototype=this.prototype,n.prototype=new da,Object.assign(n.prototype,e),n.prototype.constructor=n,n},pa.template=function(e){return Kn.a.compile(e)},pa.confirm=function(e,t){var n=confirm(e);return n&&t&&t()||n};var fa={tab:function(){return{events:[["click",".ui-tab","select-tab",{container:function(e){e.container=e.element.closest(".ui-tab-container")}}]],selectTab:function(e){var t=e.data.target,n=h.a.camelCase(t);this[n]?this[n](e):h()("."+t,e.container).show(),e.elements.not(e.element).removeClass("active"),e.element.addClass("active"),h()(".ui-tab-content",e.container).not("."+t).hide()},clear:function(e){h()(e).empty()}}}};function ma(){new va,new ba,new ya,new ka,new _a,new wa,new ga,ua.setup()}pa.prototype={parent:null,container:"body",contents:null,stash:null,events:null,initialize:null,include:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var a=t.length>0?t:this.mixins,r=0,i=a.length;r<i;++r){var o=a[r],s=h.a.extend(!0,{},fa[o]);if(this[o]||(this[o]={}),s.events){for(var c=0,l=s.events.length;c<l;++c){var u=Object.assign(s.events[c][3],{mixinContext:this[o]});this.addEvent(u)}delete s.events}Object.assign(this[o],s)}},register:function(e){this.contents=this.contents?this.contents.add(e):h()(e)},unregister:function(e){this.contents&&(this.contents=this.contents.not(e))},trigger:function(e,t){return t?h()(t,this.container).trigger(e):this.container.trigger(e)},compile:function(){for(var e=this,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];n.forEach(function(t){t&&(e[t]=h()(e[t]))})},addEvent:function(e,t,n,a){for(var r=this,i=this.container,o=arguments.length,s=new Array(o>4?o-4:0),c=4;c<o;c++)s[c-4]=arguments[c];var l,u,d,p,f,m=void 0!==e?[[e,t,n,a].concat(s)]:this.events;if(m){void 0!==e&&this.events.push(m[0]);for(var v=0,g=m.length;v<g;++v)u=(l=m[v])[0],d=l[1],p=l[2],f=l[3],l[4],"function"==typeof p?i.on(u+"."+ha(),d,y(p,d)):i.on(u+"."+p,d,this.handler(p,d,f)),l[4]=!0}function y(e,t){return function(n){var a=h()(this),i=a.dataset(a),o=b.b("text",i);y.call(r,{name:e,element:a,elements:r.find(t),data:i,text:o,event:n})}}},removeEvent:function(e){return this.container.off("."+e)},handler:function(e,t,n){var a=this,r=K.a(e),i=0===e.indexOf("toggle-");n||(n={});var o=function(t,n,r){return a.template(e,t,n,r)},s=function(t,n){return a.storage(e,t,n)},c=function(e){var c=h()(this);if(c.hasClass("ui-loading"))return!1;var l=c.dataset(),u=b.b("text",l),d=a.find(t),p=(a.handlers||{})[r],f=a[r],m=function(e){return pa.confirm(u.confirm,e&&function(){return e()})};if(p?f&&i&&(p=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=a.handlers[r].apply(a,t);return i&&f.apply(a,t),i}):p=f,p){var v=p.call(a,{element:c,elements:d,data:l,text:u,template:o,storage:s,confirm:m,event:e});if("boolean"==typeof v)return v;if(v){c.addClass("ui-loading");var g=function(e){return c.removeClass("ui-loading"),e};Promise.resolve(v).then(g,function(e){throw g(),e}).then(function(t){var n=c.dataset(),r=b.b("text",n);return!i&&f&&f.call(a,{element:c,elements:d,data:n,text:r,template:o,storage:s,confirm:m,event:e},t),t}).catch(function(){if(i){var t=c.dataset(),n=b.b("text",t);f.call(a,{element:c,elements:d,data:t,text:n,template:o,storage:s,confirm:m,event:e})}})}}return!1===n.cancel};return n.debounce?u.a.debounce(c,null,"number"==typeof n.debounce?n.debounce:void 0):c},storage:function(e,t,n){if(e){if(this.stash||(this.stash={}),this.stash[e]||(this.stash[e]={}),!t)return this.stash[e];switch(n){case null:delete this.stash[e][t];break;case void 0:return this.stash[e][t]||(this.stash[e][t]={}),this.stash[e][t];default:return this.stash[e][t]=n,n}}},template:function(e,t,n,a){var r,i=this.templates[e],o="";return i&&"string"!=typeof i||(o=i||h()("#template-"+e).html()||"",a&&a.pre||(o=o.replace(/[\n\r]+/g,"")),this.templates[e]=i=pa.template(o)),r=i(t),n?n.html(r):r},find:function(e){return h()(e,this.container)},remove:function(e){return(e?this.find(e):this.container).remove()}};var va=pa.extend({container:"#contents header",width:782,height:null,events:[["click",".action-leave-group","leave-group"],["click",".action-select-cover","select-cover"],["change",".input-cover","submit-cover"],["click",".action-reposition-cover","reposition-cover"],["click",".action-apply-reposition","apply-reposition"],["click",".action-cancel-reposition","cancel-reposition"]],handlers:{applyReposition:function(){var e=this,t=this.find(".cover"),n=t.css("background-position"),a=parseInt(n.split(" ")[1],10);return"%"!==n.slice(-1)&&(a=a/(160-this.height)*100,t.css("background-position","0 "+a+"%")),t.off("mousedown").removeClass("dragging"),la.addClass("unselectable"),function(e,t){return sa.post("/group/edit.php",{mode:"slide_cover",position_y:t,format:"json",group_id:e})}(Va.context.groupId,a).catch(function(t){alert(t&&t.error+(t.hint?"\n\n"+t.hint:"")||t),e.trigger("click.reposition-cover",".action-reposition-cover")})}},leaveGroup:function(e){return e.confirm(function(){h()("#leave-group").submit()})},selectCover:function(e){u.a.ua.ie?location.href="/group/edit.php?mode=cover&id="+Va.context.groupId:e.element.findBy('input[type="file"]',"form").val("").click()},submitCover:function(){this.find("form").submit()},repositionCover:function(e){var t,n,a=this,r=e.element.closest(".cover");this.height?this.addRepositionEvent(e,r):(t=Va.context.coverImage)&&((n=new Image).onload=function(){a.height=a.width*n.height/n.width,a.addRepositionEvent(e,r)},n.src=t)},addRepositionEvent:function(e,t){var n=this,a=!1;t.addClass("dragging").find(".menu").addClass("hidden"),this.find(".edit-cover").show(),this.storage("cover","background-position",t.css("background-position")),t.on("mousedown",function(e){var r=parseFloat(t.css("background-position").split(" ")[1]),i=e.clientY,o=n.height;a||(r=r/100*(160-o),a=!0),la.addClass("unselectable"),u.a.d.on("mousemove",function(e){var n=r+(e.clientY-i),a=o>160?Math.min(0,Math.max(n,160-o)):Math.max(0,Math.min(n,160-o));t.css("background-position","0 "+a+"px")}).on("mouseup",function(){u.a.d.off("mousemove mouseup"),la.removeClass("unselectable")})})},applyReposition:function(){this.find(".cover .menu").removeClass("hidden"),this.find(".edit-cover").hide()},cancelReposition:function(){this.find(".cover").off("mousedown").removeClass("dragging").css("background-position",this.storage("cover","background-position")).find(".menu").removeClass("hidden"),this.find(".edit-cover").hide()}}),ga=pa.extend({container:"#contents div.invite",events:[["click",".action-enable-invite","enable-invite"],["click",".toggle-action","toggle"]],handlers:{enableInvite:function(){return function(e){return sa.post("/group/edit.php",{group_id:e,mode:"reset_invite_key",format:"json"})}(Va.context.groupId)}},templates:{"enable-invite":null},enableInvite:function(e,t){e.template(t,this.container),this.removeEvent("enable-invite")},toggle:function(){this.find(".action-box").toggle()}}),ba=pa.extend({container:"#timeline",listContainer:null,config:null,initialize:function(){this.listContainer=this.find("> ul"),this.config=u.a.storage.config("group"),this.config("no_hint")||this.addEvent("click",".hint .close","close-hint")},mixins:["tab"],events:[["click",".imgadd","toggle-add-image"],["click",".imgpaint","toggle-paint"],["focus",".inputbox textarea","focus-form"],["keydown","textarea","work-detail",{debounce:500}],["submit","form.action-post","post"],["submit","form.action-comment","comment"],["click","#more a","more"],["click",".action-like","toggle-like"],["click",".action-reply","reply"],["click",".action-cancel-reply","cancel-reply"],["click",".action-likes","likes",{cancel:!1}],["click",".action-remove","toggle-remove"],["click",".comment a.more","more-comment"],["click",".action-add-comment","show-comment-panel"],["click",".action-report-spam","report-spam"],["click",".toggle-context-menu","toggle-context-menu"],["click",".action-open-image","open-image"]],templates:{"toggle-like":null,likes:null,post:null,"open-image":null,"work-detail":null},handlers:{post:function(e){var t=e.element[0];return!!t.image.value||r.postComment(Va.context.groupId,u.a.ui.Tag.trim(t.body.value),h()(".imgpaint.active",e.element).length?t.paint.value:void 0).catch(function(e){alert(e&&e.error+(e.hint?"\n\n"+e.hint:"")||e)})},comment:function(e){var t=e.element[0];return!!t.image.value||r.postChild(Va.context.groupId,t.parent_id.value,!t.reply_id.disabled&&t.reply_id.value||void 0,u.a.ui.Tag.trim(t.body.value),h()(".imgpaint.active",e.element).length?t.paint.value:void 0).catch(function(e){alert(e&&e.error+(e.hint?"\n\n"+e.hint:"")||e)})},more:function(e){return function(e){return sa.get("/group/?format=partial_html",e)}(e.data)},toggleLike:function(e){return r.postArbitraryData(e.data)},reply:function(e){var t=e.element.closest("li.post"),n=e.element.findBy(".user",".meta").text();this.trigger("click",h()(".action-add-comment",t)),h()('input[name="reply_id"]',t).val(e.data.reply_id).prop("disabled",!1),h()(".reply-to",t).removeClass("hidden").find(".user").text(n)},cancelReply:function(e){e.element.closest(".reply-to").addClass("hidden"),e.element.findBy('input[name="reply_id"]',"li.post").prop("disabled",!0)},likes:function(e){return function(e,t,n){return sa.get("/group/rpc/like_users.php",{type:e,comment_id:t,format:"json"},n)}(e.data.type,e.data.comment_id,{cache:e.storage("cache")})},toggleRemove:function(e){return confirm(e.text.confirm)&&r.postArbitraryData(e.data).then(function(e){return u.a.dispatcher.connect("/group/comment.php",function(){location.href="/group/?id="+Va.context.groupId}).dispatch(),e})},moreComment:function(e){return r.getHtmlForArbitraryData(e.data)},reportSpam:function(e){return e.confirm(function(){return r.postArbitraryData(e.data).catch(function(e){alert(e&&e.error+(e.hint?"\n\n"+e.hint:"")||e)})})}},toggleAddImage:function(e){var t=e.element,n=t.siblings().removeClass("active");t.closest("form").find(".paintcontainer").hide().find("input").prop("disabled",!0);var a=t.toggleClass("active").findBy(".filecontainer","form").toggle().find("input");a.prop("disabled",!a.prop("disabled"));var r=e.element.findBy(".work-detail-container","form");n.addBack().filter(".active").length?r.slideUp("fast"):r.show()},togglePaint:function(e){var t,n=e.element,a=n.siblings().removeClass("active");if(n.closest("form").find(".filecontainer").hide().find("input").prop("disabled",!0),!n.hasClass("active")&&!(t=h()(".drawr-paint",n.closest("form"))).hasClass("parsed")){var r=ua.painterList;t.dataset("paintid",r.length),r.push(new ca(t))}var i=n.toggleClass("active").closest("form").find(".paintcontainer").toggle().find("input");i.prop("disabled",!i.prop("disabled"));var o=e.element.findBy(".work-detail-container","form");a.addBack().filter(".active").length?o.slideUp("fast"):o.show()},focusForm:function(e){var t=this,n=e.element.closest("form");if(!n.hasClass("focus")){this.find("form.focus").each(function(){t.unfocusForm({element:h()(this)})}),n.addClass("focus").find(".attachmentbar").show().closest("li.post div.inputbox").find("img.usericon, div.controller").show();var a=n.find(".recently-viewed");if(!a.children().length&&window.localStorage&&window.JSON){var r;try{(r=JSON.parse(localStorage["recently_viewed"+Va.user.id])).length||(r=[])}catch(e){r=[]}var i=Date.now?Date.now():+new Date,o=!0,s=!1,c=void 0;try{for(var l,u=function(){var t=l.value;if(i-t.time>72e5)return"continue";h()('<div class="recently-viewed-item"></div>').append(h()(new Image).attr("src",t.img)).appendTo(a).on("click",function(){var n=null;"illust"===t.type?n="https://www.pixiv.net/member_illust.php?mode=medium&illust_id="+t.id:"novel"===t.type&&(n="https://www.pixiv.net/novel/show.php?id="+t.id),n&&(e.element.val(n+" "+e.element.val()),e.element.trigger("focus").trigger("keydown"))})},d=r.slice(-8).reverse()[Symbol.iterator]();!(o=(l=d.next()).done);o=!0)u()}catch(e){s=!0,c=e}finally{try{o||null==d.return||d.return()}finally{if(s)throw c}}0===a.children().length&&(n.find(".recently-viewed-header").hide(),n.find(".recently-viewed").hide())}}},unfocusForm:function(e){e.element.removeClass("focus").find(".attachmentbar").hide().closest("li.post div.inputbox").find("img.usericon, div.controller").hide()},workDetailLoading:!1,workDetail:function(e){var t=this,n=function(e){var t=e.match(/(https?:\/\/[-_.!~*'()a-zA-Z0-9;/?:@&=+$,%#]+)/g);return Array.from(new Set(t||""))}(e.element.val())[0],a=e.element.findBy(".work-detail-container","form"),r=this.workDetailLoading;function i(e){return t.workDetailLoading=!1,a.find(".work-detail").remove(),e}n?r||(this.workDetailLoading=!0,p.n(n).then(i,function(e){throw i(),e}).then(function(t){"pixiv_illust"!==t.urlType&&"pixiv_novel"!==t.urlType||a.append(e.template(t.detail))})):a.find(".work-detail").remove()},post:function(e,t){if(Va.context.max)return location.href="/group/?id="+Va.context.groupId,!1;var n=h()(t.html);this.listContainer.prepend(n),u.a.ui.expander.add(n),h()("#post-body").val(""),e.element.find(".imgpaint.active").removeClass("active").end().find(".paintcontainer").hide().find("input").prop("disabled",!0),h()(".work-detail-container",e.element).empty().show();var a=h()(".drawr-paint",e.element).dataset("paintid");return ua.painterList[a]&&ua.painterList[a].clearCanvas(),!1},comment:function(e,t){var n=h()("#post-"+e.element[0].parent_id.value),a=h()(t.html),r=h()("> .comment",n);r.length||(r=h()('<div class="comment"/>').insertBefore(h()(".inputbox",n))),r.append(a),u.a.ui.expander.add(a),h()("textarea",e.element).val(""),e.element.find(".imgpaint.active").removeClass("active").end().find(".paintcontainer").hide(),h()(".work-detail-container",e.element).empty().show();var i=h()(".drawr-paint",e.element).dataset("paintid");ua.painterList[i]&&ua.painterList[i].clearCanvas()},more:function(e,t){var n=h()(t.html),a="/group/?id="+e.data.id+"&max="+e.data.max;this.listContainer.append(n),u.a.ui.expander.add(n),null!==t.max?(e.element.dataset("max",t.max),history.replaceState&&history.replaceState(null,e.data.max,a)):(e.element.remove(),this.removeEvent("more")),g.tracking.pageview("group","more",a)},toggleLike:function(e){var t=e.data.mode;if(t){var n=e.element.parent(),a=+n.dataset("total")||0,r={liked:0===t.indexOf("add"),comment_id:e.data.comment_id,suffix:(/_child$/.exec(t)||[""])[0]};r.type=r.suffix?"comment":"post",r.total=r.liked?a+1:a-1,e.template(r,n),n.dataset("total",r.total);var i="/group/comment.php?id="+n.closest("li.post").getId()+("post"===r.type?"":"#comment-"+r.comment_id);g.tracking.event("group",r.liked?"like":"unlike",i)}},likes:function(e,t){if(t.likeUsers.length){var n=e.element,a=h()(e.template({users:t.likeUsers})).appendTo(n);sn.e.open(a,{disposable:!0}),a.width(24*Math.min(t.likeUsers.length,5)).css("left",6-a.outerWidth()/2),g.tracking.event("group","openLikes")}},toggleRemove:function(e){-1===e.data.mode.indexOf("_child")?h()("#post-"+e.data.comment_id).slideToggle():h()("#comment-"+e.data.comment_id).slideToggle()},moreComment:function(e,t){var n=e.element,a=h()(t.html).insertAfter(n);u.a.ui.expander.add(a),null!==t.max_id?n.dataset("max_id",t.max_id):n.remove()},showCommentPanel:function(e){var t=e.element.closest("li.post").find(".inputbox").show(),n=h()("textarea",t).focus();sn.f(Math.max(t.offset().top,u.a.w.scrollTop())-100,"normal").then(function(){n[0].focus()})},reportSpam:function(e){e.element.siblings().length>1?e.element.remove():e.element.closest(".action").remove()},toggleContextMenu:function(e){e.element.closest(".action").find(".action-box").toggle()},openImage:function(e){var t=h()("#image-modal"),n=h()(".content",t).empty();sn.e.open(t,{block:!0});var a=new Image;a.onload=function(){var r=!!e.data.title;h()(".ui-modal",t).animate({width:r?Math.max(a.width,200):a.width,height:r?Math.max(a.height,150):a.height},300,function(){e.data.original=e.data.src.replace(/_m\.(jpg|png|gif)$/,".$1"),n.html(e.template(e.data))})},a.src=e.data.src;var r=e.element.closest("li.post").getId(),i=e.element.closest("div.post"),o=i.length?"#"+i[0].id:"";g.tracking.event("group","openImage","/group/comment.php?id="+r+o)},closeHint:function(e){var t=this.find(".hint");e.element.closest(".hint").slideUp("fast",function(){t.remove()}),this.config("no_hint",1)}}),ya=pa.extend({container:"#page-group-edit #contents",initialize:function(){new sn.c(this.find(".ui-tag")).make(),new sn.a(this.find(".ui-count-target"),this.find(".ui-count-counter"))},events:[["click",".action-delete-icon","delete-icon"],["click",'input[name="publish_status"]',"toggle-accept-checkbox",{cancel:!1}],["click",'input[name="age_limit"]',"toggle-warning",{cancel:!1}]],handlers:{deleteIcon:function(e){return confirm(e.text.confirm)&&function(e){return sa.post("/group/edit.php",Object(ye.a)({mode:"delete_icon",format:"json"},e))}(e.data)}},deleteIcon:function(e){var t=e.element.closest("dd").find("img");t.attr("src",t.dataset("noIcon")),e.element.remove()},toggleAcceptCheckbox:function(e){var t=e.element.findBy(".notes:last","dd");e.elements.last().prop("checked")?(this.find(".accept-status").addClass("ui-disabled"),this.find('input[name="accept_status"]').prop({checked:!1,disabled:!0}),t.addClass("warning")):(this.find(".accept-status").removeClass("ui-disabled"),this.find('input[name="accept_status"]').prop("disabled",!1),t.removeClass("warning"))},toggleWarning:function(e){e.element.findBy(".notes","dd").toggleClass("warning")}}),ka=pa.extend({container:"#group-list",listContainer:null,initialize:function(){this.listContainer=this.find(".group-items")},events:[["click","._more a","more"]],handlers:{more:function(e){return function(e){return sa.get("/group/group_list.php?format=partial_html",e)}(e.data)}},more:function(e,t){this.listContainer.append(t.html),null!==t.max_id?(e.element.dataset("max_id",t.max_id),g.tracking.pageview("group","group_list","more")):(e.element.remove(),this.removeEvent("more"))}}),wa=pa.extend({container:"#page-group #images",listContainer:null,initialize:function(){this.listContainer=this.find("> ul")},events:[["click",".more a","more"]],handlers:{more:function(e){return function(e){return sa.get("/group/images.php?format=partial_html",e)}(e.data)}},more:function(e,t){this.listContainer.append(t.html),null!==t.max_id?(e.element.dataset("max_id",t.max_id),g.tracking.pageview("group","images","more")):(e.element.remove(),this.removeEvent("more"))}}),_a=pa.extend({container:"#page-group .members",listContainer:null,initialize:function(){this.listContainer=this.find("> ul")},events:[["click",".action-remove","toggle-remove"],["click",".action-toggle-permission","toggle-permission"],["click",".more a","more"]],handlers:{toggleRemove:function(e){return confirm(e.text.confirm)&&i.unjoin(Va.context.groupId,e.data)},togglePermission:function(e){var t=e.data.user_id===Va.user.id;return(!t||confirm(e.text.confirmSelf))&&i.changePermission(Va.context.groupId,e.data).then(function(e){return t&&location.reload(),e}).catch(function(e){alert(e.error+(e.hint?"\n\n"+e.hint:"")||e)})},more:function(e){return i.getHtmlForArbitraryData(e.data)}},toggleRemove:function(e){e.element.closest("li").toggle()},togglePermission:function(e){var t={};e.data.permission===Va.context.GROUP_USER_PERMISSION_MEMBER?(t.text=e.text.toAdmin,t.permission=Va.context.GROUP_USER_PERMISSION_ADMIN):(t.text=e.text.toMember,t.permission=Va.context.GROUP_USER_PERMISSION_MEMBER),e.element.val(t.text).dataset("permission",t.permission)},more:function(e,t){this.listContainer.append(t.html),null!==t.max_id?(e.element.dataset("max_id",t.max_id),g.tracking.pageview("group","members","more")):(e.element.remove(),this.removeEvent("more"))}}),xa=pa.extend({cache:{},events:[["click",".action-show-create-group-modal","show-create-group-modal"],["click",".action-show-join-group-modal","show-join-group-modal"],["click",".open-add-pickup-modal","open-add-pickup-modal"],["click",".open-edit-pickup-modal","open-edit-pickup-modal"],["focus",".ui-auto-select","auto-select"],["click",".ui-selectbox li","selectbox-select",{cancel:!1}]],showCreateGroupModal:function(){var e=this;(function(e){return sa.get("/group/create.php",{format:"partial_html"},e)})({cache:this.cache}).then(function(t){e.loadOnce("create-group-modal",function(){la.append(u.a.template("create-group",t)),new ja}),sn.e.open(".create-group-modal",{block:!0}),h()('.create-group-modal input[type="text"]').focus(),g.tracking.event("group","showCreateGroupModal",location.href)})},showJoinGroupModal:function(){var e=this;(function(e,t){return sa.get("/group/",{id:e,section:"join_rule",format:"partial_html"},t)})(Va.context.groupId,{cache:this.cache}).then(function(t){e.loadOnce("join-group-modal",function(){la.append(u.a.template("join-group",t)),sn.e.open(".join-group-modal",{block:!0})}),h()('.join-group-modal input[type="checkbox"]').focus(),h()(".join-group-modal .terms-check").on("change",function(e){h()('.join-group-modal input[type="submit"]').prop("disabled",!e.target.checked)})})},openAddPickupModal:function(e){r.showPickupPost(Va.context.groupId,e.data.commentId).then(function(t){for(var n,a,r=t.group.pickupPosts,i=Sa(r)?r.detail.posts:[],o=e.data.commentId,s=0;s<i.length;++s)if((a=i[s]).id===o){n=a.title,i.splice(s,1);break}Object.assign(t,{full:i.length>=10,id:o,title:n});var c=h()(u.a.template("add-pickup-modal",t)).appendTo(la);new Ca(c,t),sn.e.open(c,{block:!0,disposable:!0}).find(".ui-focus").focus(),h()('input[type="text"]',c).focus()})},openEditPickupModal:function(){r.showPickupPost(Va.context.groupId).then(function(e){var t=h()(u.a.template("edit-pickup-modal",e)).appendTo(la);new Ca(t,e),sn.e.open(t,{block:!0,disposable:!0})})},autoSelect:function(e){setTimeout(function(){e.element.select()})},selectboxSelect:function(e){e.element.findBy("> span",".ui-selectbox").text(e.element.text())}}),ja=pa.extend({container:".create-group-container",initialize:function(){new sn.a(this.find(".ui-count-target"),this.find(".ui-count-counter"))},events:[["submit",".action-create-group","create-group"],["click",'input[name="publish_status"]',"toggle-accept-checkbox",{cancel:!1}],["click",'input[name="age_limit"]',"toggle-warning",{cancel:!1}]],handlers:{createGroup:function(e){return e.element[0].title.value?function(e){return sa.post("/group/create.php",e.concat([{name:"format",value:"json"}]))}(e.element.serializeArray()).catch(function(e){try{if(e.error)return void alert(e.error+(e.hint?"\n\n"+e.hint:"")||e);if(e instanceof Error)throw e;var t=e.inputGroup.error,n=[];for(var a in t)n.push(t[a]);alert(n.join("\n"))}catch(e){alert("エラーが発生しました")}}):(alert("グループ名を入力してください"),!1)}},createGroup:function(e,t){location.href="/group/?id="+t.group_id,sn.e.close()},toggleAcceptCheckbox:function(e){var t=e.element.findBy(".notes:last","dd");e.elements.last().prop("checked")?(this.find(".accept-status").addClass("ui-disabled"),this.find('input[name="accept_status"]').prop({checked:!1,disabled:!0}),t.addClass("warning")):(this.find(".accept-status").removeClass("ui-disabled"),this.find('input[name="accept_status"]').prop("disabled",!1),t.removeClass("warning"))},toggleWarning:function(e){e.element.findBy(".notes","dd").toggleClass("warning")}}),Oa=!0,Ca=pa.extend({data:null,changed:!1,initialize:function(e,t){var a=this;this.container=h()(e),this.data=t;var r=t.group.pickupPosts;(Sa(r)?r.detail.posts:[]).length>1&&Oa&&(Oa=!1,n.e(7).then(n.t.bind(null,1144,7)).then(function(){var n=h()(".handle",e);if(n.length){var r,i=t.group.pickupPosts,o=Sa(i)?i.detail.posts:[];n.show(),h()(".items",e).sortable({axis:"y",handle:n,start:function(e,t){var n=t.item;r=h()(".item",this).index(n)},update:function(e,t){var n=t.item,i=h()(".item",this).index(n),s=o.splice(r,1)[0];o.splice(i,0,s),a.changed=!0}})}}))},events:[["submit",".add","add"],["submit",".apply","apply"],["change",".item-title","rename"],["click",".remove","remove"],["click",".cancel","cancel"]],handlers:{add:function(e){for(var t,n=this.data.group.pickupPosts,a=Sa(n)?n.detail.posts:[],i=[],o=0;o<a.length;++o)(t=a[o]).id!==this.data.id&&i.push({name:"posts["+o+"][id]",value:t.id},{name:"posts["+o+"][title]",value:t.title});return i.push({name:"posts["+o+"][id]",value:this.data.id},{name:"posts["+o+"][title]",value:h()(".input-title",e.element).val()},{name:"mode",value:"set_pickup_post"},{name:"group_id",value:this.data.group.id},{name:"update_time",value:a.length?n.update_time_unix:""}),r.postJQuerySerialize(i).then(function(e){return location.reload(),e}).catch(function(e){try{if(e.error)return void alert(e.error+(e.hint?"\n\n"+e.hint:"")||e);if(e instanceof Error)throw e;var t=e.inputs.error,n=[];for(var a in t)n.push(t[a]);alert(n.join("\n"))}catch(e){alert("エラーが発生しました")}})},apply:function(){for(var e,t=this.data.group.pickupPosts,n=Sa(t)?t.detail.posts:[],a=[],i=0;i<n.length;++i)e=n[i],a.push({name:"posts["+i+"][id]",value:e.id},{name:"posts["+i+"][title]",value:e.title});return a.push({name:"mode",value:"set_pickup_post"},{name:"group_id",value:this.data.group.id},{name:"update_time",value:n.length?t.update_time_unix:""}),r.postJQuerySerialize(a).then(function(e){return location.reload(),e}).catch(function(e){try{if(e.error)return void alert(e.error+(e.hint?"\n\n"+e.hint:""));if(e instanceof Error)throw e;var t=e.inputs.error,n=[];for(var a in t)n.push(t[a]);alert(n.join("\n"))}catch(e){alert("エラーが発生しました")}})},pickupPost:function(e){var t=e.element.serializeArray();return t.push({name:"format",value:"partial_html"}),r.postJQuerySerialize(t).then(function(e){return location.reload(),e}).catch(function(e){try{if(e.error)return void alert(e.error+(e.hint?"\n\n"+e.hint:""));if(e instanceof Error)throw e;var t=e.inputs.error,n=[];for(var a in t)n.push(t[a]);alert(n.join("\n"))}catch(e){alert("エラーが発生しました")}})}},openRenameModal:function(e){var t=this;Object.assign(e.data,{rename:!0});var n=h()(u.a.template("add-pickup-modal",e.data)).appendTo(la).on("submit",".add",function(){var a=t.data.group.pickupPosts,r=Sa(a)?a.detail.posts:[],i=!0,o=!1,s=void 0;try{for(var c,l=r[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var u=c.value;if(u.id===e.data.id){u.title=h()(".input-title",n).val(),e.element.findBy(".item-title",".item").text(u.title);break}}}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}return sn.e.close(),!1});sn.e.open(n,{block:!0,disposable:!0}).find(".ui-focus").focus()},index:function(e,t){return t.findIndex(function(t){return t.id===e})},remove:function(e){h()(e.element).closest(".item").slideUp("fast");var t=this.data.group.pickupPosts.detail.posts,n=this.index(e.data.id,t);n>-1&&t.splice(n,1),t.length<10&&h()(".submit",this.container).prop("disabled",!1),this.changed=!0},rename:function(e){var t=e.element.val();if(u.a.ui.Tag.trim(t)){var n=this.data.group.pickupPosts.detail.posts;n[this.index(e.data.id,n)].title=t,this.changed=!0}},cancel:function(){this.changed?confirm(Va.text.cancelConfirm)&&sn.e.close():sn.e.close()}});function Sa(e){return null!=e&&"object"===Object(an.a)(e)&&!Array.isArray(e)}var Ta=n(47),Ia=n(123),Ma=function(){function e(t){Object(C.a)(this,e),this.context=t,this.container=void 0,h()(".trigger",t).on("click",this.toggle.bind(this))}return Object(S.a)(e,[{key:"load",value:function(){this.container=h()(".container",this.context),this.container.find(".close").on("click",this.close.bind(this)),g.screen.register(this)}},{key:"toggle",value:function(e){e.preventDefault(),e.stopImmediatePropagation(),this.container||this.load(),this.container.is(":visible")?this.close():this.open()}},{key:"open",value:function(){g.screen.close(this);var e=this.container.show().find(":text, textarea")[0];e&&e.focus()}},{key:"close",value:function(){this.container.hide()}}],[{key:"setup",value:function(){h()(".popup").each(function(t,n){new e(n)})}}]),e}();function Ea(){h()(document.body).on("click",".js-click-trackable",Pa).on("click",".js-click-trackable-later",La),h()(".js-view-trackable").each(Na)}function Na(e,t){Da(t)}function Da(e){var t=h()(e).dataset();za(t)&&Ua(t)}function Pa(e){var t=h()(e.currentTarget).dataset();za(t)&&Ua(t)}function La(e){var t=h()(e.currentTarget).dataset();za(t)&&function(e){u.a.ga.later([e.clickCategory,e.clickAction,e.clickLabel])}(t)}function Ua(e){u.a.ga.trackEvent([e.clickCategory,e.clickAction,e.clickLabel])}function za(e){return!!(e&&e.clickCategory&&e.clickAction)}var Aa,Ra=n(25),Fa=n(52),Ba=(n(431),function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;Object(C.a)(this,e),this.handleClearClick=function(){window.confirm(u.a.t("検索履歴を削除しますか？"))&&t.clear()},this.storageKeyName="search_history".concat(n),this.maxLength=a&&a.max_length||0,this.historyHeader=h()("#suggest-list p")}return Object(S.a)(e,[{key:"install",value:function(){h()("a",this.historyHeader).on("click",this.handleClearClick)}},{key:"uninstall",value:function(){h()("a",this.historyHeader).off("click",this.handleClearClick)}},{key:"get",value:function(){var e=u.a.storage.localStorage(this.storageKeyName);return Array.isArray(e)?e:[]}},{key:"getAsSuggest",value:function(e,t){var n=this.get(),a={candidates:[]},r=!0,i=!1,o=void 0;try{for(var s,c=n[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;if(0===l.lastIndexOf(e,0)&&(a.candidates.push({tag_name:l,type:"history"}),a.candidates.length>=t))break}}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return a}},{key:"add",value:function(e){var t=this.get().filter(function(t){return t!==e});u.a.storage.localStorage(this.storageKeyName,[e].concat(t).slice(0,this.maxLength))}},{key:"remove",value:function(e){var t=this.get(),n=t.includes(e);return u.a.storage.localStorage(this.storageKeyName,t.filter(function(t){return t!==e})),n}},{key:"clear",value:function(){u.a.storage.localStorage(this.storageKeyName,null)}},{key:"showHeader",value:function(){this.historyHeader.show()}},{key:"hideHeader",value:function(){this.historyHeader.hide()}}]),e}()),$a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(C.a)(this,e),this.storageKeyName="search_suggest_banned".concat(t),this.list=new Set(Object.keys(u.a.storage.localStorage(this.storageKeyName)||{}))}return Object(S.a)(e,[{key:"add",value:function(e){if(!this.list.has(e)){this.list.add(e);var t={},n=!0,a=!1,r=void 0;try{for(var i,o=this.list[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){t[i.value]=1}}catch(e){a=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}u.a.storage.localStorage(this.storageKeyName,t)}}},{key:"contain",value:function(e){return this.list.has(e)}}]),e}(),Wa=function(){function e(){if(Object(C.a)(this,e),this.stash=new Map,this.effectiveCount=10,this.listPosition=-1,this.listLength=0,this.inputContainer=h()("#suggest-input"),!this.inputContainer.length)throw new Error("#suggest-input not found");if(this.container=h()("#suggest-container"),!this.inputContainer.length)throw new Error("#suggest-container not found");this.container.length&&(this.listContainer=h()("#suggest-list ul"),this.history=new Ba(Va.user.id,{max_length:1e3}),this.banned=new $a(Va.user.id),this.text=u.a.ui.Tag.split(this.inputVal()))}return Object(S.a)(e,[{key:"saveCurrentText",value:function(){this.text.length>0&&this.history.add(u.a.ui.Tag.trim(this.inputVal()))}},{key:"install",value:function(){var e=this;this.history.install(),this.inputContainer.on("focus",function(){e.start()}).on("blur",function(){e.stop()}).on("keydown",function(t){e.select(t)}),this.container.on("submit",function(t){e.submit(t)}),this.listContainer.on("click",function(t){e.click(t)})}},{key:"select",value:function(e){var t=this,n=e.key;if(!e.originalEvent.isComposing){var a=this.listItem,r=this.listLength,i=this.listPosition;switch(n){case"ArrowUp":case"ArrowDown":if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey)break;if(e.preventDefault(),a){var o=(1+i+("ArrowUp"===n?-1:1))%(r+1)-1,s=o<-1?1+r+o:o;this.listPosition=s,a.removeClass("current"),s>=0&&a.eq(s).addClass("current")}break;case"Enter":a&&-1!==i&&(e.preventDefault(),a.eq(i).trigger("click"));break;case"Backspace":case"Delete":var c=function(n){if(!h()(n).hasClass("search-category")&&!h()(n).closest("li").hasClass("search-category")){e.preventDefault();var a=n.text();n.remove(),t.history.remove(a)||t.banned.add(a),t.listItem=h()("li",t.listContainer),t.listLength=t.listItem.length,t.listPosition=-1,0===t.listLength&&t.hide()}};a&&-1!==i&&e.shiftKey?c(a.eq(i)):h()("li:hover",this.listContainer).length>0&&e.shiftKey&&c(h()("li:hover",this.listContainer))}}}},{key:"submit",value:function(e){var t=u.a.ui.Tag.trim(this.inputVal());t||e.preventDefault(),this.inputContainer.val(t)}},{key:"click",value:function(e){if(e.target){var t=h()(e.target).closest("li"),n=this.inputContainer,a=h()("#suggest-list li").index(t),r=t.dataset("suggestType");if(h()(e.target).hasClass("search-category")||h()(e.target).closest("li").hasClass("search-category")){var i=h()("a",e.target).attr("href");i&&(location.href=i)}else{var o=t.find(".js-search-suggest-tag-name").text()||t.text();this.text=this.text.slice(0,-1).concat(o),n.val(this.text.join(" ")).trigger("focus"),this.hide();var s=r?"suggested-by-".concat(r):"suggest";u.a.ga.trackEvent(["search",s,this.inputVal(),a]),this.container.trigger("submit")}}}},{key:"start",value:function(){var e=this;this.stop(),this.timer=window.setInterval(function(){e.request()},500)}},{key:"stop",value:function(){var e=this;window.clearInterval(this.timer),setTimeout(function(){e.hide()},300)}},{key:"request",value:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,a,r,i,o,s,l,d=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.a.ui.Tag.trim(u.a.ui.Tag.split(this.inputVal()).pop()),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=d.history.getAsSuggest(e,10);d.show(t?d._merge(n,t,10):n)},t!==this.keyword&&t!==this._keyword){e.next=4;break}return e.abrupt("return");case 4:if(this.text=u.a.ui.Tag.split(this.inputVal()),t){e.next=10;break}return this._keyword=t,a=this.history.get(),a.length>0?(this.history.showHeader(),n("")):this.hide(),e.abrupt("return");case 10:if(this.history.hideHeader(),r=t.length>this.effectiveCount,i=t.slice(0,this.effectiveCount),!(o=this.stash.get(i))){e.next=20;break}return s=this.stash.get(t)||this.filter(this.stash.get(i),t),this._keyword=t,this.stash.set(t,s),n(t,s),e.abrupt("return");case 20:if(r||(this._keyword=void 0),this.keyword=t,!o){e.next=26;break}n(t,o),e.next=38;break;case 26:return this.stash.set(t,void 0),e.prev=27,e.next=30,Promise.resolve(p.j(t));case 30:l=e.sent,this.stash.set(t,l),r||n(t,l),e.next=38;break;case 35:e.prev=35,e.t0=e.catch(27),n(t);case 38:case"end":return e.stop()}},e,this,[[27,35]])}));return function(){return e.apply(this,arguments)}}()},{key:"filter",value:function(e,t){return{candidates:(e&&e.candidates||[]).filter(function(e){return e.tag_name.startsWith(t)})}}},{key:"show",value:function(e){var t,n=(e||{}).candidates||[],a=h()("#search-suggest-with-translation-inner-li-template"),r=n.map(function(e){var t=h()("<li>"),n=e.tag_translation||"";if(a&&n.length>0){var r=a.tmpl({tagName:e.tag_name,tagTranslation:n});t.append.apply(t,Object(Fa.a)(r))}else t.text(e.tag_name);return e.type&&t.dataset("suggestType",e.type),t}),i=h()("#search-category-template").tmpl({word:encodeURIComponent(u.a.ui.Tag.trim(this.inputVal()))});(t=this.listContainer.empty()).append.apply(t,Object(Fa.a)(r).concat(Object(Fa.a)(i))).show(),this.listItem=this.listContainer.children(),this.listLength=this.listItem.length,this.listPosition=-1,0===this.text.length?(h()(".search-category").remove(),this.listLength-=3):this.text.length>1&&(h()(".search-category-tag-user").remove(),this.listLength-=1),h()("#suggest-list").show()}},{key:"hide",value:function(){h()("#suggest-list").hide(),this.listPosition=-1,this.keyword=void 0,this._keyword=void 0}},{key:"_merge",value:function(e,t,n){var a={candidates:[]},r={},i=e.candidates.concat(t&&t.candidates||[]),o=!0,s=!1,c=void 0;try{for(var l,u=i[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var d=l.value,h=d.tag_name;if(!this.banned.contain(h))if(h in r)a.candidates[r[h]].type+=","+d.type;else if(r[h]=a.candidates.length,a.candidates.push(d),a.candidates.length>=n)break}}catch(e){s=!0,c=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw c}}return a}},{key:"inputVal",value:function(){return this.inputContainer.val()}}]),e}(),Ha=n(179),qa=n(295),Ga=function(){return en.apply(this,arguments)}(),Ka=function(){var e=function(e){switch(e){case"en":case"ko":return e;case"zh-CN":return"zh";case"zh-TW":return"zh-tw"}return null}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.a)());return null===e?Promise.resolve(null):n(436)("./".concat(e,".json"))}().then(function(e){Object(tn.b)(e,!0)}).then(function(){return Ga}).catch(function(){}),Va=window.pixiv||{};window.pixiv=Va;var Ya=new Promise(function(e){Aa=e});Object.assign(Va,{platform:null,user:Va.user||{},context:Va.context||{},text:Va.text||{},config:Va.config||{}});var Za="https:"===window.location.protocol;Va.context.type=Va.context.type||"illust";var Ja=function(e){var t=u.a.dispatcher,n=function(n){var a=[].concat(e[n]),r=a.length>1||!!a[0];r||n!==Va.context.page||(a=[/.?/]),a.filter(Boolean).forEach(function(e){return t.connect(e,Qa[n])}),r||t.and()};for(var a in e)n(a);t.dispatch()},Qa=Ja;function Xa(){Object(nn.b)(Va.commonSourcePath||""),Object(tn.b)(Va.text),Aa(),Xt.a&&document.documentElement.classList.add("trident"),Ea(),dn(),function(){var e=h()(".followbooster-after-bookmark  ._follow-button-container");e.length>0&&new pn.a(e,{user_id:e.data("userId"),premium:!!Va.user.premium})}(),new xa,Ta.q(),h()(".selectbox").selectbox(),h()(".ui-selectbox-container").each(function(e,t){new sn.b(t,{sensitive:!0})}),g.screen.setup(),Va.context.userId&&((new cn).initialize(),(new un).initialize()),Ma.setup(),sn.d.setup();try{var e=new Wa;e.install();var t=document.URL;t.includes("search_user.php")||t.includes("group")||e.saveCurrentText()}catch(e){if(!e.toString().match(/#suggest-input|#suggest-container/))throw e;u.a.logger("suggest").warn(e.toString())}v.a.setup(),Ha.setup(),h()("body").on("click","._one-click-bookmark",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),t.preventDefault(),n=h()(t.currentTarget),a=n.dataset(),r=a.id,"illust"===(i=a.type)||"novel"===i){e.next=6;break}throw new Error("Unknown work type: ".concat(i));case 6:if(!n.hasClass("on")){e.next=11;break}o="illust"===i?"/bookmark_add.php?type=illust&illust_id=".concat(r):"/novel/bookmark_add.php?id=".concat(r),window.location.href=o,e.next=23;break;case 11:return n.addClass("on"),e.prev=12,e.next=15,Promise.resolve("illust"===i?f.a(r):m.a(r));case 15:e.sent.error?n.removeClass("on"):n.trigger("one-click-bookmark-bookmarked"),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(12),n.removeClass("on");case 23:case"end":return e.stop()}},e,this,[[12,20]])}));return function(t){return e.apply(this,arguments)}}()).on("mouseover","._one-click-bookmark",function(e){var t=h()(e.currentTarget);t.attr("title",u.a.t(t.hasClass("on")?"ブックマークを編集":"ブックマークに追加"))}),qn(),u.a.d.on("click",".js-follow-button",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h()(t.currentTarget),!(a=n.dataset("userId"))||n.hasClass("busy")){e.next=10;break}if(!n.hasClass("on")){e.next=8;break}return e.next=6,Wn(a);case 6:e.next=10;break;case 8:return e.next=10,Bn(a,n.hasClass("private"));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),u.a.d.on("click",".js-follow-edit-tooltip-close-button",function(e){e.preventDefault(),h()(".js-follow-edit-tooltip").addClass("_hidden")}),function(){var e=h()("._special-notification-modal");e.length&&!u.a.storage.cookie("special_notification_rating")&&(u.a.ui.modal.push(e,{block:!0}),e.on("uimodalclose",function(){u.a.storage.cookie("special_notification_rating",1,{expires:864e7})}))}(),function(){var e=h()(".js-recommend-to-follow-repeatedly-visited-user");if(0!==e.length&&void 0!==Va.context.userId){var t=parseInt(Va.context.userId,10),n=u.a.storage.localStorage("viewedUserIds")||[];u.a.storage.localStorage("viewedUserIds",n.concat(t).slice(-30),2592e6),n.includes(t)&&(e.removeClass("_hidden"),Da(e.get(0)))}}(),Ia.b(),qa.f(),u.a.ga.setup(),g.EventTracker.setup(),u.a.storage.cookie("closed_discovery_bubble")&&u.a.storage.cookie("closed_discovery_bubble",null),Ja({userSearch:null,bookmarkNewIllust:/bookmark_new_illust(?:_r18)?\.php$/,"*/bookmark_add":{pathname:/\/bookmark_add\.php$/,search:/.+/},search:/^\/novel\/(?:tags(?:_r18)?|search)\.php$/,setting_social_login:"/setting_social_login.php",event_member:"/event_member.php",fanbox:/^\/fanbox/,ranking:["/ranking.php","/novel/ranking.php",{pathname:"/ranking_area.php",search:/(?:^|\?|&)type=detail(?:&|$)/}],ranking_log:"/ranking_log.php",event:"/event.php","group/create":"/group/create.php",group:/^\/group\/.*/,notify_all:"/notify_all.php",content_upload:["/content_upload.php","/manga_upload.php","/member_illust_mod.php"],novel_upload:"/novel/upload.php",novel_mod:"/novel/mod.php",setting_access_block:"/setting_access_block.php",specialKiznaiver:/^\/special\/kiznaiver/,premium:"/premium.php",infoStacc:{pathname:"/info.php",search:/\bid=\b/},special18000000:/^\/special\/18000000/,illustSeries:/^\/user\/[0-9]+\/series\/[0-9]+$/,ideaBoard:/^\/idea\/$/,pixivVs:/^\/idea\/pixiv-vs\//,howto:/^\/howto/,mypage:/^\/$/}),Ra.b();try{var n=function(e){Ra.a.add(".ui-scroll-view",e.target)};document.body.addEventListener("AutoPagerize_DOMNodeInserted",n,!1),document.body.addEventListener("AutoPatchWork.DOMNodeInserted",n,!1),document.body.addEventListener("AutoPagerAfterInsert",n,!1)}catch(e){}Qt(Va.context.token),on()}function er(){sn.g.setup()}function tr(){u.a.storage.cleanup()}function nr(e){u.a.storage.cookie("user_language",e,{expires:5184e6,domain:".pixiv.net"})}function ar(e){!function(e){var t=h()(e).dataset("infoid");if(!t)return;p.g(t)}(e),h()(e).parent().parent().parent().slideUp("fast")}function rr(){}function ir(){var e=h()("._search-tutorial-modal");u.a.storage.localStorage("hideSearchTutorialModal",new Date,31536e6),e.hide()}b.c.original=document.title,Object.assign(Ja,{search:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(10).then(n.bind(null,1141));case 2:e.sent.setup();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),content_upload:function(){var e=h()(".settings");e.find(".has-options input").on("click",function(e){g.toggleState(h()(e.currentTarget).closest(".has-options").next())}).each(function(e,t){var n=h()(t);n.is(":checked")&&n.triggerHandler("click")}).end().find("input").on("click",function(t){var n=h()(t.currentTarget),a=h()(".rating-explicit-target",e),r=a[0].disabled;n.hasClass("rating-explicit")?!r&&h()(".rating-explicit",e).filter(":checked").length&&a.prop("disabled",!0).last().prop("checked",!0).end().parent().addClass("disabled"):r&&n.hasClass("rating-general")&&a.prop({disabled:!1,checked:!1}).parent().removeClass("disabled")}),h()("#form-upload").on("submit",function(e){var t=e.currentTarget;return h()('*[name="tag[]"]',t).length&&!u.a.ui.Tag.trim(h()('*[name="tag[]"]',t).val())||!h()("*[name=x_restrict_sexual]",t).filter(":checked").length||h()("*[name=sexual]",t).not(":disabled").length&&!h()("*[name=sexual]",t).filter(":checked").length?(window.alert(Va.text.requiredError),!1):!!window.confirm(Va.text.uploadConfirm)&&void h()(".submit",t).prop("disabled",!0).addClass("disabled")});var t=h()(".files tbody");t.length&&h()(".add-file-input").on("click",function(){var e=+h()("tr:last-child input",t).attr("name").slice(4),n=Array.from({length:5},function(t,n){return u.a.template("file",{page:e+n+1})});t.append(n.join(""))})},novel_upload:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(3).then(n.bind(null,451));case 2:(t=e.sent).setup(),h()("#view_tag0, #category_tags").on("click",".tag",function(e){return t.toggle(h()(e.currentTarget).dataset("tag")),!0}),h()("input[name=is_original]").on("change",function(e){"1"===h()(e.currentTarget).val()?h()("#js-post-bungei-form").slideDown():(h()("#js-post-bungei-form").slideUp(),h()("input[name=is_bungei]").prop("checked",!1))});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),novel_mod:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h()("#is_bungei").is(":checked")||h()("input[name=is_original]").on("change",function(e){"1"===h()(e.currentTarget).val()?h()("#js-post-bungei-form").slideDown():(h()("#js-post-bungei-form").slideUp(),h()("input[name=is_bungei]").prop("checked",!1))});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),ranking:function(){var e=Object(l.a)(c.a.mark(function e(){var t,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u.a.d.on("click",".rank h1 a",function(e){g.tracking.event("ranking","rank-3",h()(e.currentTarget).attr("href").slice(1))}).on("uimodalopen",".share ul",function(e){g.tracking.event("ranking","openShare",h()(e.currentTarget).dataset("rank"))}).on("uimodalopen",".info-modal",function(e){g.tracking.event("ranking","openShare-3",h()(e.currentTarget).dataset("rank"))}),e.next=3,n.e(71).then(n.bind(null,1096));case 3:t=e.sent,a=t.default,r=t.attrFilter,a.setup(),"/ranking.php"===location.pathname&&r.setup();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),bookmarkNewIllust:function(){h()(".js-close-for-new-illust-information").on("click",function(e){u.a.storage.cookie("hideInformationForBookmarkNewIllust")||u.a.storage.cookie("hideInformationForBookmarkNewIllust","1",{expires:7776e6}),h()(e.currentTarget).closest("._latest-illusts-information").addClass("_hidden")})},"*/bookmark_add":function(){var e=Object(l.a)(c.a.mark(function e(){var t,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h()(".ui-counter").each(function(e,t){new sn.a(t)}),t=h()(".tag-container .tag-cloud"),(a=t.find(".tag-orig")).remove(),r=a.dataset("tag"),t.find("li").each(function(e,t){var n=h()(t);if(n.children("span").dataset("tag")===r)return a=n,n.remove(),!1}),t.prepend(a),e.next=9,Promise.all([n.e(70).then(n.bind(null,301)).then(function(e){e.default.setup(".tag-cloud-container")}),n.e(3).then(n.bind(null,451)).then(function(e){h()(".layout-body").on("click",".tag",function(t){return e.toggle(h()(t.currentTarget).dataset("tag")),!1}),e.setup()})]);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),setting_social_login:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(69).then(n.bind(null,1084));case 2:e.sent.setup();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),event_member:function(){Ta.n.setup()},fanbox:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(11),n.e(68)]).then(n.bind(null,1102));case 2:return t=e.sent,e.next=5,t.main();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),ranking_log:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(67).then(n.bind(null,1118));case 2:t=e.sent,t.default.setup();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),event:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ta.j(Va.context.year,Va.context.month);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),"group/create":function(){new ja},group:function(){ma()},setting_access_block:function(){var e=h()("#add-user-container");e.length&&h()(".input-block-user").on("focus",function(e){h()(e.currentTarget).trigger("keydown")}).on("click",function(){return!1}).on("keydown",u.a.debounce(function(){var t=Object(l.a)(c.a.mark(function t(n){var a,r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=u.a.ui.Tag.trim(h()(n.currentTarget).val())){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,p.o(a,"s",["access_blocking"]);case 6:if("user_status"in(r=t.sent)){t.next=10;break}return e.hide(),t.abrupt("return");case 10:e.is(":hidden")&&sn.e.open(e),h()("ul",e).empty().html(u.a.template("block-user",r)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(3),e.hide();case 17:case"end":return t.stop()}},t,this,[[3,14]])}));return function(e){return t.apply(this,arguments)}}(),null,500))},premium:function(){var e=h()("._premium-payment-area");h()("._premium-payment-area input").on("change",function(t){var n=h()(t.currentTarget).dataset("payment-type"),a=h()(t.currentTarget).dataset("term-type");n?function(t){e.find(".submit-button:not(.hidden), .payment-note-area:not(.hidden)").addClass("hidden"),e.find('.submit-button[data-payment-type="'.concat(t,'"]')).removeClass("hidden"),"ticket"===t?e.find(".payment-note-area.payment-type-ticket").removeClass("hidden"):e.find(".payment-note-area.payment-type-others").removeClass("hidden")}(n):a&&function(t){e.find(".submit-button:not(.hidden), .payment-note:not(.hidden), .term-toggle:not(.hidden)").addClass("hidden"),e.find('.term-toggle[data-term-type="'.concat(t,'"]')).removeClass("hidden");e.find('.submit-button[data-payment-type="'.concat("credit",'"]')).removeClass("hidden"),e.find('.term-table[data-term-type="'.concat(t,'"] input[data-payment-type="').concat("credit",'"]')).prop("checked",!0),e.find('.payment-note[data-term-type="'.concat(t,'"]')).removeClass("hidden")}(a)}),h()('._premium-payment-area .term-table[data-term-type="1month"] input[data-payment-type="credit"]').prop("checked",!0),"#open-fontworks-campaign-modal"===window.location.hash&&sn.e.open(".js-premium-fontworks-campaign-modal",{block:!0});var t=h()(".js-premium-lp__premium-register-button-scroll"),n=h()("#premium-payment");if(n.length&&t.length){var a=!1,r=function(e){var r=u.a.w.scrollTop()>=n.offset().top-u.a.w.height()/2;(r!==a||e)&&(t.toggleClass("disabled",r),a=r)};u.a.w.on("scroll",u.a.throttle(r)),r(!0)}},notify_all:function(){var e=Va.context.notificationItems;e&&new ue("all").create(e)},userSearch:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(66).then(n.bind(null,1083));case 2:t=e.sent,t.default.setup();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),infoStacc:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(location.search){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.e(65).then(n.bind(null,1117));case 4:e.sent.default();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),specialKiznaiver:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(64).then(n.bind(null,1081));case 2:return t=e.sent,e.next=5,t.setup();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),special18000000:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(63).then(n.bind(null,1116));case 2:e.sent.setup();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),illustSeries:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(2),n.e(1),n.e(9)]).then(n.bind(null,1095));case 2:e.sent.setup();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),ideaBoard:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(62).then(n.bind(null,1115));case 2:e.sent.setup();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),pixivVs:function(){var e=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(61).then(n.bind(null,1114));case 2:e.sent.setup();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),howto:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=document.getElementById("js-knowhow"))){e.next=6;break}return e.next=4,n.e(60).then(n.bind(null,1080));case 4:e.sent.setup(t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),mypage:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=h()("#js-header-blue-belt")).length){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(n=t.dataset("storageKey"))&&!u.a.storage.localStorage(n)){e.next=6;break}return e.abrupt("return");case 6:t.removeClass("_hidden"),t.on("click",".js-close-icon",function(e){e.preventDefault(),t.addClass("_hidden"),u.a.storage.localStorage(n,!0)});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}),h()(Xa),window.onload=er,window.onunload=tr,Va.context.queries=u.a.query.base,u.a.query.replace({ref:null,uarea:null},!0),Kn.a.registerHelper("prop",function(e){switch(e){case"commonSourcePath":return Va.commonSourcePath;case"sourcePath":return Va.sourcePath}throw new Error("Invalid prop")});n(230);var or,sr=n(394),cr=n.n(sr);function lr(e,t,n){if("number"===n){if("number"!=typeof t||isNaN(t))return}else{if("string"!==n)return Object(K.i)(n);if("string"!=typeof t||""===t)return}var a=u.a.storage.localStorage("landed_pages")||{},r=[t].concat((a[e]||[]).filter(function(e){return e!==t})).slice(0,20);a[e]=r,u.a.storage.localStorage("landed_pages",a)}h()(function(){for(var e=["footer","illust_rectangle","multiple_illust_viewer"],t={},n=0;n<e.length;n++){var a=document.getElementById(e[n]);a&&(t[e[n]]={div:a,timer:null,requestFlag:!1,finishedLoading:!1})}0!==Object.keys(t).length&&(window.addEventListener("message",function(e){var n=e.data;if("object"===Object(an.a)(n))if("loaded"===n.status&&t[n.zone]){t[n.zone].finishedLoading=!0;var a=h()("#".concat(n.zone)).find("iframe")[0];a.contentWindow&&(a.contentWindow.postMessage("finishedLoading","*"),r())}else if("is_viewable"===n.status&&t[n.zone].finishedLoading&&n.url.match(/\/click\?/)&&!t[n.zone].requestFlag){var i=new URL("http:".concat(n.url));fetch("https://d.pixiv.org/viewable.txt".concat(i.search)).then(function(e){e.ok&&(t[n.zone].requestFlag=!0)}).catch(function(e){})}},!1),window.addEventListener("scroll",cr()(function(){r()},100)));var r=function(){for(var e=Object.keys(t),n=function(n){var a=e[n];if(t[a].finishedLoading&&!t[a].requestFlag){var r=h()(t[a].div),i=h()(window).scrollTop(),o=i+h()(window).height(),s=r.offset().top,c=s+r.height(),l=.2*r.height();i<s+l&&o>c-l?t[a].timer||(t[a].timer=setTimeout(function(){!function(e,n){if(!t[e].requestFlag){var a=h()("#".concat(e)).find("iframe")[0];a.contentWindow&&a.contentWindow.postMessage(n,"*")}}(a,"viewable?")},1e3)):(clearTimeout(t[a].timer),t[a].timer=null)}},a=0;a<e.length;a++)n(a)}}),function(e){e.User="user",e.Illust="illust",e.Novel="novel",e.Tag="tag"}(or||(or={})),Va.user.loggedIn||h()(function(){u.a.dispatcher.connect(/^\/member_illust\.php$/,function(){lr(or.Illust,+Va.context.illustId,"number")}).and().connect(/^\/novel\/show\.php$/,function(){lr(or.Novel,+Va.context.novelId,"number")}).and().connect(/^\/member\.php$/,function(){lr(or.User,+Va.context.userId,"number")}).and().connect(/^(\/tags\.php|\/novel\/tags\.php)$/,function(){var e=Y.a.parse(location.search,{ignoreQueryPrefix:!0});lr(or.Tag,e.tag,"string")}).dispatch()}),h()(window).on("message",function(e){switch(e.originalEvent.data){case"special-logo":document.documentElement.className+=" special-logo";break;case"branding-under":document.documentElement.className+=" branding-under";break;case"top-info":document.documentElement.className+=" top-info"}});var ur=Kn.a.template({1:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<a href="'+c("function"==typeof(i=null!=(i=n.url||(null!=t?t.url:t))?i:s)?i.call(o,{name:"url",hash:{},data:r}):i)+'" rel="prev" class="_button" title="'+c((n.t||t&&t.t||s).call(o,"前へ",{name:"t",hash:{},data:r}))+'"><i class="_icon sprites-prev-linked"></i></a>'},3:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l=n.helperMissing,u=n.blockHelperMissing,d="";return o=null!=(o=n.current||(null!=t?t.current:t))?o:l,s={name:"current",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.current||(i=u.call(t,i,s)),null!=i&&(d+=i),o=null!=(o=n.current||(null!=t?t.current:t))?o:l,s={name:"current",hash:{},fn:e.noop,inverse:e.program(6,r,0),data:r},i="function"==typeof o?o.call(c,s):o,n.current||(i=u.call(t,i,s)),null!=i&&(d+=i),d},4:function(e,t,n,a,r){var i;return'<li class="current">'+e.escapeExpression("function"==typeof(i=null!=(i=n.page||(null!=t?t.page:t))?i:n.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"page",hash:{},data:r}):i)+"</li>"},6:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<li><a href="'+c("function"==typeof(i=null!=(i=n.url||(null!=t?t.url:t))?i:s)?i.call(o,{name:"url",hash:{},data:r}):i)+'">'+c("function"==typeof(i=null!=(i=n.page||(null!=t?t.page:t))?i:s)?i.call(o,{name:"page",hash:{},data:r}):i)+"</a></li>"},8:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<a href="'+c("function"==typeof(i=null!=(i=n.url||(null!=t?t.url:t))?i:s)?i.call(o,{name:"url",hash:{},data:r}):i)+'" rel="next" class="_button" title="'+c((n.t||t&&t.t||s).call(o,"次へ",{name:"t",hash:{},data:r}))+'"><i class="_icon sprites-next-linked"></i></a>'},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l=n.helperMissing,u=n.blockHelperMissing,d='<div class="pager-container"><span class="prev">';return o=null!=(o=n.prev||(null!=t?t.prev:t))?o:l,s={name:"prev",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.prev||(i=u.call(t,i,s)),null!=i&&(d+=i),d+='</span><ul class="page-list">',o=null!=(o=n.pages||(null!=t?t.pages:t))?o:l,s={name:"pages",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.pages||(i=u.call(t,i,s)),null!=i&&(d+=i),d+='</ul><span class="next">',o=null!=(o=n.next||(null!=t?t.next:t))?o:l,s={name:"next",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.next||(i=u.call(t,i,s)),null!=i&&(d+=i),d+"</span></div>"},useData:!0}),dr=function(e){var t,n=e.current_page,a=[],r=Math.max(n-4,1),i=Math.min(r+8,e.total_pages);for(i-n<4&&(r=Math.max(i-8,1)),t=r;r<=i;++r)a.push({current:r===n,page:r,url:u.a.query.replace({p:1===r?null:r})});return ur({pages:a,prev:!(n<2)&&a[n-t-1],next:!(n>=e.total_pages)&&a[n-t+1]})},hr=n(21),pr=function(e,t){return hr.b("rpc/index.php",{mode:"message_thread",invited_user_ids:e.join(",")},t)},fr=function(e,t,n){return hr.a("rpc/index.php",{mode:"message_thread_content_images",thread_id:e,num:t},n)},mr=function(e){return hr.a("/rpc/index.php",{mode:"message_thread",thread_id:e},{cache:!1})},vr=function(e){return hr.a("/rpc/index.php",{mode:"message_thread_stars",num:e,offset:0},{cache:!1})},gr=function(e){return hr.a("/rpc/index.php",{mode:"latest_message_threads2",num:e,offset:0},{cache:!1})},br=function(e){return hr.b("/rpc/index.php",{mode:"add_message_thread_star",content_id:e})},yr=function(e){return hr.b("/rpc/index.php",{mode:"delete_message_thread_star",content_id:e})},kr=function(e,t,n){return hr.a("/rpc/index.php",{mode:"message_thread_contents",thread_id:e,num:t,max_content_id:n},{cache:!1})},wr=function(e,t){return hr.b("/rpc/index.php",{mode:"message_thread_join_request_response",content_id:e,joined:Number(t)})},_r=function(e,t){return hr.b("/rpc/index.php",{mode:"message_thread_mypixiv_request_response",content_id:e,accepted:Number(t)})},xr=function(e,t){return hr.b("/rpc/index.php",{mode:"message_thread_name",thread_id:e,name:t})},jr=function(e){return hr.b("/rpc/index.php",{mode:"leave_pair_message_thread",thread_id:e})},Or=function(e){return hr.b("/rpc/index.php",{mode:"leave_message_thread",thread_id:e})},Cr=function(e,t){return hr.b("/rpc/index.php",{mode:"invite_users_to_message_thread",thread_id:e,invitee_ids:t.join(",")})},Sr=function(e){return hr.b("/rpc/index.php",{mode:"message_thread_content_text_preview",text:e})},Tr=function(e,t){return hr.b("/rpc/index.php",{mode:"message_thread_pair_content_text_first",text:t,receiver_id:e},{cache:!1})},Ir=function(e,t){return hr.b("/rpc/index.php",{mode:"message_thread_content_image_text",thread_id:e,text:t})},Mr=function(e,t,n){var a=new FormData;return a.append("mode","message_thread_content_image_text"),a.append("thread_id",e),a.append("upfile",t),hr.b("/rpc/index.php",a,Object(ye.a)({cache:!1,contentType:!1,processData:!1},n))},Er=function(e){return hr.a("/rpc/index.php",{mode:"message_thread_star",content_id:e})},Nr=function(e){return hr.a(e)},Dr=function(e,t){if(!e||1!==e.nodeType||"FORM"!==e.nodeName)throw new TypeError("".concat(e," is not HTMLFormElement"));var n=new FormData(e);return hr.b("/rpc/index.php",n,Object(ye.a)({cache:!1,contentType:!1,processData:!1},t))},Pr=Dr,Lr=n(119);function Ur(e,t){var n;return n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?Lr.b.date:Lr.b.datetime,t.getFullYear()!==e.getFullYear()?n(t,!0):t.toDateString()!==e.toDateString()?n(t):Lr.b.time(t)}function zr(e){for(var t=e.find(".time"),n=new Date,a=Array.from(t,function(e){return h()(e)}),r=0;r<a.length;r++){var i=a[r],o=i.data("time"),s=new Date(1e3*parseInt(o,10));i.text(Ur(n,s,!0))}}h()(Object(l.a)(c.a.mark(function e(){var t,n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Va.user.id){e.next=2;break}return e.abrupt("return");case 2:if(!(t=h()(".notifications .message .count")).length){e.next=9;break}return e.next=6,Promise.resolve(hr.a("/rpc/index.php",{mode:"message_thread_unread_count"}));case 6:n=e.sent,(a=parseInt(n.body.unread_count,10))&&(a>10?t.text("10+"):t.text(a),t.show());case 9:case"end":return e.stop()}},e,this)})));var Ar=function(){try{return"function"==typeof(new FormData).append}catch(e){return!1}}();h()(function(){Va.user.id&&(h()("body").on("click","#modal-messages",function(e){var t=!1,n=h()(e.currentTarget),a=h()(e.target);n.hasClass("persist")||e.target!==e.currentTarget||(t=!0),a.hasClass("modal-cancel")&&(t=!0),t&&(n.removeClass("active"),n.find(".modal-window").html(""))}),h()("body").on("click",".request-mypixiv",function(e){e.preventDefault(),h()("#modal-messages").remove();var t=h()(".template-mypixiv-request-message");if(t.length){var n=Kn.a.compile(t.html()),a=h()(n({}));a.prependTo("#wrapper").addClass("active"),a.find("textarea.mypixiv-message").on("keyup",function(e){var t=h()(e.target),n=t.val().trim();t.parents("form").find("input[type=submit]").prop("disabled",!n.length)})}}),u.a.dispatcher.connect("/messages.php",function(){Rr.setup()}).dispatch())});var Rr={data:{threads:[],users:{}},threadContentContainer:void 0,subscribedThread:void 0,setup:function(){Rr.cache_expiry=6e4;var e=h()("html").dataset();if(Rr.threadContentContainer=h()(".thread-content-container"),e.newThread&&Rr.showExpandedInput(),h()("#body-messages").length){var t=!1;u.a.d.on("click",".mark-all-as-read",function(){var e=Object(l.a)(c.a.mark(function e(n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stopImmediatePropagation(),n.preventDefault(),window.confirm(u.a.t("すべて既読にしますか？"))){e.next=4;break}return e.abrupt("return");case 4:if(!t){e.next=6;break}return e.abrupt("return");case 6:return t=!0,e.next=9,hr.b("/rpc/index.php",{mode:"clear_unread_count"});case 9:t=!1,window.location.reload();case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())}h()(window).on("unload beforeunload",function(){var e=h()("div.input textarea.text-content").val();if(e.length)try{var t=Rr.subscribedThread.metadata.thread.thread_id,n="".concat(Va.user.id,"savedFormText-").concat(t);u.a.storage.localStorage(n,e)}catch(e){}}),Rr.tabKey=Math.random().toString().replace(".","");var n="".concat(Va.user.id,"threadListData");u.a.storage.localStorage(n,null),h()(".messages-container input.thread-list-tab").on("change",function(){return Rr.data.threads=[],Rr.threadListUpdatesPoller.runnow(),h()(".thread-list-container").removeClass("empty"),h()(".message-thread-list").removeClass("busy complete")}),Rr.threadListUpdatesPoller=new Fr(function(e){var t=(new Date).getTime();e.exe_time=t;var a=h()(".messages-container .thread-list-tab:checked").val(),r="star"===a?vr:gr,i=!1;try{n="".concat(Va.user.id,"threadListData").concat(a);var o=u.a.storage.localStorage(n),s=(new Date).getTime()-o.time>Rr.cache_expiry;o.tabKey===Rr.tabKey||s?i=!0:Rr.updateThreadListData(o.data,e)}catch(e){i=!0}if(i){Promise.resolve(r(10)).then(function(a){t===e.exe_time&&(Rr.updateThreadListData(a,e),n="".concat(Va.user.id,"threadListData"),u.a.storage.localStorage(n,{data:a,tabKey:Rr.tabKey,time:(new Date).getTime()}))}).catch(function(){e.level=100,e.run()})}}),Rr.threadListUpdatesPoller.runnow(),h()("#page-messages .thread-list-container ul.message-thread-list").on("click","li.thread",function(e){var t=h()(e.currentTarget);if(!t.hasClass("active")){var n=t.data("threadId");if(t.data("contentId")){var a=t.data("contentId");Rr.showStar({contentId:a})}else Rr.subscribeThread({threadId:n})}}),h()(".thread-content-container").on("click","a",function(e){var t=h()(e.target);t.hasClass("void")||t.attr("target","_blank")}),h()(".thread-content-container").on("change",".input .attach-content input[type=file]",function(e){var t,n=h()(e.target),a=n.prop("files"),r=n.parents("div.input").find(".image-preview");if(n.val().length){try{var i=a[0];t=i.name;var o=new FileReader;o.onload=function(){r.css("background-image",Object(K.b)(o.result))},o.readAsDataURL(i)}catch(e){t=n.val()}r.text(t)}else r.text("")}),h()(".thread-content-container").on("paste",".input form.submit-message-short textarea",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h()(t.target),a=n.data("threadId"),r=t.originalEvent,e.prev=3,i=r.clipboardData.items,null!=(o=Array.from(i).find(function(e){return null!=e.type.match(/^image\//)}))){e.next=8;break}return e.abrupt("return");case 8:return s=o.getAsFile(),l=h()('<div class="progress-bar"></div>'),e.prev=10,n.parents(".input").append(l),e.next=14,Promise.resolve(Mr(a,s,{ajaxSettings:{xhr:function(){var e=new XMLHttpRequest;return e.upload.onprogress=function(e){var t=e.loaded,n=e.total;l.css("width","".concat(Math.round(100*t/n),"%"))},e}}}));case 14:return e.prev=14,l.remove(),n.val(""),e.finish(14);case 18:Rr.subscribedThread.poller.runnow(),Rr.threadListUpdatesPoller.runnow(),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(3),Rr.handleError(e.t0,n);case 25:case"end":return e.stop()}},e,this,[[3,22],[10,,14,18]])}));return function(t){return e.apply(this,arguments)}}());var a=h()(".thread-content-container .input"),r=h()(".thread-content-container"),i=h()(".message-content-list",r);r.on("resize cut paste change click input",".submit-message-short textarea",function(e){var t=h()(e.target),n=i.scrollTop(),o=i[0].scrollHeight,s=i.innerHeight()+n>=o;t.innerHeight(t[0].scrollHeight);for(var c=100;t[0].scrollHeight<=t.innerHeight()&&c>0;)t.innerHeight(t.innerHeight()-2),c--;var l=t.innerHeight();l>62&&t.innerHeight(l+2),r.css("padding-bottom",a.innerHeight()),s&&i.scrollTop(i[0].scrollHeight)}),h()(".thread-content-container .input").length&&h()(".thread-content-container").on("keydown",".input form.submit-message-short textarea",function(e){h()(e.target).parents(".thread-content-container").hasClass("fullscreen-form")||("Enter"===e.key&&(e.altKey||e.shiftKey)?(e.preventDefault(),e.stopImmediatePropagation(),h()(e.target).parents("form").trigger("submit")):h()(e.target).trigger("resize"))}),h()(".thread-content-container").on("mouseenter","li.message-content .star",function(e){h()(e.currentTarget).find("._icon-star").addClass("_ui-tooltip")}),h()(".thread-content-container").on("click","li.message-content .star",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=h()(t.currentTarget)).hasClass("busy")){e.next=3;break}return e.abrupt("return");case 3:return n.addClass("busy"),a=n.parents("li.message-content"),r=a.data("contentId"),i=n.hasClass("active"),o=i?yr:br,i?n.removeClass("busy active"):n.addClass("active"),e.prev=9,e.prev=10,e.next=13,Promise.resolve(o(r));case 13:n.parents(".messages-container").find("input.thread-list-tab.star:checked").trigger("change"),n.find("._icon-star").removeClass("_ui-tooltip");case 15:return e.prev=15,n.removeClass("busy"),e.finish(15);case 18:Rr.clearError(n),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(9),i?n.addClass("active"):n.removeClass("active"),Rr.handleError(e.t0,n);case 25:case"end":return e.stop()}},e,this,[[9,21],[10,,15,18]])}));return function(t){return e.apply(this,arguments)}}()),h()(".thread-content-container").on("click","li.message-content .delete-star",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=h()(t.currentTarget)).hasClass("busy")){e.next=3;break}return e.abrupt("return");case 3:if(window.confirm(n.dataset("confirmText"))){e.next=5;break}return e.abrupt("return");case 5:return n.addClass("busy"),a=n.closest("li.message-content"),r=a.data("contentId"),e.prev=8,e.next=11,Promise.resolve(yr(r));case 11:n.parents(".messages-container").find("input.thread-list-tab.star:checked").trigger("change"),n.parent().find("._icon-star").remove(),n.remove(),Rr.clearError(n),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(8),n.removeClass("busy"),Rr.handleError(e.t0,n);case 21:case"end":return e.stop()}},e,this,[[8,17]])}));return function(t){return e.apply(this,arguments)}}()),h()(".thread-content-container").on("click","li.message-content .popup-resend-actions .actions .cancel-message",function(e){h()(e.target).parents("li.message-content").remove()}),h()(".thread-content-container").on("click","li.message-content .popup-resend-actions .actions .resend-message",function(e){var t=h()(e.target),n=t.data("textContent"),a=t.parents(".thread-content-container").find(".input form.submit-message-short");a.find("textarea").val(n),a.trigger("submit"),t.parents("li.message-content").remove()}),h()("ul.message-content-list").on("scroll",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.target.scrollTop>300)){e.next=2;break}return e.abrupt("return");case 2:if(!(n=h()(t.target)).hasClass("no-history")){e.next=5;break}return e.abrupt("return");case 5:if(!n.hasClass("busy")){e.next=7;break}return e.abrupt("return");case 7:return n.addClass("busy"),a=n.parents(".thread-content-container"),r=a.find("ul.message-content-list"),i=r.data("threadId"),o=r.find("li.message-content").first().data("contentId"),e.prev=12,e.next=15,Promise.resolve(kr(i,11,o));case 15:s=e.sent,n.removeClass("busy"),Rr.updateThreadContentData(s.body),Br.renderThreadContent(),Rr.clearError(t.target),e.next=28;break;case 22:return e.prev=22,e.t0=e.catch(12),Rr.handleError(e.t0,t.target),e.next=27,Object(Ye.b)(1e4);case 27:n.removeClass("busy");case 28:case"end":return e.stop()}},e,this,[[12,22]])}));return function(t){return e.apply(this,arguments)}}()),h()(".thread-content-container").on("click",".join-request .request-pending",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h()(t.target),a=n.data("response"),r=n.parents(".message-content"),i=r.data("contentId"),o=n.parents(".join-request"),!r.hasClass("busy")){e.next=9;break}return t.preventDefault(),t.stopImmediatePropagation(),e.abrupt("return");case 9:if(r.addClass("busy"),null!=(l=(s="accept"===a)?"status-1":"decline"===a?"status-2":null)){e.next=16;break}return t.preventDefault(),t.stopImmediatePropagation(),e.abrupt("return");case 16:return e.prev=16,e.next=19,wr(i,s);case 19:r.removeClass("busy"),o.removeClass("status-0").addClass(l),s&&Rr.threadListUpdatesPoller.runnow(),Rr.clearError(n),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(16),r.removeClass("busy"),Rr.handleError(e.t0,n);case 29:case"end":return e.stop()}},e,this,[[16,25]])}));return function(t){return e.apply(this,arguments)}}()),h()(".thread-content-container").on("click",".mypixiv-request .request-pending",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h()(t.target),r=a.data("response"),i=a.parents(".message-content"),o=i.data("contentId"),s=a.parents(".mypixiv-request"),!i.hasClass("busy")){e.next=9;break}return t.stopImmediatePropagation(),t.preventDefault(),e.abrupt("return");case 9:if(i.addClass("busy"),!(l="accept"===r)){e.next=15;break}n="status-1",e.next=22;break;case 15:if("decline"!==r){e.next=19;break}n="status-2",e.next=22;break;case 19:return t.stopImmediatePropagation(),t.preventDefault(),e.abrupt("return");case 22:return e.prev=22,e.next=25,_r(o,l);case 25:i.removeClass("busy"),s.removeClass("status-0").addClass(n),Rr.clearError(a),e.next=34;break;case 30:e.prev=30,e.t0=e.catch(22),i.removeClass("busy"),Rr.handleError(e.t0,a);case 34:case"end":return e.stop()}},e,this,[[22,30]])}));return function(t){return e.apply(this,arguments)}}()),Rr.threadContentContainer.on("submit",".submit-message-short",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=h()(e.target),n=t.find("textarea.text-content").val().trim(),a=t.parents("div.input").find("form.attach-content input[name=upfile]").val().length;n&&a?Rr.postTextAndImage(e):a?Rr.postImage(e):n&&Rr.postText(e)}).on("click",".image-preview-container",function(e){return Rr.removeImageFile(e)}).on("click",".expand-input",function(){Rr.showExpandedInput()}).on("forward",".input .submit-preview textarea",function(){Rr.showExpandedInput()}).on("click",".reply",function(e){Rr.replyWithQuote(e)}).on("click",".action-revise",Rr.hidePreview).on("click",".action-cancel-input",function(e){return Rr.hideInput(e)}).on("submit",".submit-preview",function(e){return Rr.showPreview(e)}).on("submit",".submit-previewed-message",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=h()(e.target).parents("div.input"),n=Rr.latestPreviewText;t.find("textarea.text-content").val(n);var a=t.find("form.attach-content input[name=upfile]").val().length;n&&a?Rr.postTextAndImage(e):a?Rr.postImage(e):n&&Rr.postText(e)});var o=h()("#page-messages .messages-container");o.data("threadId")&&Rr.subscribeThread({threadId:o.data("threadId")});var s=h()("#modal-messages"),d=300;function f(e){return m.apply(this,arguments)}function m(){return(m=Object(l.a)(c.a.mark(function e(t){var n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((n=h()(t)).is(":visible")){e.next=3;break}return e.abrupt("return");case 3:if(a=n.data("nextUrl")){e.next=7;break}return n.addClass("complete"),e.abrupt("return");case 7:return n.addClass("busy"),e.prev=8,e.prev=9,e.next=12,Promise.resolve(Nr(a));case 12:if(r=e.sent,n.is(":visible")){e.next=15;break}return e.abrupt("return");case 15:if(Rr.updateThreadListData(r),n.removeClass("busy"),!r.body.next_url){e.next=27;break}return e.next=20,Object(Ye.b)(100);case 20:if(!(n.scrollTop()+d<n[0].scrollHeight-n.innerHeight())){e.next=23;break}return e.abrupt("return");case 23:return e.next=25,f(n);case 25:e.next=28;break;case 27:n.addClass("complete");case 28:return e.prev=28,Rr.clearError(t),e.finish(28);case 31:e.next=39;break;case 33:return e.prev=33,e.t0=e.catch(8),Rr.handleError(e.t0,t),e.next=38,Object(Ye.b)(1e4);case 38:n.removeClass("busy");case 39:case"end":return e.stop()}},e,this,[[8,33],[9,,28,31]])}))).apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return(g=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s,l,u;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.parents("form").data("threadId")){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Promise.resolve(mr(n));case 5:for(a=e.sent,r=a.users,i=r.map(function(e){try{return parseInt(e.user_id,10)}catch(e){return 0}}),o=Array.from(t.find(">li"),function(e){return h()(e)}),s=0;s<o.length;s++)l=o[s],u=l.data("userId"),i.includes(u)&&l.find("input").prop("disabled",!0);case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=Object(l.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data("nextUrl")){e.next=4;break}return t.addClass("complete"),e.abrupt("return");case 4:return t.addClass("busy"),e.next=7,Promise.resolve(Nr(n));case 7:return a=e.sent,t.data("nextUrl",a.next_url),t.append(u.a.template("yaritori-list-item",{users:a.body.users})),e.next=12,v(t);case 12:if(t.removeClass("busy"),a.next_url||t.addClass("complete"),!(t[0].scrollHeight<=t.innerHeight())){e.next=17;break}return e.next=17,b(t);case 17:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function k(e){return w.apply(this,arguments)}function w(){return(w=Object(l.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data("nextUrl")){e.next=4;break}return t.addClass("complete"),e.abrupt("return");case 4:return t.addClass("busy"),e.prev=5,e.next=8,Nr(n);case 8:if(a=e.sent,Rr.updateThreadImagesData(a.body)&&Br.showThreadFile(),t.removeClass("busy"),!a.body.next_url){e.next=20;break}if(t.data("nextUrl",a.body.next_url),!(t.scrollTop()<t[0].scrollHeight-t.innerHeight())){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,k(t);case 18:e.next=21;break;case 20:t.addClass("complete");case 21:Rr.clearError(t),e.next=30;break;case 24:return e.prev=24,e.t0=e.catch(5),Rr.handleError(e.t0,t),e.next=29,Object(Ye.b)(1e4);case 29:t.removeClass("busy");case 30:case"end":return e.stop()}},e,this,[[5,24]])}))).apply(this,arguments)}h()("#page-messages .message-thread-list").on("scroll",function(e){var t=h()(e.currentTarget);t.hasClass("complete")||(t.hasClass("busy")||t.scrollTop()+d<t[0].scrollHeight-t.innerHeight()||f(t))}),h()(".thread-content-container").on("click",".actions .action-thread-name",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=h()(e.target);s.find(".modal-window").html("");var n=h()(".template-message-title-change");if(n.length){var a=Kn.a.compile(n.html()),r=h()(a({}));r.find("form").on("submit",function(){var e=Object(l.a)(c.a.mark(function e(n){var a,r,i,o,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),n.stopImmediatePropagation(),s.removeClass("active persist"),r=h()(n.target).serializeArray(),i=0;case 5:if(!(i<r.length)){e.next=13;break}if("thread_title"===(o=r[i]).name){e.next=9;break}return e.abrupt("continue",10);case 9:a=o.value;case 10:i++,e.next=5;break;case 13:return l=t.parents(".actions").data("threadId"),e.next=16,Promise.resolve(xr(l,a));case 16:Rr.subscribedThread.poller.runnow(),Rr.threadListUpdatesPoller.runnow();case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),s.find(".modal-window").append(r),s.addClass("active persist"),r.find("input[type=text]").trigger("focus")}}),h()(".thread-content-container").on("change",".actions .action-thread-icon input[type=file]",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h()(t.target),a=n.parents("form"),r=n.parents(".actions").data("threadId"),a.find("input[name=thread_id]").val(r),!Ar){e.next=20;break}return e.prev=5,e.next=8,Pr(a[0]);case 8:n.val(""),Rr.subscribedThread.poller.runnow(),Rr.threadListUpdatesPoller.runnow(),Rr.clearError(t.target),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(5),n.val(""),Rr.handleError(e.t0,t.target);case 18:e.next=27;break;case 20:a.find("input[name=tt]").val(Va.context.token),i="dummy_iframe",(o=h()("<iframe>")).hide().attr("name",i).attr("src","").on("load",function(e){e.target.contentDocument.body.innerText.length&&(Rr.subscribedThread.poller.runnow(),Rr.threadListUpdatesPoller.runnow(),n.val(""),o.remove())}),n.parents(".messages-container").append(o),a.attr("target",i),a.trigger("submit");case 27:case"end":return e.stop()}},e,this,[[5,14]])}));return function(t){return e.apply(this,arguments)}}()),h()("#page-messages").on("click",".actions .leave-thread",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s,l,u,d,p;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h()(t.currentTarget),confirm(n.data("leaveString"))){e.next=5;break}return t.preventDefault(),t.stopImmediatePropagation(),e.abrupt("return");case 5:return a=n.parents(".actions").data("threadId"),r=n.parents(".is-pair").length?jr:Or,e.next=9,Promise.resolve(r(a));case 9:i=Rr.data.threads,o=!0,s=!1,l=void 0,e.prev=13,u=i.keys()[Symbol.iterator]();case 15:if(o=(d=u.next()).done){e.next=23;break}if(p=d.value,i[p].thread_id!=="".concat(a)){e.next=20;break}return Rr.data.threads.splice(p,1),e.abrupt("break",23);case 20:o=!0,e.next=15;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(13),s=!0,l=e.t0;case 29:e.prev=29,e.prev=30,o||null==u.return||u.return();case 32:if(e.prev=32,!s){e.next=35;break}throw l;case 35:return e.finish(32);case 36:return e.finish(29);case 37:Rr.unsubscribeThread(),Br.renderThreadList(),Rr.threadListUpdatesPoller.runnow();case 40:case"end":return e.stop()}},e,this,[[13,25,29,37],[30,,32,36]])}));return function(t){return e.apply(this,arguments)}}()),h()("#page-messages").on("click",".followed-users-list",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=h()(t.currentTarget),a=n.parents(".actions").data("threadId"),e.next=4,p.d(0,20,{cache:!1});case 4:if(r=e.sent,s.find(".modal-window").html(""),s.find(".modal-window").append(u.a.template("yaritori-list-items",{users:r.body.users,thread_id:a})),s.addClass("active"),v(i=h()("#modal-messages ul.yaritori-list")),i.data("nextUrl",r.next_url),i.on("scroll",function(){i.hasClass("complete")||(i.hasClass("busy")||i.scrollTop()+300<i[0].scrollHeight-i.innerHeight()||b(i))}),!(i[0].scrollHeight<=i.innerHeight())){e.next=15;break}return e.next=15,b(i);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),h()("#page-messages .actions").on("click",".thread-member-num",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=h()(t.currentTarget),a=n.parents(".actions").data("threadId"),s.find(".modal-window").html(""),e.next=5,mr(a);case 5:r=e.sent,(i=r.users.find(function(e){return e.user_id===Va.user.id}))&&(i.self=!0),s.find(".modal-window").append(u.a.template("thread-member-list",{data:r})),s.addClass("active");case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),s.on("submit","form.yaritori-users",function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,l,u,d,p,f,m,v,g;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t.preventDefault(),t.stopImmediatePropagation(),n=[],a=h()(t.target),r=a.serializeArray(),i=Array.from(r),o=0;o<i.length;o++)"selected_users"===(l=i[o]).name&&n.push(l.value);if(!(n.length<1)){e.next=9;break}return e.abrupt("return");case 9:if(u=a.find("input[name=selected_users]:checked"),d=[],u.each(function(e,t){var n=h()(t).parents("li");d.push({user_name:n.data("userName"),user_id:n.data("userId"),icon_url:n.data("iconUrl")})}),p={invitee_list:!0,system:!0,content:{type:"invitee_list",users:d}},Rr.data.temp_content||(Rr.data.temp_content={}),(f=a.find("input[type=submit]")).prop("disabled",!0),!(m=a.data("threadId"))){e.next=29;break}return s.removeClass("active"),e.prev=19,e.next=22,Promise.resolve(Cr(m,n));case 22:Rr.threadListUpdatesPoller.runnow(),Rr.subscribedThread.poller.runnow(),Rr.data.temp_content[m]=p;case 25:return e.prev=25,f.prop("disabled",!1),e.finish(25);case 28:return e.abrupt("return");case 29:if(!(n.length>1)){e.next=51;break}return e.prev=30,e.prev=31,e.next=34,pr(n);case 34:v=e.sent,g=v.body.thread_id,Rr.subscribeThread({threadId:g}),s.removeClass("active"),Rr.threadListUpdatesPoller.runnow(),Rr.data.temp_content[g]=p;case 40:return e.prev=40,f.prop("disabled",!1),e.finish(40);case 43:Rr.clearError(t.target),e.next=49;break;case 46:e.prev=46,e.t0=e.catch(30),Rr.handleError(e.t0,t.target);case 49:e.next=52;break;case 51:location.href="/messages.php?receiver_id=".concat(n.join(","));case 52:case"end":return e.stop()}},e,this,[[19,,25,28],[30,46],[31,,40,43]])}));return function(t){return e.apply(this,arguments)}}()),h()("#page-messages").on("click","._message-attachments-container .more",function(){s.find(".modal-window").html(""),s.find(".modal-window").append(u.a.template("modal-image-list")),s.addClass("active"),Br.showThreadFile(),s.find("ul.message-image-list").on("scroll",function(e){var t=h()(e.currentTarget);t.hasClass("complete")||(t.hasClass("busy")||t.scrollTop()+300<t[0].scrollHeight-t.innerHeight()||k(t))}).trigger("scroll")});var _=h()("#page-messages .star-tutorial");return u.a.storage.localStorage("starTutorialClosed")||_.addClass("active"),h()("#page-messages").on("click",".star-tutorial .close",function(){_.css("opacity",0),setTimeout(function(){return _.removeClass("active")},200),u.a.storage.localStorage("starTutorialClosed",!0)})},updateUser:function(e){for(var t=Array.from(e),n=0;n<t.length;n++){var a=t[n];Rr.data.users[a.user_id]=a}return Rr.data.users},findUser:function(e){return Rr.data.users[e]},findLatestAnotherContent:function(e){var t=Rr.subscribedThread;if(t){for(var n=[],a=Array.from(t.contents),r=0;r<a.length;r++){var i=a[r];i.self||e&&i.content.type!==e||n.push(i)}return n.sort(function(e,t){return+t.content_id-+e.content_id}),n[0]}return null},latestMessageText:function(e){var t=Rr.findLatestAnotherContent("text"),n=null!=t?t.content.text.trim():t;return n&&(n=Rr.stripText(n),e&&(n="> ".concat(n.split("\n").join("\n> ")))),n},stripText:function(e){var t=e.replace(/<br(?: \/)?>/gi,"\n").replace(/<.*?>/g,"");return u.a.html.unescape(t)},replyWithQuote:function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h()(t.currentTarget),a=n.data("threadId"),r=n.parents(".text").find(".content-body"),i=h()("<div>"),o="\n\n".concat(r.html().split("<br>").map(function(e){return"> ".concat(i.html(e).text())}).join("\n")),!a){e.next=11;break}return e.next=8,Rr.subscribeThread({threadId:a});case 8:if(e.sent){e.next=11;break}return e.abrupt("return");case 11:(s=h()(".submit-preview textarea",Rr.threadContentContainer)).val(o).trigger("forward");try{(l=s.get(0)).selectionStart=l.selectionEnd=0}catch(e){}case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),removeImageFile:function(e){if(e.target===e.currentTarget){var t=h()(e.target),n=t.siblings("input[name=upfile]");n.replaceWith(n.clone()),n.remove(),t.siblings("input[name=upfile]").trigger("change")}},showExpandedInput:function(){var e=Rr.latestMessageText(!0)||"";e&&(e="\n\n".concat(e));var t=h()(".submit-message-short textarea",Rr.threadContentContainer).val().trim(),n=h()(".submit-preview textarea",Rr.threadContentContainer).val().trim();t&&(e=t+e),Rr.threadContentContainer.addClass("expanded");var a=h()(".submit-preview textarea",Rr.threadContentContainer).get(0);n||h()(a).val(e),a.focus();try{a.selectionStart=a.selectionEnd=0}catch(e){}},showPreview:function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopImmediatePropagation(),n=h()(".submit-preview textarea",Rr.threadContentContainer),a=n.val().trim()){e.next=7;break}return n.val("").trigger("focus"),e.abrupt("return");case 7:return Rr.latestPreviewText=a,h()(".attach-content",Rr.threadContentContainer).addClass("_hidden"),Rr.hideExpandedInput(),r=h()(".message-preview-container").removeClass("_hidden"),h()(".preview",r).html(""),e.next=14,Sr(a);case 14:i=e.sent,(o=i.body).is_complete_user=!0,o.self=!0,o.preview=!0,h()(".preview",r).html(u.a.template("thread-content",{content:o}));case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),postText:function(){var e=Object(l.a)(c.a.mark(function e(t,n){var a,r,i,o,s,d,p,f,m,v,g,b,y,k,w,_;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopImmediatePropagation(),Rr.hidePreview(),a=Rr.threadContentContainer.removeClass("expanded").find(".submit-message-short textarea").trigger("focus"),n&&a.val(""),r=h()(".submit-message-short",Rr.threadContentContainer),i=h()("textarea",r).trigger("change"),o=(n||i.val()).trim()){e.next=10;break}return e.abrupt("return");case 10:return i.parents("div.input").find("textarea").val(""),i.trigger("focus"),s=i.data("threadId"),d=i.parents(".messages-container"),Rr.threadContentContainer.find("textarea").trigger("change"),(p=i.data("receiverId"))&&function(){var e=Object(l.a)(c.a.mark(function e(){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.resolve(Tr(p,o));case 3:n=e.sent,i.parents("form").removeClass("new-receiver"),i.data("receiverId",""),a=n.body.thread_id,Rr.subscribeThread({threadId:a}),Rr.clearError(t.target),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),i.val(o).trigger("focus"),Rr.handleError(e.t0,t.target);case 15:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()(),f=Va.user.id,m=Rr.subscribedThread.metadata.users,v=h()("<div>").text(o).html(),g=Array.from(m).find(function(e){return e.user_id===f}),b={content:{type:"text",text:v},content_id:"temp",self:!0,temp:!0,thread_id:s,user:{user_id:g.user_id,user_name:g.user_name,icon_url:{main_s:g.icon_url}}},(y=h()(h.a.parseHTML(u.a.template("thread-content",{content:b})))).addClass("busy"),k=d.find("ul.message-content-list"),y.appendTo(k),k.scrollTop(k[0].scrollHeight),e.prev=27,e.next=30,Promise.resolve(Ir(s,o));case 30:y.addClass("success"),u.a.storage.localStorage("threadContentData-".concat(s),null);try{Rr.subscribedThread.poller.runnow(),Rr.threadListUpdatesPoller.runnow()}catch(e){}try{w=Rr.subscribedThread.metadata.thread.thread_id,_="".concat(Va.user.id,"savedFormText-").concat(w),u.a.storage.localStorage(_,null)}catch(e){}Rr.clearError(t.target),e.next=41;break;case 37:e.prev=37,e.t0=e.catch(27),y.removeClass("busy"),Rr.handleError(e.t0,t.target);case 41:case"end":return e.stop()}},e,this,[[27,37]])}));return function(t,n){return e.apply(this,arguments)}}(),postTextAndImage:function(e){var t=h()(e.target).parents("div.input"),n=t.find("textarea.text-content").val().trim();t.find("form.attach-content").find("input[name=text]").val(n),Rr.postImage(e)},postImage:function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h()(t.target).parents("div.input"),(a=n.find("form.attach-content")).attr("target",""),!Ar){e.next=21;break}return r=h()('<div class="progress-bar"></div>'),n.append(r),e.prev=6,e.next=9,Dr(a[0],{xhr:function(){var e=new XMLHttpRequest;return e.upload.onprogress=function(e){var t=e.loaded,n=e.total,a=Math.round(100*t/n),i="".concat(a,"%");r.css("width",i)},e}});case 9:i=e.sent,r.remove(),Rr.postImageDone(a,i),Rr.clearError(t.target),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(6),r.remove(),Rr.handleError(e.t0,t.target);case 19:e.next=29;break;case 21:a.find("input[name=tt]").val(Va.context.token),o="dummy_iframe",(s=h()("<iframe>")).hide().attr("name",o).attr("src","").on("load",function(e){var t=e.target;if(t.contentDocument.body.innerText.length){var n=JSON.parse(t.contentDocument.body.innerText);Rr.postImageDone(a,n),s.remove()}}),n.parents(".messages-container").append(s),a.attr("target",o),a.trigger("submit");case 29:case"end":return e.stop()}},e,this,[[6,15]])}));return function(t){return e.apply(this,arguments)}}(),postImageDone:function(e,t){var n=e.parents("div.input");if(e.hasClass("new-receiver")){e.removeClass("new-receiver");var a=t.body.thread_id;Rr.subscribeThread({threadId:a})}else Rr.subscribedThread.poller.runnow();Rr.threadListUpdatesPoller.runnow();var r=e.find("input[type=file]");r.replaceWith(r.clone()),r.remove(),e.find("input[type=file]").trigger("change"),e.find("input[name=text]").val(""),Rr.hidePreview(),Rr.threadContentContainer.removeClass("expanded"),n.find("textarea").val("");try{var i=Rr.subscribedThread.metadata.thread.thread_id,o="".concat(Va.user.id,"savedFormText-").concat(i);u.a.storage.localStorage(o,null)}catch(e){}},hideInput:function(e){e&&(e.preventDefault(),e.stopImmediatePropagation());var t=h()(".submit-preview textarea",Rr.threadContentContainer).val();h()(".submit-preview textarea",Rr.threadContentContainer).val(""),t=t.replace(/^> .*\s?$/gm,"").trim(),Rr.hidePreview();var n=Rr.threadContentContainer.removeClass("expanded").find(".submit-message-short textarea").trigger("focus");t&&n.val(t);var a=n[0];try{a.selectionStart=a.selectionEnd=a.value.length}catch(e){}},hideExpandedInput:function(){h()(".submit-preview",Rr.threadContentContainer).addClass("_hidden")},hidePreview:function(e){e&&(e.preventDefault(),e.stopImmediatePropagation()),h()(".message-preview-container").addClass("_hidden"),h()(".submit-preview",Rr.threadContentContainer).removeClass("_hidden").find("textarea").trigger("focus"),h()(".attach-content",Rr.threadContentContainer).removeClass("_hidden")},getErrorContainer:function(e){if(e){var t=h()(e).parents(".error-displayed");if(t.length)return t}},clearError:function(e){var t=Rr.getErrorContainer(e);t&&t.removeClass("has-error")},handleError:function(e,t){var n=Rr.getErrorContainer(t);if(n){Rr.clearError(t);var a,r=null!=e&&null!=e.statusText?e.statusText:void 0,i=!1;try{(a=void 0!==e.responseText?JSON.parse(e.responseText):e)&&a.error&&(i=!0)}catch(e){i=!0}if(i){var o=null!=a&&null!=a.message?a.message:r;o||(o=n.data("defaultError")),n.find(".error-container").text(o),n.addClass("has-error")}}},showStar:function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s,l,u,d,p,f,m,v,g;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Rr.unsubscribeThread(),n=h()(".messages-container"),Rr.hideInput(),a="".concat(t.contentId).replace(/\D/g,""),n.find(".thread-content-container").addClass("loading"),n.find(".message-content-list").html(""),r=Rr.data.threads.find(function(e){return e.content_id===a}),e.next=9,Promise.resolve(Er(a));case 9:if(!(i=e.sent).body.link_url){e.next=28;break}for((o={}).contents=i.body.contents,o.thread_id="c".concat(a),o.contents[o.contents.length-1].tornoff=!0,s=o.contents[0].thread_id,l=Array.from(o.contents),u=0;u<l.length;u++)(d=l[u]).current=+d.content_id==+a,d.force_rerender=!0;return Rr.subscribedThread=o,e.next=21,Rr.subscribeThread({append:!0,threadId:s});case 21:if(!e.sent){e.next=26;break}p=h()(".thread-content-container .body"),h()(".current",p)[0].scrollIntoView(),p.scrollTop(p.scrollTop()-40);case 26:e.next=40;break;case 28:for((f={}).container=n,f.contents=i.body.contents,m=Array.from(f.contents),v=0;v<m.length;v++)(g=m[v]).current=+g.content_id==+a,g.content.star_view=!0;f.images=[],f.no_history=!0,f.read_only=!0,f.metadata={thread:r,users:[]},Rr.subscribedThread=f,Br.renderThreadContent(),Br.renderThreadImages();case 40:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),subscribeThread:function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,s,d,p,f,m,v,g,b,y,k,w,_,x,j,O;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Rr.hideInput();try{n=Rr.subscribedThread.metadata.thread.thread_id,a="".concat(Va.user.id,"savedFormText-").concat(n),r=h()("div.input textarea.text-content").val(),u.a.storage.localStorage(a,r)}catch(e){}return(i=h()("div.input input[type=file]")).replaceWith(i.clone()),i.remove(),h()("div.input input[type=file]").trigger("change"),o=h()(".messages-container"),s="".concat(t.threadId).replace(/\D/g,""),d=t.append||!1,o.find(".thread-content-container").addClass("loading"),e.next=12,mr(s);case 12:if(p=e.sent,f=p.thread.is_pair,m=p.thread.pair_user_id,+p.thread.unread_num>10&&"10+",v="".concat(Va.user.id,"savedFormText-").concat(p.thread.thread_id),g=h()("div.input textarea.text-content"),(b=u.a.storage.localStorage(v))?g.val(b):g.val(""),(y=Array.from(Rr.data.threads).find(function(e){return e.thread_id===s}))&&(y.modified_at=p.thread.modified_at,y.unread_num=p.thread.unread_num,y.member_num=p.thread.member_num,y.latest_content=p.thread.latest_content),void 0===Rr.subscribedThread){e.next=27;break}if(d||s!==Rr.subscribedThread.metadata.thread.thread_id){e.next=26;break}return e.abrupt("return",void 0);case 26:Rr.subscribedThread.poller&&Rr.subscribedThread.poller.end();case 27:h()(".input.new-receiver").removeClass("new-receiver"),k="".concat(Va.user.id,"threadContentData-").concat(s);try{for(w in window.localStorage)w.match("threadContentData-")&&u.a.storage.localStorage(w,null)}catch(e){}try{_=document.location.pathname,history.replaceState({},"","".concat(_,"?thread_id=").concat(s))}catch(e){}return h()(".message-thread-list .thread-".concat(s," .unread_num")).addClass("unread-0"),x=d?Rr.subscribedThread.contents:[],d&&(p.thread.thread_id_2=Rr.subscribedThread.thread_id),j={},O=new Promise(function(e,t){j.resolve=e,j.reject=t}),Rr.subscribedThread={metadata:p,is_pair:f,pair_user_id:m,container:o,contents:x,no_history:!1,poller:new Fr(function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a,r,i,o,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=(new Date).getTime(),t.exe_time=n,a=!1;try{r=u.a.storage.localStorage(k),i=(new Date).getTime()-r.time>Rr.cache_expiry,r.tabKey===Rr.tabKey||i?a=!0:Rr.updateThreadContentData(r.data.body)?(Br.renderThreadContent(),t.levelup()):t.run()}catch(e){a=!0}if(!a){e.next=24;break}return e.prev=5,e.next=8,Promise.resolve(kr(s,10));case 8:if(o=e.sent,n===t.exe_time){e.next=11;break}return e.abrupt("return");case 11:u.a.storage.localStorage(k,{innerData:o,tabKey:Rr.tabKey,time:(new Date).getTime()}),l=Rr.updateThreadContentData(o.body),d||l?(Br.renderThreadContent(),t.levelup(),d&&(Rr.threadListUpdatesPoller.runnow(),d=!1)):t.run(),j.resolve(!0),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(5),t.level=100,t.run(),j.reject(e.t0);case 22:e.next=25;break;case 24:j.resolve(!1);case 25:case"end":return e.stop()}},e,this,[[5,17]])}));return function(t){return e.apply(this,arguments)}}())},Rr.subscribedThread.poller.runnow(),Rr.getLatestImages(s),e.abrupt("return",O);case 40:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getLatestImages:function(){var e=Object(l.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h()("#page-messages").length){e.next=2;break}return e.abrupt("return");case 2:return delete Rr.subscribedThread.images,e.next=5,Promise.resolve(fr(t,8,{cache:!1}));case 5:n=e.sent,Rr.updateThreadImagesData(n.body)&&Br.renderThreadImages();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),unsubscribeThread:function(){if(void 0!==Rr.subscribedThread){var e=Rr.subscribedThread;e.poller&&e.poller.end(),delete Rr.subscribedThread,Br.renderThreadContent()}},updateThreadContentData:function(e){var t;if(void 0===Rr.subscribedThread)return!1;var n=parseInt(Rr.subscribedThread.metadata.thread.thread_id),a=!1;e.next_url||(Rr.subscribedThread.no_history=!0);for(var r=e.message_thread_contents,i=Rr.subscribedThread.contents,o=!1,s=!1,c=0,l=0;l<i.length;l++)(t=i[l]).content_id>c&&(c=t.content_id);for(var u=0;u<r.length;u++){for(var d=r[u],h=!0,p=0;p<i.length;p++)if(t=i[p],d.content_id===t.content_id){h=!1,t.tornoff&&(i[p].tornoff=!1,i[p].force_rerender=!0),JSON.stringify(d.content)!==JSON.stringify(t.content)&&(i[p].content=d.content,i[p].force_rerender=!0,a=!0);break}if(h&&parseInt(d.thread_id)===n){if(!d.content)continue;Rr.subscribedThread.contents.push(d),"image"===d.content.type&&(o=!0),"system_text"===d.content.type&&d.content_id>c&&(s=!0),a=!0}}return o&&Rr.getLatestImages(Rr.subscribedThread.metadata.thread.thread_id),s&&Rr.updateMetadata(),Rr.data.temp_content&&Rr.data.temp_content[n]&&(a=!0),a},updateThreadImagesData:function(e){if(void 0===Rr.subscribedThread)return!1;var t=e.next_url;Rr.subscribedThread.images_next_url=t;var n=e.images;if(void 0===Rr.subscribedThread.images)return Rr.subscribedThread.images=n,!0;for(var a=Rr.subscribedThread.images,r=!1,i=0;i<n.length;i++){var o=n[i],s=!0;for(i=0;i<a.length;i++){var c=a[i];if(o.content_id===c.content_id){s=!1;break}}s&&(Rr.subscribedThread.images.push(o),r=!0)}return r},updateMetadata:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==Rr.subscribedThread){e.next=2;break}return e.abrupt("return");case 2:return t=Rr.subscribedThread,n=t.metadata.thread.thread_id,a=t.container,e.next=7,mr(n);case 7:r=e.sent,t.metadata=r,a.find(".thread-name").text(r.thread.name||u.a.t("退会・停止ユーザー")),a.find(".thread-member-num").text(r.thread.member_num);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),updateThreadListData:function(e,t){var n=!!e.body.starred_contents,a=!n,r=n?e.body.starred_contents:e.body.message_threads,i=!1;if(Rr.data.threads_next_url=e.body.next_url,n){var o=!0,s=!1,c=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var d=l.value;d.content_id&&(d.thread_id="c".concat(d.content_id)),d.thread_name||(d.thread_name=d.user_name),d.modified_at||(d.modified_at=d.posted_at),d.unread_num=0}}catch(e){s=!0,c=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw c}}}var p=!0,f=!1,m=void 0;try{for(var v,g=function(){var e=v.value,t=Rr.data.threads.findIndex(function(t){return t.thread_id===e.thread_id});t<0?(Rr.data.threads.push(e),i=!0):JSON.stringify(e)!==JSON.stringify(Rr.data.threads[t])&&(Rr.data.threads[t]=e,i=!0)},b=r[Symbol.iterator]();!(p=(v=b.next()).done);p=!0)g()}catch(e){f=!0,m=e}finally{try{p||null==b.return||b.return()}finally{if(f)throw m}}r.length||Br.renderThreadList(),i?(a&&Rr.data.threads.sort(function(e,t){return t.modified_at-e.modified_at}),Br.renderThreadList(),t&&t.levelup()):(t&&t.run(),Rr.data.threads.length||Br.renderThreadList());var y=h()("#page-messages .messages-container");if(y.length&&y.hasClass("viewing-thread-list")&&null==Rr.subscribedThread){if(!Rr.data.threads.length)return;var k=Rr.data.threads[0].thread_id;Rr.subscribeThread({threadId:k})}}},Fr=function(){function e(t){Object(C.a)(this,e),Object(T.a)(this,"fibo",[1,2,3,5,8,13]),Object(T.a)(this,"level",0),Object(T.a)(this,"t",null),Object(T.a)(this,"ended",!1),this.callback=t}return Object(S.a)(e,[{key:"leveldown",value:function(){this.level<=this.fibo.length-2&&this.level++}},{key:"levelup",value:function(){this.level=1,this.run()}},{key:"run",value:function(){var e=this;this.t&&window.clearTimeout(this.t);var t=2e4;this.level<0?(t=1,this.level=0):this.level>99?(t=6e4,this.level=0):this.leveldown(),this.t=window.setTimeout(function(){e.execute()},t)}},{key:"runnow",value:function(){this.level=-1,this.run()}},{key:"execute",value:function(){this.ended||this.callback.call(void 0,this)}},{key:"start",value:function(){this.ended=!1,this.run()}},{key:"end",value:function(){this.t&&clearTimeout(this.t),this.exe_time=0,this.ended=!0}}]),e}(),Br={renderThreadList:function(){var e=h()(".messages-container .thread-list-tab:checked").val(),t=h()(".thread-list-container"),n=Rr.data.threads;if(t.each(function(t,a){var r,i=h()(a);switch(i.removeClass("loading"),e){case"star":r=h()(a).find(".message-thread-list.star");break;default:r=h()(a).find(".message-thread-list.thread").first()}var o=null;if(Rr.data.threads.length){h()(a).removeClass("empty");for(var s=Array.from(n),c=0;c<s.length;c++){var l=s[c];l.unread_count=l.unread_num>10?"10+":l.unread_num}o=u.a.template("thread-list-items",{threads:n})}else h()(a).addClass("empty");r.data("nextUrl",Rr.data.threads_next_url).html("").append(o),zr(r),r.scrollTop()<r[0].scrollHeight-r.innerHeight()||r.trigger("scroll");try{var d=Rr.subscribedThread.metadata.thread.thread_id;r.find("li.thread").removeClass("active"),r.find("li.thread[data-thread-id=".concat(d,"]")).addClass("active");var p=Rr.subscribedThread.metadata.thread.thread_id_2;p&&r.find("li.thread[data-thread-id=".concat(p,"]")).addClass("active")}catch(e){}if(i.hasClass("jump")){i.removeClass("jump");var f=i.find("ul.message-thread-list > li.thread"),m=Array.from(f).filter(function(e){return h()(e).data("unreadNum")>0});1===m.length&&h()(m[0]).trigger("click")}}),void 0!==Rr.subscribedThread&&"star"!==e&&!Rr.subscribedThread.read_only){for(var a=Rr.subscribedThread.metadata,r=!0,i=Array.from(n),o=0;o<i.length;o++){i[o].thread_id===a.thread.thread_id&&(r=!1)}if(r){var s=Rr.subscribedThread.container.find(".message-thread-list.thread"),c={icon_url:a.thread.icon_url,is_pair:a.thread.is_pair,latest_content:a.thread.latest_content,member_num:a.thread.member_num,modified_at:a.thread.modified_at,thread_id:a.thread.thread_id,thread_name:a.thread.name,unread_num:a.thread.unread_num,is_active_thread:a.thread.is_active_thread},l=h()(h.a.parseHTML(u.a.template("thread-list-items",{threads:[c]})));l.addClass("permalink active"),s.prepend(l),zr(s)}}},renderThreadContent:function(){var e,t,n;if(Rr.subscribedThread){var a,r=Rr.subscribedThread,i=Rr.updateUser(r.metadata.users),o=Rr.subscribedThread,s=o.metadata.thread.thread_id,c=o.metadata.thread.name,l=o.metadata.thread.member_num,d=o.metadata.thread.is_pair,p=o.read_only,f=o.container,m=o.contents;f.find("li.thread").removeClass("active"),f.find("li.thread[data-thread-id=".concat(s,"]")).addClass("active"),f.find(".header ._official-badge").toggleClass("_hidden",!o.metadata.thread.is_official),f.find(".header ._fanbox-subscribing-badge").toggleClass("_hidden",!o.metadata.thread.is_fanbox_subscriber);for(var v=Array.from(m),g=0;g<v.length;g++){var b=(a=v[g]).content;if(a.user.user_id===Va.user.id&&(a.self=!0),a.content&&(a.system="system_text"===a.content.type,a.banned=/^banned_.+$/.test(a.content.type),"join_request"===a.content.type&&(a.join_request=!0,a.thread_name=c),"mypixiv_request"===a.content.type&&(a.mypixiv_request=!0),"image"===b.type)){var y=void 0,k=400;f.find(".message-content-list").width()<k&&(k=200),y=+b.width>k||+b.height>k?Lr.c(+b.width,+b.height,k):[b.width,b.height],a.format={width_400:y[0],height_400:y[1]}}}var w=f.find("ul.message-content-list");w.data("threadId")!==s&&(t=!0,w.html("").removeClass("no-history").scrollTop(0)),w.data("threadId",s),o.no_history&&w.addClass("no-history");for(var _=w.scrollTop(),x=w[0].scrollHeight,j=w.innerHeight(),O=t||j+_>=x,C=Array.from(m),S=0;S<C.length;S++){a=C[S];var T=".message-content-".concat(a.content_id),I=w.find(T);if(I.length){if(I.removeClass("torn-off"),!a.force_rerender)continue;I.remove(),delete a.force_rerender}if(!a.user_blocked){e=h()(u.a.template("thread-content",{content:a}));var M=w.find("li.message-content");n=!1;for(var E=Array.from(M),N=0;N<E.length;N++){var D=E[N],P=h()(D).data("contentId");if(a.content_id<P){e.insertBefore(D),n=!0;break}}n||w.append(e)}}var L=p||r.metadata.thread.is_mendako||r.is_pair&&!(i[r.pair_user_id]&&i[r.pair_user_id].is_complete_user),U=!L;if(h()(".thread-content-container").toggleClass("readonly-thread",L),Rr.data.temp_content&&Rr.data.temp_content[s]&&(Rr.data.temp_content[s].content.name=c,e=h()(u.a.template("thread-content",{content:Rr.data.temp_content[s]})),delete Rr.data.temp_content[s],w.append(e)),w.find(".temp.success").remove(),c?f.find(".thread-content-container .thread-name").text(c).data("threadId",s):f.find(".thread-content-container .thread-name").text(u.a.t("退会・停止ユーザー")),d?(f.find(".thread-content-container").addClass("is-pair"),f.find(".action-report-user a").attr("href","/user_infomsg.php?id=".concat(o.metadata.thread.pair_user_id,"#report")),f.find(".action-block-user a").attr("href","/user_infomsg.php?id=".concat(o.metadata.thread.pair_user_id,"#block"))):(f.find(".thread-content-container").removeClass("is-pair"),f.find(".thread-content-container .thread-member-num").text(l)),f.find(".error-displayed").removeClass("has-error"),f.find(".thread-container .button-messages-actions").toggleClass("inactive",!U),f.find(".thread-content-container").removeClass("inactive").find(".actions").data("threadId",s),f.find(".thread-content-container .submit-message-short textarea").data("receiverId","").data("receiverIds","").data("threadId",s),f.find(".thread-content-container .attach-content input[name=thread_id]").val(s),f.find(".thread-content-container .attach-content input[name=upfile]").val(""),f.removeClass("viewing-thread-list").addClass("viewing-thread-content"),f.find(".thread-content-container").removeClass("loading"),Br.renderThreadContentTime(w),w[0].scrollHeight===w.innerHeight()&&w.trigger("scroll"),O)w.find("> li").last().each(function(e,t){t.scrollIntoView()});else n&&w.scrollTop(w[0].scrollHeight-x)}},renderThreadContentTime:function(e){var t=new Date(0),n=new Date;h()(".time",e).each(function(e,a){var r=h()(a),i=+r.dataset("time"),o=new Date(1e3*i);o.getTime()-t.getTime()<3e5?r.addClass("_hidden"):(o.toDateString()===t.toDateString()?r.text(Ur(n,o)):r.text(Ur(t,o)),r.attr("title",o.toString()),t=o)})},showThreadFile:function(){if(void 0!==Rr.subscribedThread){var e=Rr.subscribedThread,t=e.images,n=e.metadata.thread.thread_id,a=e.images_next_url,r=e.container;r=h()("#page-messages");for(var i=Array.from(h()("ul.message-image-list",r)),o=0;o<i.length;o++){var s=i[o],c=h()(s);if(c.data("threadId")!==n&&c.scrollTop(0).html("").removeClass("busy"),c.data("threadId",n),c.data("nextUrl",a),!t)break;for(var l=Array.from(t),d=0;d<l.length;d++){var p=l[d],f=".item-".concat(p.content_id);if(!c.find(f).length){for(var m=h()(u.a.template("message-attachment-list-items",{items:p,large:!0})),v=c.find("li.item"),g=!1,b=Array.from(v),y=0;y<b.length;y++){var k=b[y],w=h()(k).data("contentId");if(p.content_id>w){h()(m).insertBefore(k),g=!0;break}}g||c.append(m)}}c.scrollTop()<c[0].scrollHeight-c.innerHeight()||c.trigger("scroll")}}},renderThreadImages:function(){var e;if(e=null!=Rr.subscribedThread?Rr.subscribedThread.images:void 0){var t=h()("._message-attachments-container"),n=h()(".items",t),a=h()(".wrapper",t),r=e.length,i=r>6;a.toggleClass("empty",!r),h()(".more",t).toggleClass("_hidden",!i),r?n.html(u.a.template("message-attachment-list-items",{items:e.slice(0,i?5:6)})):n.empty()}}},$r=n(286),Wr=n.n($r),Hr=n(161),qr=Kn.a.template({1:function(e,t,n,a,r){var i,o=e.lambda,s=e.escapeExpression,c=null!=t?t:e.nullContext||{};return'<li data-user_id="'+s(o(t,t))+'" data-filter="following-booster-loading" class="ui-scroll-view following-booster-'+s(o(t,t))+" following-booster-dummy"+(null!=(i=n.if.call(c,(i=r&&r.root)&&i.user_name,{name:"if",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?i:"")+'" '+(null!=(i=n.if.call(c,(i=r&&r.root)&&i.user_name,{name:"if",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?i:"")+"></li>"},2:function(e,t,n,a,r){return" following-booster-related-user"},4:function(e,t,n,a,r){var i;return'data-related_user="'+e.escapeExpression(e.lambda((i=r&&r.root)&&i.user_name,t))+'"'},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i;return null!=(i=n.each.call(null!=t?t:e.nullContext||{},null!=t?t.user_ids:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?i:""},useData:!0}),Gr=Kn.a.template({1:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l=n.helperMissing,u="function",d=e.escapeExpression,h=n.blockHelperMissing,p='<li class="user-recommendation-item'+(null!=(i=n.if.call(c,(i=r&&r.root)&&i.relatedUser,{name:"if",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?i:"")+'" data-id="'+d(typeof(o=null!=(o=n.user_id||(null!=t?t.user_id:t))?o:l)===u?o.call(c,{name:"user_id",hash:{},data:r}):o)+'">'+(null!=(i=n.if.call(c,(i=r&&r.root)&&i.relatedUser,{name:"if",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?i:"")+'<a href="/member.php?id='+d((n.url_encode||t&&t.url_encode||l).call(c,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'" class="_user-icon size-128 cover-texture ui-scroll-view" target="_blank" title="'+d(typeof(o=null!=(o=n.user_name||(null!=t?t.user_name:t))?o:l)===u?o.call(c,{name:"user_name",hash:{},data:r}):o)+'" data-filter="lazy-image" data-src="'+d(typeof(o=null!=(o=n.profile_img||(null!=t?t.profile_img:t))?o:l)===u?o.call(c,{name:"profile_img",hash:{},data:r}):o)+'" ></a><h1><a href="/member.php?id='+d((n.url_encode||t&&t.url_encode||l).call(c,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'" target="_blank" class="title">'+d(typeof(o=null!=(o=n.user_name||(null!=t?t.user_name:t))?o:l)===u?o.call(c,{name:"user_name",hash:{},data:r}):o)+'</a></h1><dl class="meta inline-list"><dt>'+d((n.t||t&&t.t||l).call(c,"イラスト投稿数",{name:"t",hash:{},data:r}))+'</dt><dd><a href="/member_illust.php?id='+d((n.url_encode||t&&t.url_encode||l).call(c,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+(null!=(i=n.if.call(c,(i=r&&r.root)&&i.word,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?i:"")+'" target="_blank">'+d(typeof(o=null!=(o=n.illust_count||(null!=t?t.illust_count:t))?o:l)===u?o.call(c,{name:"illust_count",hash:{},data:r}):o)+'</a></dd></dl><p class="caption">'+d((n.truncate||t&&t.truncate||l).call(c,null!=t?t.user_comment:t,36,{name:"truncate",hash:{},data:r}))+'</p><div class="_follow-button-container';return o=null!=(o=n.is_follow||(null!=t?t.is_follow:t))?o:l,s={name:"is_follow",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r},i=typeof o===u?o.call(c,s):o,n.is_follow||(i=h.call(t,i,s)),null!=i&&(p+=i),p+='"><button class="follow-button">',o=null!=(o=n.is_follow||(null!=t?t.is_follow:t))?o:l,s={name:"is_follow",hash:{},fn:e.program(10,r,0),inverse:e.noop,data:r},i=typeof o===u?o.call(c,s):o,n.is_follow||(i=h.call(t,i,s)),null!=i&&(p+=i),o=null!=(o=n.is_follow||(null!=t?t.is_follow:t))?o:l,s={name:"is_follow",hash:{},fn:e.noop,inverse:e.program(12,r,0),data:r},i=typeof o===u?o.call(c,s):o,n.is_follow||(i=h.call(t,i,s)),null!=i&&(p+=i),p+"</button></div>"+(null!=(i=n.if.call(c,null!=t?t.illusts:t,{name:"if",hash:{},fn:e.program(14,r,0),inverse:e.noop,data:r}))?i:"")+"</li>"},2:function(e,t,n,a,r){return" child"},4:function(e,t,n,a,r){var i;return'<div class="related-user">'+e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"$1さんの関連ユーザー",(i=r&&r.root)&&i.relatedUser,{name:"t",hash:{},data:r}))+"</div>"},6:function(e,t,n,a,r){var i;return"&amp;tag="+e.escapeExpression((n.url_encode||t&&t.url_encode||n.helperMissing).call(null!=t?t:e.nullContext||{},(i=r&&r.root)&&i.word,{name:"url_encode",hash:{},data:r}))},8:function(e,t,n,a,r){return" following2"},10:function(e,t,n,a,r){return e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"フォロー中",{name:"t",hash:{},data:r}))},12:function(e,t,n,a,r){return e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"フォローする",{name:"t",hash:{},data:r}))},14:function(e,t,n,a,r){var i,o,s,c='<ul class="images">';return o=null!=(o=n.illusts||(null!=t?t.illusts:t))?o:n.helperMissing,s={name:"illusts",hash:{},fn:e.program(15,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.illusts||(i=n.blockHelperMissing.call(t,i,s)),null!=i&&(c+=i),c+"</ul>"},15:function(e,t,n,a,r){var i,o=e.lambda,s=e.escapeExpression,c=null!=t?t:e.nullContext||{},l=n.helperMissing;return'<li class="action-open-thumbnail" data-src="'+s(o(null!=(i=null!=t?t.url:t)?i["480mw"]:i,t))+'"><a href="/member_illust.php?mode=medium&amp;illust_id='+s((n.url_encode||t&&t.url_encode||l).call(c,null!=t?t.illust_id:t,{name:"url_encode",hash:{},data:r}))+"&amp;uarea=user_recommend"+(null!=(i=n.if.call(c,(i=r&&r.root)&&i.word,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?i:"")+'" target="_blank" class="ui-scroll-view '+s((n.get_thumbnail_classes||t&&t.get_thumbnail_classes||l).call(c,null!=t?t.illust_id:t,null!=t?t.illust_type:t,null!=t?t.illust_page_count:t,null!=t?t.illust_book_style:t,{name:"get_thumbnail_classes",hash:{},data:r}))+'" data-src="'+s(o(null!=(i=null!=t?t.url:t)?i["128x128"]:i,t))+'" data-filter="lazy-image"><span class="layout-effect"></span>'+(null!=(i=(n.is||t&&t.is||l).call(c,null!=t?t.illust_page_count:t,">",1,{name:"is",hash:{},fn:e.program(16,r,0),inverse:e.noop,data:r}))?i:"")+"</a></li>"},16:function(e,t,n,a,r){var i;return'<div class="page-count"><div class="icon"></div><span>'+e.escapeExpression("function"==typeof(i=null!=(i=n.illust_page_count||(null!=t?t.illust_page_count:t))?i:n.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"illust_page_count",hash:{},data:r}):i)+"</span></div>"},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s;return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i?i:""},useData:!0}),Kr=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(C.a)(this,e),Object(T.a)(this,"offset",0),Object(T.a)(this,"sampleUser",null),Object(T.a)(this,"followingBoosterModel",1),this.container=h()(t),this.listContainer=h()(".user-recommendation-items",this.container),this.thumbnailContainer=h()("._thumbnail-popup"),this.indicator=new b.a(this.container),this.autoView=new v.a(".more",a.modal?{scrollContext:this.container}:void 0),this.debounceObject=u.a.debounce(this.openThumbnail,this,200),this.sampleUser=a.sampleUser||Va.context.userRecommendSampleUser,this.followingBoosterModel=a.followingBoosterModel||1,this.container.on("mouseenter",".action-open-thumbnail",this.debounceObject),this.container.on("mouseleave",".action-open-thumbnail",function(e){n.closeThumbnail(e)}),this.show()}return Object(S.a)(e,[{key:"request",value:function(e,t,n){var a=this;return p.r(e,t,n).done(function(e,t){if(null!=e&&null!=e.user_ids&&e.user_ids.length>0){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return h.a.Deferred().resolveWith(a,[e,t].concat(r))}return h.a.Deferred().rejectWith(a,[e,t,null!=e?e.error:void 0])})}},{key:"show",value:function(){var e=this;return this.request(this.sampleUser,100,this.followingBoosterModel).always(function(){e.indicator.finish()}).done(function(t){e.data=t,h()(qr({user_ids:e.data.user_ids})).appendTo(".user-recommendation-items"),Ra.a.registerFilter("following-booster-loading",function(e){var t=e.dataset().user_id;Vr.replace(t,{user_ids:t,illust_num:4,get_illust_count:1},{})}),Ra.a.update()}).fail(function(t,n,a){var r=h()("._no-item",e.container);r.removeClass("hidden"),a&&r.text(a)})}},{key:"openThumbnail",value:function(e){var t=this,n=h()(e.currentTarget),a=n.data();n.data("canceled",!1);var r=new Image;r.onload=function(){if(!n.data("canceled")){var e=Math.min(r.height,480),i=Math.floor(r.width*e/r.height);t.thumbnailContainer.removeClass("_hidden").find(".wrapper").css({width:i,height:e,backgroundImage:Object(K.b)(a.src),backgroundSize:"".concat(i,"px ").concat(e,"px")}),u.a.ui.popupPosition(t.thumbnailContainer,n,{nipple:h()(".nipple",t.thumbnailContainer)})}},r.src=a.src}},{key:"closeThumbnail",value:function(e){this.debounceObject.cancel(),h()(e.currentTarget).data("canceled",!0),this.thumbnailContainer.addClass("_hidden")}}]),e}(),Vr={request:function(e,t,n){var a=this;return p.r(e,t,n).done(function(e,t){if(null!=e&&null!=e.user_ids&&e.user_ids.length>0){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return h.a.Deferred().resolveWith(a,[e,t].concat(r))}return h.a.Deferred().rejectWith(a,[e,t,null!=e?e.error:void 0])})},replace:function(e,t,n){var a=this;return p.q(t,n).done(function(t,n,r,i){var o=h()(".following-booster-".concat(e));h()(Gr({premium:!!Va.user.premium,items:t.body,relatedUser:o.dataset("related_user")})).insertAfter(o).each(function(e,n){var r=h()("._follow-button-container",n).on("follow",function(){a.showRelated(n)});new pn.a(r,Object(ye.a)({premium:!!Va.user.premium},t.body[e]))}),o.remove(),Ra.a.update()})},showRelated:function(e){var t=h()(e);return this.request(t.dataset("id")).done(function(e){t.after(h()(qr({user_ids:e.user_ids,user_name:h()(".title",t).text()}))),Ra.a.registerFilter("following-booster-loading",function(e){var t=e.dataset().user_id;Vr.replace(t,{user_ids:t,illust_num:4,get_illust_count:1},{})}),Ra.a.update()})}};h()(function(){u.a.dispatcher.connect("/",function(){Va.user.id&&(ti.setup(),ei.setup(),h()(".js-toggle-favorite-tag-edit").on("click",function(e){e.preventDefault(),Xr()}),Jr.setup(),Qr(),Zr.open(),ni())}).connect("/novel/",function(){Va.user.id&&(h()(".js-toggle-favorite-tag-edit").on("click",function(e){e.preventDefault(),Xr()}),ni())}).dispatch()});var Yr=function(){var e=h()("._tutorial-modal");0!==e.length&&(u.a.ui.modal.push(e,{block:!0,disposable:!0}),e.on("click",function(e){e.currentTarget===e.target&&h()(".slider-arrow:last",e.currentTarget).trigger("click")}),h()(".ui-tab-container",e).on("uiTabUpdate",function(t,n,a){var r=h()(".slider-arrow",e),i=r.first(),o=h()(".slider-arrow-right",r.last()),s=h()(".slider-btn-right",e);i.toggleClass("_hidden",n.is(":first-child")),o.toggleClass("_hidden",n.is(":last-child")),s.toggleClass("_hidden",!n.is(":last-child")),n.length||u.a.ui.modal.close()}))},Zr={open:function(){if(!(h()("._tutorial-modal").length>0)){var e=h()("._premium-promotion-modal");0!==e.length&&(u.a.ui.modal.push(e,{block:!0,disposable:!0}),u.a.ga.trackEvent(["premium_popup","index"]),e.on("click",function(e){e.currentTarget===e.target&&h()(".slider-arrow:last",e.currentTarget).trigger("click")}),h()(".ui-tab-container",e).on("uiTabUpdate",function(t,n,a){var r=h()(".slider-arrow",e),i=r.first(),o=h()(".slider-arrow-right",r.last());i.toggleClass("_hidden",n.is(":first-child")),o.toggleClass("_hidden",n.is(":last-child")),0===n.length&&u.a.ui.modal.close()}))}}},Jr={setup:function(){u.a.storage.cookie("show_welcome_modal")&&this.openTutorial(),u.a.storage.localStorage("hideUserRecommendIntroduction")||(h()(".user-recommend-introduction").removeClass("hidden"),u.a.d.on("click",".action-open-user-recommendation",this.open.bind(this)).on("click",".action-close-recommend-introduction",this.hide.bind(this)))},openTutorial:function(){u.a.storage.cookie("show_welcome_modal",null)},open:function(){var e=h()(".user-recommendation-modal");e.is(":visible")||(new Kr(e,{modal:!0,sampleUser:Va.context.userRecommendSampleUser,followingBoosterModel:1}),u.a.ui.modal.push(e,{block:!0}),e.on("uimodalclose",function(){Yr()}))},hide:function(){h()(".user-recommend-introduction").slideUp(),u.a.storage.localStorage("hideUserRecommendIntroduction",!0)}},Qr=function(){if(!1===Va.context.hasUserRecommendationCache){var e=h()("#user-recommend-container, #user-recommend-module");0!==e.length&&Hr.user(Va.context.userRecommendSampleUser).done(function(t){if(null!=t){var n=t.recommend_users;0!==n.length&&e.removeClass("_hidden").find(".user-list").append(u.a.template("user-recommend-list",{items:n}))}})}},Xr=function(){var e=h()("#edit-favorite-tag");return e.dataset("initialized")||new sn.c(h()("input.ui-tag",e)).make(),e.dataset("initialized",!0).slideToggle("fast")},ei={cookieName:"mypage_has_closed_sensei_caption",setup:function(){var e=this;this.container=h()("#item-container"),this.senseiCaption=h()(".sensei-caption"),0!==this.senseiCaption.length&&this.container.on("click",".sensei-caption-close-icon",function(t){e.senseiCaption.hide(),u.a.storage.cookie(e.cookieName,1,{expires:31536e6}),t.preventDefault(),t.stopPropagation()})}},ti={cookieName:"module_orders_mypage",setup:function(){var e=this;this.container=h()("#item-container"),this.parse()&&this.container.on("click",".action",function(t){var n=h()(t.currentTarget);e[n.dataset("action")](n.closest(".item").dataset("name")),t.preventDefault(),t.stopPropagation()})},parse:function(){return this.config=u.a.storage.config(null,{expires:31536e6},{update:!1}),this.data=JSON.parse(this.config(this.cookieName)),this.data},update:function(){this.data,this.config(this.cookieName,JSON.stringify(this.data))},up:function(e){var t=h()("> .item",this.container),n=t.index(t.filter(".".concat(u.a.letterCase(e,"css"))));if(!(n<=0)){for(var a=this.data.findIndex(function(t){return t.name===e}),r=a-1;r>=0;r--)if(this.isAvailableModule(this.data[r].name)){var i=this.data.splice(a,1)[0];this.data.splice(r,0,i);break}-1!==n&&(this.flipPrepare(t),t.eq(n).insertBefore(t.eq(n-1)),this.flipAnimate(t)),this.update()}},down:function(e){var t=h()("> .item",this.container),n=t.index(t.filter(".".concat(u.a.letterCase(e,"css"))));if(!(-1===n||n>=t.length-1)){for(var a=this.data.findIndex(function(t){return t.name===e}),r=a+1;r<t.length;r++)if(this.isAvailableModule(this.data[r].name)){var i=this.data.splice(a,1)[0];this.data.splice(r,0,i);break}n!==t.length-1&&(this.flipPrepare(t),t.eq(n).insertAfter(t.eq(n+1)),this.flipAnimate(t)),this.update()}},isAvailableModule:function(e){var t=h()("> .item",this.container);return t.index(t.filter(".".concat(u.a.letterCase(e,"css"))))>=0},toggle:function(e){var t=this.data.findIndex(function(t){return t.name===e});if(-1!==t){var n=h()("> .item.".concat(u.a.letterCase(e,"css")),this.container);n.toggleClass("closed",!!this.data[t].visible),this.data[t].visible=!this.data[t].visible,this.update(),0===h()("> .content",n).length&&location.reload()}},flipPrepare:function(e){"function"==typeof requestAnimationFrame&&e.each(function(e,t){h()(t).data("flip-offset-top",h()(t).offset().top)})},flipAnimate:function(e){"function"==typeof requestAnimationFrame&&(e.each(function(e,t){var n=h()(t).data("flip-offset-top")-h()(t).offset().top;h()(t).css({transform:"translateY(".concat(n,"px)"),transition:""})}),requestAnimationFrame(function(){e.each(function(e,t){h()(t).css({transform:"",transition:"transform 0.3s"})})}))}};function ni(){var e=Wr()(navigator.userAgent);(function(){if(["tablet","mobile"].includes(e.device.type))return!1;var t=e.browser.name,n=e.browser.major;return"Chrome"===t&&n>=60||"Firefox"===t&&n>=54||"Vivaldi"===t&&n>=1})()&&h()(".js-if-sketch-live-compatible-agent").removeClass("_hidden")}n(411);h()(function(){location.pathname.startsWith("/manage/novels/")&&h()('input[name="del"]').on("click",function(e){var t=h()('input[name="item_id[]"]:checked').parent().find(".title > a").get().map(function(e){return h()(e).text()});if(t.length>0)return confirm("".concat(this.dataset.textConfirm,"\n").concat(t.join("\n")));alert(this.dataset.textAlert),e.preventDefault(),e.stopPropagation()})});var ai=function(e,t){return Ct.c("GET","https://www.melonbooks.com/api/pixiv/get_promotion_ads.php",{pixiv_user_id:e,adult:t})},ri=function(e,t){return Ct.c("GET","https://api.booth.pm/pixiv/shops/show.json",{pixiv_user_id:e,adult:t})},ii=function(e){return Ct.c("GET","".concat(Va.config.sketchUrlBase,"/api/pixiv/user/posts/latest"),{user_id:e},{ajaxSettings:{headers:{Accpet:"application/vnd.sketch-v1+json"}}})},oi=Kn.a.template({1:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression;return'<div class="item book _ui-tooltip" data-tooltip="'+l("function"==typeof(o=null!=(o=n.title||(null!=t?t.title:t))?o:c)?o.call(s,{name:"title",hash:{},data:r}):o)+'"><a href="https://novel.pixiv.net/works/'+l("function"==typeof(o=null!=(o=n.workId||(null!=t?t.workId:t))?o:c)?o.call(s,{name:"workId",hash:{},data:r}):o)+"?ads="+l("function"==typeof(o=null!=(o=n.mpr||(null!=t?t.mpr:t))?o:c)?o.call(s,{name:"mpr",hash:{},data:r}):o)+'" target="_blank">'+(null!=(i=n.if.call(s,null!=t?t.lazy:t,{name:"if",hash:{},fn:e.program(2,r,0),inverse:e.program(4,r,0),data:r}))?i:"")+'<div class="try-read">読んでみる</div></a></div>'},2:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<img src="'+c((n.prop||t&&t.prop||s).call(o,"sourcePath",{name:"prop",hash:{},data:r}))+'images/common/transparent.gif" data-src="'+c("function"==typeof(i=null!=(i=n.imageURL||(null!=t?t.imageURL:t))?i:s)?i.call(o,{name:"imageURL",hash:{},data:r}):i)+'" width="140" height="190" alt="'+c("function"==typeof(i=null!=(i=n.title||(null!=t?t.title:t))?i:s)?i.call(o,{name:"title",hash:{},data:r}):i)+'">'},4:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<img src="'+c("function"==typeof(i=null!=(i=n.imageURL||(null!=t?t.imageURL:t))?i:s)?i.call(o,{name:"imageURL",hash:{},data:r}):i)+'" width="140" height="190" alt="'+c("function"==typeof(i=null!=(i=n.title||(null!=t?t.title:t))?i:s)?i.call(o,{name:"title",hash:{},data:r}):i)+'">'},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c='<div class="items books">';return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i&&(c+=i),c+'</div><ul class="pager"></ul>'},useData:!0}),si=Kn.a.template({1:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression;return'<div class="item book _ui-tooltip" data-tooltip="'+l("function"==typeof(o=null!=(o=n.title||(null!=t?t.title:t))?o:c)?o.call(s,{name:"title",hash:{},data:r}):o)+'">'+(null!=(i=n.if.call(s,null!=t?t.newFlag:t,{name:"if",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?i:"")+'<div class="thick"><a href="https://comic.pixiv.net/magazines/'+l("function"==typeof(o=null!=(o=n.magazineId||(null!=t?t.magazineId:t))?o:c)?o.call(s,{name:"magazineId",hash:{},data:r}):o)+'?ads=mpr" target="_blank">'+(null!=(i=n.if.call(s,null!=t?t.lazy:t,{name:"if",hash:{},fn:e.program(4,r,0),inverse:e.program(6,r,0),data:r}))?i:"")+"</a></div></div>"},2:function(e,t,n,a,r){return'<ul class="badge"><li class="new">NEW</li></ul>'},4:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<img src="'+c((n.prop||t&&t.prop||s).call(o,"sourcePath",{name:"prop",hash:{},data:r}))+'images/common/transparent.gif" data-src="'+c("function"==typeof(i=null!=(i=n.imageURL||(null!=t?t.imageURL:t))?i:s)?i.call(o,{name:"imageURL",hash:{},data:r}):i)+'" width="60" height="87" alt="'+c("function"==typeof(i=null!=(i=n.title||(null!=t?t.title:t))?i:s)?i.call(o,{name:"title",hash:{},data:r}):i)+'">'},6:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<img src="'+c("function"==typeof(i=null!=(i=n.imageURL||(null!=t?t.imageURL:t))?i:s)?i.call(o,{name:"imageURL",hash:{},data:r}):i)+'" width="60" height="87" alt="'+c("function"==typeof(i=null!=(i=n.title||(null!=t?t.title:t))?i:s)?i.call(o,{name:"title",hash:{},data:r}):i)+'">'},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c='<div class="items books">';return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i&&(c+=i),c+'</div><ul class="pager"></ul><div class="pager-prev"></div><div class="pager-next"></div>'},useData:!0}),ci=Kn.a.template({1:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<div class="item contest"><a href="'+c("function"==typeof(i=null!=(i=n.linkURL||(null!=t?t.linkURL:t))?i:s)?i.call(o,{name:"linkURL",hash:{},data:r}):i)+'" target="_blank"><img src="'+c("function"==typeof(i=null!=(i=n.imageURL||(null!=t?t.imageURL:t))?i:s)?i.call(o,{name:"imageURL",hash:{},data:r}):i)+'" width="548" height="178"></a></div>'},3:function(e,t,n,a,r){return""},5:function(e,t,n,a,r){return'<ul class="pager"></ul><div class="pager-prev"></div><div class="pager-next"></div>'},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l='<div class="items contests">';return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i&&(l+=i),l+"</div>"+(null!=(i=n.if.call(c,null!=t?t.items:t,{name:"if",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?i:"")+(null!=(i=n.if.call(c,null!=(i=null!=t?t.items:t)?i[1]:i,{name:"if",hash:{},fn:e.program(5,r,0),inverse:e.noop,data:r}))?i:"")},useData:!0}),li=Kn.a.template({1:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<div class="item contest"><a href="'+c("function"==typeof(i=null!=(i=n.linkURL||(null!=t?t.linkURL:t))?i:s)?i.call(o,{name:"linkURL",hash:{},data:r}):i)+'" target="_blank" rel="noopener" class="js-click-trackable" data-click-category="official-contest" data-click-action="click-portal-big-banner" data-click-label="'+c("function"==typeof(i=null!=(i=n.linkURL||(null!=t?t.linkURL:t))?i:s)?i.call(o,{name:"linkURL",hash:{},data:r}):i)+'" ><img src="'+c("function"==typeof(i=null!=(i=n.imageURL||(null!=t?t.imageURL:t))?i:s)?i.call(o,{name:"imageURL",hash:{},data:r}):i)+'" width="968" height="314"></a></div>'},3:function(e,t,n,a,r){return""},5:function(e,t,n,a,r){return'<ul class="pager"></ul><div class="pager-prev"></div><div class="pager-next"></div>'},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l='<div class="items contests">';return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i&&(l+=i),l+"</div>"+(null!=(i=n.if.call(c,null!=t?t.items:t,{name:"if",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?i:"")+(null!=(i=n.if.call(c,null!=(i=null!=t?t.items:t)?i[1]:i,{name:"if",hash:{},fn:e.program(5,r,0),inverse:e.noop,data:r}))?i:"")},useData:!0}),ui=Kn.a.template({1:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<div class="_melonbooks-dl-item"><a href="'+c("function"==typeof(i=null!=(i=n.url||(null!=t?t.url:t))?i:s)?i.call(o,{name:"url",hash:{},data:r}):i)+'" target="_blank"><h1 class="title">'+c("function"==typeof(i=null!=(i=n.name||(null!=t?t.name:t))?i:s)?i.call(o,{name:"name",hash:{},data:r}):i)+'</h1><img src="'+c("function"==typeof(i=null!=(i=n.image||(null!=t?t.image:t))?i:s)?i.call(o,{name:"image",hash:{},data:r}):i)+'" width="100" height="100" alt=""><p class="description">'+c("function"==typeof(i=null!=(i=n.description||(null!=t?t.description:t))?i:s)?i.call(o,{name:"description",hash:{},data:r}):i)+"</p></a></div>"},3:function(e,t,n,a,r){return'<p class="_no-item">'+e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"商品はまだありません",{name:"t",hash:{},data:r}))+"</p>"},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l=n.helperMissing,u=e.escapeExpression,d=n.blockHelperMissing,h='<aside class="_unit"><h1 class="unit-title"><a href="'+u("function"==typeof(o=null!=(o=n.url||(null!=t?t.url:t))?o:l)?o.call(c,{name:"url",hash:{},data:r}):o)+'" target="_blank">'+u((n.t||t&&t.t||l).call(c,"メロンブックスDL",{name:"t",hash:{},data:r}))+"</a></h1>";return o=null!=(o=n.items||(null!=t?t.items:t))?o:l,s={name:"items",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.items||(i=d.call(t,i,s)),null!=i&&(h+=i),o=null!=(o=n.items||(null!=t?t.items:t))?o:l,s={name:"items",hash:{},fn:e.noop,inverse:e.program(3,r,0),data:r},i="function"==typeof o?o.call(c,s):o,n.items||(i=d.call(t,i,s)),null!=i&&(h+=i),h+"</aside>"},useData:!0}),di=Kn.a.template({1:function(e,t,n,a,r){var i;return null!=(i=n.if.call(null!=t?t:e.nullContext||{},null!=t?t.posts:t,{name:"if",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?i:""},2:function(e,t,n,a,r){var i,o,s,c=e.lambda,l=e.escapeExpression,u=null!=t?t:e.nullContext||{},d=n.helperMissing,h='<div class="works-illust"><p class="worksListOthersTitle"><a href="'+l(c(null!=(i=null!=t?t.user:t)?i.url:i,t))+'?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile" class="active_gray" target="_blank">'+l((n.t||t&&t.t||d).call(u,"pixiv Sketchで投稿した作品",{name:"t",hash:{},data:r}))+'</a>&nbsp;<a href="http://sketch.pixiv.net/?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile" target="_blank" class="_icon sprites-help _ui-tooltip pixiv_sketch_tooltip" data-tooltip="'+l((n.t||t&&t.t||d).call(u,"pixiv Sketchでは落書きや描き途中の絵などを気軽に共有できます！",{name:"t",hash:{},data:r}))+'">?</a>'+(null!=(i=n.if.call(u,(i=r&&r.root)&&i.isMyself,{name:"if",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?i:"")+'</p><ul class="_image-items no-user">';return o=null!=(o=n.posts||(null!=t?t.posts:t))?o:d,s={name:"posts",hash:{},fn:e.program(5,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(u,s):o,n.posts||(i=n.blockHelperMissing.call(t,i,s)),null!=i&&(h+=i),h+'</ul><div class="_more" style="margin:10px 0;"><a href="'+l(c(null!=(i=null!=t?t.user:t)?i.url:i,t))+'?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile" target="_blank">'+l((n.t||t&&t.t||d).call(u,"pixiv Sketchでもっと見る",{name:"t",hash:{},data:r}))+"</a></div></div>"},3:function(e,t,n,a,r){var i,o=e.escapeExpression;return'<a href="'+o(e.lambda((i=r&&r.root)&&i.sketchUrlBase,t))+'/settings?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile#pixiv-connect" target="_blank" class="pixiv_sketch_setting">'+o((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"表示の設定",{name:"t",hash:{},data:r}))+"</a>"},5:function(e,t,n,a,r){var i,o,s=e.escapeExpression;return'<li class="image-item pixiv-sketch-image-item"><a target="_blank" href="'+s("function"==typeof(o=null!=(o=n.url||(null!=t?t.url:t))?o:n.helperMissing)?o.call(null!=t?t:e.nullContext||{},{name:"url",hash:{},data:r}):o)+'?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile" class="work _work"><div class="_layout-thumbnail"><img src="'+s(e.lambda(null!=(i=null!=(i=null!=(i=null!=t?t.thumbnail:t)?i.photo:i)?i.pxsq180:i)?i.url:i,t))+'" class="_thumbnail _pixiv_sketch_thumbnail" width="150" height="150" /></div></a></li>'},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s;return o=null!=(o=n.data||(null!=t?t.data:t))?o:n.helperMissing,s={name:"data",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.data||(i=n.blockHelperMissing.call(t,i,s)),null!=i?i:""},useData:!0}),hi=Kn.a.template({1:function(e,t,n,a,r){var i,o,s,c='<div class="items">';return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i&&(c+=i),c+"</div>"},2:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression,u=e.lambda;return'<section class="item"><a href="'+l("function"==typeof(o=null!=(o=n.url||(null!=t?t.url:t))?o:c)?o.call(s,{name:"url",hash:{},data:r}):o)+"?utm_source=pixiv&amp;utm_medium=promotion&amp;utm_content="+l(u((i=r&&r.root)&&i.content,t))+"-"+l(u((i=r&&r.root)&&i.utmSuffix,t))+'&amp;utm_campaign=pixiv-promotion" target="_blank" class="image">'+(null!=(i=n.if.call(s,null!=t?t.lazy:t,{name:"if",hash:{},fn:e.program(3,r,0),inverse:e.program(5,r,0),data:r}))?i:"")+'</a><div class="body"><h1 class="title"><a href="'+l("function"==typeof(o=null!=(o=n.url||(null!=t?t.url:t))?o:c)?o.call(s,{name:"url",hash:{},data:r}):o)+"?utm_source=pixiv&amp;utm_medium=promotion&amp;utm_content="+l(u((i=r&&r.root)&&i.content,t))+"-"+l(u((i=r&&r.root)&&i.utmSuffix,t))+'&amp;utm_campaign=pixiv-promotion" target="_blank" class="image">'+l("function"==typeof(o=null!=(o=n.name||(null!=t?t.name:t))?o:c)?o.call(s,{name:"name",hash:{},data:r}):o)+'</a></h1><p class="price">&yen;'+l((n.format||t&&t.format||c).call(s,null!=t?t.price:t,{name:"format",hash:{},data:r}))+"</p><p>"+l((n.truncate||t&&t.truncate||c).call(s,null!=t?t.description:t,50,{name:"truncate",hash:{},data:r}))+"</p></div></section>"},3:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<img src="'+c((n.prop||t&&t.prop||s).call(o,"sourcePath",{name:"prop",hash:{},data:r}))+'images/common/transparent.gif" data-src="'+c("function"==typeof(i=null!=(i=n.image||(null!=t?t.image:t))?i:s)?i.call(o,{name:"image",hash:{},data:r}):i)+'" alt="">'},5:function(e,t,n,a,r){var i;return'<img src="'+e.escapeExpression("function"==typeof(i=null!=(i=n.image||(null!=t?t.image:t))?i:n.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"image",hash:{},data:r}):i)+'" alt="">'},7:function(e,t,n,a,r){return'<p class="_no-item">'+e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"商品はまだありません",{name:"t",hash:{},data:r}))+"</p>"},9:function(e,t,n,a,r){return'<ul class="pager"></ul>'},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression;return'<div class="wrapper"><aside class="item-container"><h1 class="service-title"><a href="'+l("function"==typeof(o=null!=(o=n.url||(null!=t?t.url:t))?o:c)?o.call(s,{name:"url",hash:{},data:r}):o)+"?utm_source=pixiv&amp;utm_medium=promotion&amp;utm_content="+l("function"==typeof(o=null!=(o=n.content||(null!=t?t.content:t))?o:c)?o.call(s,{name:"content",hash:{},data:r}):o)+"-"+l("function"==typeof(o=null!=(o=n.utmSuffix||(null!=t?t.utmSuffix:t))?o:c)?o.call(s,{name:"utmSuffix",hash:{},data:r}):o)+'&amp;utm_campaign=pixiv-promotion" target="_blank"><img src="'+l((n.prop||t&&t.prop||c).call(s,"sourcePath",{name:"prop",hash:{},data:r}))+'images/booth/logo.png?170523" alt="BOOTH" width="75" height="25"></a></h1>'+(null!=(i=n.if.call(s,null!=t?t.items:t,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.program(7,r,0),data:r}))?i:"")+"</aside>"+(null!=(i=n.if.call(s,null!=t?t.items:t,{name:"if",hash:{},fn:e.program(9,r,0),inverse:e.noop,data:r}))?i:"")+"</div>"},useData:!0}),pi={"comic-novel":oi,comic:si,"contest-novel":ci,"contest-portal":li,"melonbooks-dl":ui,sketch:di},fi={melonbooksDL:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=mi.findItem(1))){e.next=17;break}return e.prev=2,e.next=5,ai(t.user_id,t.adult_param);case 5:if((n=e.sent)&&n.body){e.next=8;break}return e.abrupt("return");case 8:n.body.content=Va.context.content,new mi("._melonbooks-dl-promotion-container",n.body,"melonbooks-dl"),e.next=17;break;case 12:if(e.prev=12,e.t0=e.catch(2),!(e.t0 instanceof Vn.a)){e.next=16;break}return e.abrupt("return");case 16:throw e.t0;case 17:case"end":return e.stop()}},e,this,[[2,12]])}));return function(){return e.apply(this,arguments)}}(),booth:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=mi.findItem(2))){e.next=19;break}return e.prev=2,e.next=5,ri(t.user_id,t.adult_param);case 5:if((n=e.sent)&&n.body){e.next=8;break}return e.abrupt("return");case 8:n.body.content=Va.context.content,n.body.utmSuffix=location.pathname.startsWith("/novel/show.php")?"new_items":"all_items",null!=(a=new mi("._booth-promotion-container",n.body)).listItemContainer&&a.listItemContainer.boxHeight(),e.next=19;break;case 14:if(e.prev=14,e.t0=e.catch(2),!(e.t0 instanceof Vn.a)){e.next=18;break}return e.abrupt("return");case 18:throw e.t0;case 19:case"end":return e.stop()}},e,this,[[2,14]])}));return function(){return e.apply(this,arguments)}}(),sketch:function(){var e=Object(l.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=mi.findItem(4)){e.next=3;break}return e.abrupt("return");case 3:if(h()("._sketch-promotion-container").get(0)){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,ii(t.user_id);case 8:n=e.sent,new vi("._sketch-promotion-container",t.user_id,n,"sketch"),e.next=17;break;case 12:if(e.prev=12,e.t0=e.catch(5),!(e.t0 instanceof Vn.a)){e.next=16;break}return e.abrupt("return");case 16:throw e.t0;case 17:case"end":return e.stop()}},e,this,[[5,12]])}));return function(){return e.apply(this,arguments)}}()};h()(function(){u.a.dispatcher.connect(/^(?:\/member(?:_illust)?|\/novel\/show)\.php$/,Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Va.context.promotionItems){e.next=3;break}return e.next=3,Promise.all([fi.booth(),fi.melonbooksDL(),fi.sketch()]);case 3:case"end":return e.stop()}},e,this)})),null,!0).connect(/^(?:\/novel\/(?:index\\.php)?|\/novel\/show\\.php)$/,function(){var e;e=location.pathname.match(/^\/novel\/(?:index\.php)?$/)?"mpr_novel":"/novel/show.php"===location.pathname?"mpr_novel_show":"mpr_novel_unknown";var t={items:(Va.context.novelPromotionItems||[]).map(function(t){return Object(ye.a)({},t,{mpr:e})})};new mi("#pixiv-comic-novel-container",t,"comic-novel");var n={items:(Va.context.contestPortalItems||[]).map(function(t){return Object(ye.a)({},t,{mpr:e})})};new mi("#pickup-contest-container-mini",n,"contest-novel")}).connect("/",function(){if(Va.user.id){var e={items:Va.context.comicPromotionItems||[]};new mi("#comic-container",e,"comic",{view:2})}}).connect("/contest/",function(){var e={items:Va.context.contestPortalItems||[]};new mi("#pickup-contest-container",e,"contest-portal")}).dispatch()});var mi=function(){function e(t,n,a,r){Object(C.a)(this,e),this.data=n,this.options=null==r?{view:1}:r,this.container=h()(t),this.template=a?pi[a]:hi,this.create()}return Object(S.a)(e,null,[{key:"findItem",value:function(e){return Va.context.promotionItems.find(function(t){return t.site_id===e})}}]),Object(S.a)(e,[{key:"create",value:function(){this.data;for(var e=0;e<this.data.items.length;e++){var t=this.data.items[e];e>=this.options.view&&(t.lazy=!0)}this.container.append(this.template(this.data)),this.data.items.length&&(this.listContainer=h()(".items",this.container),this.listItemContainer=h()(".item",this.listContainer),this.pagerContainer=h()(".pager",this.container),this.createPager())}},{key:"createPager",value:function(){var e,t,n=this,a=this.pagerContainer,r=this.options.view;if(!a.length||this.data.items.length<=r)a.remove();else{this.containerWidth=this.container.width(),this.itemWidth=this.listItemContainer.outerWidth(!0),this.offset=(this.containerWidth-this.itemWidth*r)/2,this.listContainer.width(this.itemWidth*this.data.items.length+2*this.offset);for(var i=[],o=1,s=Math.ceil(this.data.items.length/r);o<=s;o++){var c=1===o?' class="current"':"";i.push("<li".concat(c,"><span>").concat(o,"</span></li>"))}a.html(i.join("")).on("click mouseenter","li:not(.current)",function(a){t=h()(a.target),e=+t.text()-1,n.move(t,e)}),this.listItemContainer.on("click",function(t){e=n.listItemContainer.index(t.currentTarget),h()("li",a).eq(e).trigger("click")}),this.container.on("click",".pager-prev",function(){var e=h()(".current",a).prev();(t=e.length?e:a.children().last()).trigger("click")}).on("click",".pager-next",function(){var e=h()(".current",a).next();(t=e.length?e:a.children().first()).trigger("click")})}}},{key:"move",value:function(e,t){var n=this.options.view;e.siblings().removeClass("current").end().addClass("current"),this.listContainer.css("margin-left",t*this.itemWidth*n*-1+this.offset),h()("img",this.listContainer).slice(t*n,t*n+n).each(function(e,t){var n=h()(t),a=n.dataset("src");a&&n.attr({src:a,"data-src":null})})}}]),e}(),vi=function(){function e(t,n,a,r,i){Object(C.a)(this,e),this.user_id=n,this.data=a,this.options=null==i?{view:1}:i,this.container=h()(t),this.template=r?pi[r]:hi,this.create()}return Object(S.a)(e,[{key:"create",value:function(){this.data;for(var e=0;e<this.data.data.length;e++){var t=this.data.data[e];e>=this.options.view&&(t.lazy=!0)}this.data.data&&this.data.data.posts&&(this.data.data.posts=this.data.data.posts.slice(0,3)),this.container.append(this.template({data:this.data.data,isMyself:Va.user&&Va.user.id===this.user_id,sketchUrlBase:Va.config.sketchUrlBase})),this.data.data.length&&(this.listContainer=h()(".items",this.container),this.listItemContainer=h()(".item",this.listContainer))}}]),e}(),gi=function(){function e(){Object(C.a)(this,e),Object(T.a)(this,"dialog",void 0)}return Object(S.a)(e,[{key:"setup",value:function(){var e=h()(".require-mail-authorization");e.find(":input").prop("disabled",!0),e.on("click",this.open.bind(this))}},{key:"open",value:function(){var e=h()("#template-require-mail-authorization-dialog").html(),t=Kn.a.compile(e);this.dialog=h()(t({}));var n=this.dialog.find(".main"),a=u.a.w.scrollTop();return n.css("top",Math.max(a+200,a+h()(window).height()/2-n.outerHeight(!0)/2)),this.dialog.find(".background, .close").on("click",this.close.bind(this)),this.dialog.appendTo("body"),!1}},{key:"close",value:function(){return this.dialog.remove(),this.dialog=void 0,!1}}]),e}();function bi(){new Kr(".user-recommendation-unit")}h()(function(){Va.user.noAuthenticated&&(new gi).setup()}),h()(function(){u.a.dispatcher.connect("/search_user.php",function(){return bi()}).connect("/bookmark_add.php",function(){return bi()}).dispatch()}),Ra.a.registerFilter("share-facebook",function(e){var t=e.dataset();!function(e,t){0!==e.length&&h.a.getJSON("http://graph.facebook.com/?callback=?",{id:t||window.location.href}).done(function(t){e.text(t.share_count||"0")})}(h()(".count",e),t.url),e[0].onclick||e.on("click",function(e){e.preventDefault(),e.stopPropagation(),window.open(u.a.query.build("https://www.facebook.com/sharer.php",{app_id:Va.config.facebookAppId,u:t.url,display:"popup"}),null,"menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width=670,height=390")})}),Ra.a.registerFilter("share-twitter",function(e){var t=e.dataset();!function(e,t){0!==e.length&&h.a.getJSON("https://cdn.api.twitter.com/1/urls/count.json?callback=?",{url:t||window.location.href}).done(function(t){e.text(t.count||"0")})}(h()(".count",e),t.url),e[0].onclick||e.on("click",function(e){e.preventDefault(),e.stopPropagation(),window.open(u.a.query.build("https://twitter.com/share",{url:t.url,text:t.text,hashtags:t.hashtags}),null,"menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width=550,height=470")})});var yi=n(68);!function(){function e(e,t,n){h()(e).addClass("ugoku-illust-started"),new yi.a(h()("._ugoku-illust-player-container:first",e),t,n)}yi.a.supported&&Ra.a.registerFilter("ugoku-illust-autoplay",function(t){var n=t.dataset(),a=null!=Va.context.ugokuIllustDataList?Va.context.ugokuIllustDataList[n.id]:void 0;if(a)a.size=yi.a.size(a.originalSize),e(t,yi.a.data(a,"ugoira600x600"),{autoStart:!0,maxSize:n.maxSize||480,fullscreenData:yi.a.data(a,"ugoira1920x1080")});else{var r=t.dataset("id");p.l(r).done(function(a){var i=a.body[r];i.originalSize=i.original_size,i.size=yi.a.size(i.original_size),e(t,yi.a.data(i,"ugoira600x600"),{autoStart:!0,maxSize:n.maxSize||480,fullscreenData:yi.a.data(i,"ugoira1920x1080")})})}})}(),h()(function(){u.a.dispatcher.connect({pathname:"/member_illust.php",search:/(?:^|\?|&)mode=medium(?:&|$)/},function(){var e=Va.context.ugokuIllustData;if(e){e.size=yi.a.size(Va.context.illustSize);var t={autoStart:!0};if(!Va.user.loggedIn&&Va.context.explicit){t.effect=function(t,n){for(var a=Object(P.a)(this.data.size,2),r=a[0],i=a[1],o=0;o<i;){for(var s=0;s<r;)e=n.getImageData(Math.min(s+15-1,r)-1,Math.min(o+15-1,i)-1,1,1).data,n.fillStyle="rgb(".concat(e[0],",").concat(e[1],",").concat(e[2],")"),n.fillRect(s,o,30,30),s+=30;o+=30}},t.maxSize=580}new yi.a(h()("._ugoku-illust-player-container:first"),e,t)}}).connect({pathname:"/member_illust.php",search:/(?:^|\?|&)mode=ugoira_view(?:&|$)/},function(){var e=Va.context.ugokuIllustData;e&&(e.size=yi.a.size(Va.context.illustSize,1920,1080),new yi.a(h()("._ugoku-illust-player-container"),e,{autoStart:!0,maxWidth:1920,maxHeight:1080}))}).dispatch()}),h()(function(){if(/^\/yabai2016/.test(location.pathname)){var e={el:{},init:function(){h()("#yabai2016").size()>0&&(e.el.win=h()(window),e.el.timeM=h()("#yabai2016_article_main_time_m"),e.el.timeS=h()("#yabai2016_article_main_time_s"),e.el.grid=h()(".grid"),e.el.gridItem=h()(".grid .grid-item"),h()(".share .share_tw").on("click",function(){e.handleWindowOpen("https://twitter.com/share",h()(this).data())}),h()(".share .share_fb").on("click",function(){e.handleWindowOpen("https://www.facebook.com/sharer/sharer.php",h()(this).data())}),h()("#yabai2016.closing").size()>0&&(e.el.win.on("scroll",e.handleClosingScroll),e.handleClosingScroll()),e.el.win.on("resize",e.handleWindowResize),e.el.win.on("scroll resize",e.handleScrollAndResize),e.handleWindowResize(),e.handleScrollAndResize(),e.el.grid.isotope({layoutMode:"packery",itemSelector:".grid-item",isInitLayout:!1,packery:{gutter:5}}),e.el.grid.on("layoutComplete",function(){e.el.grid.addClass("visible"),e.el.win.trigger("resize")}),e.el.grid.isotope("layout"))},handleWindowOpen:function(e,t){window.open([e,h.a.param(t)].join("?"),"","toolbar=0, status=0, width=550, height=420")},handleScrollAndResize:function(){var t=e.el.win.scrollTop()+e.el.win.innerHeight();e.el.gridItem.each(function(e,n){if(t>h()(n).offset().top){var a=h()(n);a.css({backgroundImage:Object(K.b)(a.data("url"))}),setTimeout(function(){a.addClass("visible")},0)}})},handleClosingScroll:function(){var t=e.el.win.scrollTop();e.el.win.scrollTop()<200?(h()("#yabai2016_message").css({top:-1*t}),h()("#yabai2016_header").css({top:200-t})):(h()("#yabai2016_message").css({top:-200}),h()("#yabai2016_header").css({top:0}))},handleWindowResize:function(){var t=Math.floor((window.innerWidth-100-5)/105);e.el.grid.width(105*t-5)}};h()(function(){setTimeout(function(){e.init()},0)})}});var ki,wi=n(206),_i=n(144);Va.hideTopInfo=Object.freeze({hide:ar}),Va.logOutLanguage=Object.freeze({set:function(e){nr(e)}}),Va.searchTutorialModal=Object.freeze({show:rr,hide:ir}),Va.ui=Object.create(null),Va.badge=Object.freeze({update:U}),Va.addURLLink=wi.b,Va.addHashTagLink=wi.a,Va.tracking=Object.freeze({track:g.tracking.track,set URL(e){ki=e},get URL(){return ki}}),Object.assign(Va.ui,{toggleState:g.toggleState}),Va.title=Object.create(null,{original:{set:function(e){b.c.original=e},get:function(){return b.c.original}}}),Object.freeze(Va.title),window.startTagEdit=Ta.r,window.startTagHistory=Ta.s,window.addTag=Ta.a,window.delTag=Ta.c,window.getBackTag=Ta.g,window.history_clear=Ta.h,window.lockTag=Ta.k,window.infoTag=Ta.i,window.endTagEdit=Ta.e,window.openClose=Ta.o,window.delete_img=Ta.d,window.formatStr=Ta.f,window.makePalette=Ta.l,window.paletteToggle=Ta.p,window.markAllRows=Ta.m,window.unmarkAllRows=Ta.t,Object.assign(Va.ui,{scroll:sn.f,modal:Object.freeze({push:sn.e.push.bind(sn.e),open:sn.e.open.bind(sn.e)})}),Va.scrollView=Object.freeze({registerFilter:Ra.a.registerFilter.bind(Ra.a),add:Ra.a.add.bind(Ra.a),remove:Ra.a.remove.bind(Ra.a),watch:Ra.a.watch.bind(Ra.a),unwatch:Ra.a.unwatch.bind(Ra.a)}),Va.toolbar=Object.freeze({add:_i.a,remove:_i.b}),Va.UgokuIllustUploader=Object.freeze({setup:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(73).then(n.bind(null,1098));case 2:t=e.sent,t.UgokuIllustUploader.setup();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}),Va.Validation=Object.freeze({setup:function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(72).then(n.bind(null,1112));case 2:t=e.sent,t.default.setup();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}),Object.freeze(Va.ui),window.checkimg=function(){var e=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(6).then(n.bind(null,1111));case 2:e.sent.checkImg(t);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),window.color_default=Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(5).then(n.bind(null,1110));case 2:e.sent.colorDefault();case 4:case"end":return e.stop()}},e,this)})),n.d(t,"default",function(){return Va}),n.d(t,"hideSearchTutorialModal",function(){return ir}),n.d(t,"mypageTopInfoHide",function(){return ar}),n.d(t,"ready",function(){return Ya}),n.d(t,"secure",function(){return Za}),n.d(t,"setLoggedOutLanguage",function(){return nr}),n.d(t,"showSearchTutorialModal",function(){return rr}),n.d(t,"textReady",function(){return Ka}),n.d(t,"badge",function(){return a}),n.d(t,"deprecated",function(){return g}),n.d(t,"group",function(){return o}),n.d(t,"createPager",function(){return dr}),n.d(t,"message",function(){return Rr}),n.d(t,"Notification",function(){return ue}),n.d(t,"ProfileCard",function(){return pn.b}),n.d(t,"FollowButton",function(){return pn.a}),n.d(t,"Promotion",function(){return mi}),n.d(t,"PromotionSketch",function(){return vi}),n.d(t,"ui",function(){return Ha}),n.d(t,"DrawrPainter",function(){return ca}),n.d(t,"screen",function(){return g.screen}),n.d(t,"tracking",function(){return g.tracking}),n.d(t,"EventTracker",function(){return g.EventTracker}),n.d(t,"Document",function(){return xa})},103:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),function(e){e.All="all",e.R18="r18",e.Safe="safe"}(a||(a={}))},104:function(e,t,n){"use strict";var a=n(3),r=n.n(a),i=n(28),o=n(6),s=n(54),c=n(0),l=n.n(c),u=n(37),d=n.n(u),h=n(10),p=n(15),f=n(39),m=n(7),v=n(8),g=n(14),b=n(12),y=n(13),k=n(4),w=n.n(k),_=n(55),x=(n(412),n(19)),j=n(96),O=n(25);var C,S=Object(_.b)(function(e){return{isSelfPremium:Object(j.b)(e),tags:e.mute.tags,userIds:e.mute.userIds}})(function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(g.a)(this,Object(b.a)(t).apply(this,arguments))).handlePopState=function(){e.props.dispatch(s.i.close())},e}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this;l()(document).on("click.legacyMuteSetting",".mute-setting-opener",function(t){var n=l()(t.currentTarget).dataset();return n.type===s.i.MuteContext.Setting?Object(x.i)(n):e.props.dispatch(s.i.show(n.type,n.id))}).on("popstate.legacyMuteSetting",this.handlePopState),l()("._open-mute-edit-modal-for-classic").on("click.legacyMuteSetting",function(){return e.props.dispatch(s.i.show(s.i.MuteContext.Setting))})}},{key:"componentDidUpdate",value:function(e){this.props.tags===e.tags&&this.props.userIds===e.userIds||O.a.reset(".ui-scroll-view[data-filter*=thumbnail-filter]")}},{key:"componentWillUnmount",value:function(){l()(document).off(".legacyMuteSetting"),l()("._open-mute-edit-modal-for-classic").off(".legacyMuteSetting")}},{key:"render",value:function(){return null}}]),t}(w.a.Component));function T(){if(h.default.user.mutes)return s.g(h.default.user.mutes)}function I(e){return e.subscribe(function(){var t=e.getState();C=t.mute})}function M(){var e=l()(document.createElement("div")).addClass("thumbnail-menu");function t(e){var t=e.children("._balloon-menu-opener"),n=t.find("._balloon-menu-popup > .menu");if(n.length<1){var a=l()(document.createElement("section")).addClass("_balloon-menu-popup").on("click",function(e){e.preventDefault()});n=l()(document.createElement("ul")).addClass("_balloon-menu-closer").addClass("menu").appendTo(a).on("click","a",function(e){e.stopPropagation()}),a.appendTo(t)}return n}l()(document.createElement("div")).addClass("_balloon-menu-opener").append(l()(document.createElement("div")).addClass("opener")).appendTo(e);var n=h.textReady.then(function(){var e=l()(document.createElement("li")).addClass("mute-setting-opener");return l()(document.createElement("span")).addClass("item").text(Object(p.d)("ミュート設定")).appendTo(e),e}),a=h.textReady.then(function(){return l()(document.createElement("a")).addClass("item").attr("target","_blank").text(Object(p.d)("報告"))});return function(s){Array.from(s,function(e){return l()(e)}).forEach(function(){var s=Object(o.a)(r.a.mark(function o(s){var c,u,h,p,f,m,v,g,b,y,k,w,_,x;return r.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("0"!==(c=s.dataset()).userId){r.next=3;break}return r.abrupt("return");case 3:if(u=null,void 0!==c.type&&void 0!==c.id?u=c:(h=s.closest(".image-item, .rank-detail, .ranking-image-item"),p=h.find("a").first().attr("href"),u=E(p)),(f=s.closest("._layout-thumbnail").add(s.closest("._novel-item").find(".novel-right-contents"))).children("div.thumbnail-menu").remove(),m=e.clone(),void 0===u){r.next=30;break}return r.prev=9,r.next=12,Promise.all([n,a]);case 12:v=r.sent,g=Object(i.a)(v,2),b=g[0],y=g[1],(k=b.clone()).dataset("type",u.type),k.dataset("id",u.id),w=t(m),k.appendTo(w),_="illust"===u.type?"/illust_infomsg.php"+d.a.stringify({illust_id:u.id},{addQueryPrefix:!0}):"/support.php?type=15",(x=y.clone()).attr("href",_),x.appendTo(l()(document.createElement("li")).appendTo(w)),m.appendTo(f),r.next=30;break;case 28:r.prev=28,r.t0=r.catch(9);case 30:case"end":return r.stop()}},o,this,[[9,28]])}));return function(e){return s.apply(this,arguments)}}())}}function E(e){var t=d.a.parse(e.split("?")[1]||"",{ignoreQueryPrefix:!0});return null!=t.illust_id&&""!==t.illust_id?{type:f.a.Illust,id:t.illust_id}:null!=t.id&&""!==t.id?{type:f.a.Novel,id:t.id}:void 0}n.d(t,"b",function(){return T}),n.d(t,"d",function(){return C}),n.d(t,"e",function(){return I}),n.d(t,"c",function(){return M}),n.d(t,"a",function(){return S})},106:function(e,t,n){e.exports={section:"_3yqZRM3",titleWrapper:"_2M5rhUR",title:"_2eShnQ5",badge:"_2dprJ0s",auxLabel:"s54w4mF _2eShnQ5",detailsButton:"_1kGHTaX",detailsButtonLink:"_3N32nQa"}},107:function(e,t,n){e.exports={wrapper:"NOIJS8d",body:"_2XpbYyV",aside:"_2jgaAU-",rightAside:"_3dtt832",topAlign:"_1cmyQcb"}},117:function(e,t,n){"use strict";var a=n(3),r=n.n(a),i=n(6),o=n(52),s=n(7),c=n(8),l=n(0),u=n.n(l),d=n(2),h=n(10),p=n(31),f=n(22),m=n.n(f),v=m.a.template({1:function(e,t,n,a,r){return e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"フォロー中",{name:"t",hash:{},data:r}))},3:function(e,t,n,a,r){return e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"フォローする",{name:"t",hash:{},data:r}))},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l=n.helperMissing,u=n.blockHelperMissing,d='<button class="follow-button">';return o=null!=(o=n.is_follow||(null!=t?t.is_follow:t))?o:l,s={name:"is_follow",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.is_follow||(i=u.call(t,i,s)),null!=i&&(d+=i),o=null!=(o=n.is_follow||(null!=t?t.is_follow:t))?o:l,s={name:"is_follow",hash:{},fn:e.noop,inverse:e.program(3,r,0),data:r},i="function"==typeof o?o.call(c,s):o,n.is_follow||(i=u.call(t,i,s)),null!=i&&(d+=i),d+"</button>"},useData:!0}),g=m.a.template({1:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l=n.helperMissing,u=n.blockHelperMissing,d='<a href="/member.php?id='+e.escapeExpression((n.url_encode||t&&t.url_encode||l).call(c,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'" class="_user-icon cover-texture" target="_blank" title="{$comment.user_name|escape}"';return o=null!=(o=n.profile_img||(null!=t?t.profile_img:t))?o:l,s={name:"profile_img",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.profile_img||(i=u.call(t,i,s)),null!=i&&(d+=i),o=null!=(o=n.profile_img||(null!=t?t.profile_img:t))?o:l,s={name:"profile_img",hash:{},fn:e.noop,inverse:e.program(4,r,0),data:r},i="function"==typeof o?o.call(c,s):o,n.profile_img||(i=u.call(t,i,s)),null!=i&&(d+=i),d+"></a>"},2:function(e,t,n,a,r){var i;return"style=\"background-image: url('"+e.escapeExpression("function"==typeof(i=null!=(i=n.profile_img||(null!=t?t.profile_img:t))?i:n.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"profile_img",hash:{},data:r}):i)+"');\""},4:function(e,t,n,a,r){return"style=\"background-image: url('"+e.escapeExpression((n.prop||t&&t.prop||n.helperMissing).call(null!=t?t:e.nullContext||{},"sourcePath",{name:"prop",hash:{},data:r}))+"images/common/transparent.gif');\""},6:function(e,t,n,a,r){var i,o,s;return o=null!=(o=n.user_name||(null!=t?t.user_name:t))?o:n.helperMissing,s={name:"user_name",hash:{},fn:e.program(7,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.user_name||(i=n.blockHelperMissing.call(t,i,s)),null!=i?i:""},7:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<h1><a href="/member.php?id='+c((n.url_encode||t&&t.url_encode||s).call(o,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'" target="_blank" class="user-name">'+c("function"==typeof(i=null!=(i=n.user_name||(null!=t?t.user_name:t))?i:s)?i.call(o,{name:"user_name",hash:{},data:r}):i)+"</a></h1>"},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l=n.helperMissing,u=n.blockHelperMissing,d='<section class="_profile-popup"><div class="wrapper"><div class="items"><div class="_spinner"></div></div><div class="user-info"><div class="user-profile">';return o=null!=(o=n.user_id||(null!=t?t.user_id:t))?o:l,s={name:"user_id",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.user_id||(i=u.call(t,i,s)),null!=i&&(d+=i),d+="</div>",o=null!=(o=n.user_id||(null!=t?t.user_id:t))?o:l,s={name:"user_id",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.user_id||(i=u.call(t,i,s)),null!=i&&(d+=i),d+'</div></div><div class="nipple"></div></section>'},useData:!0}),b=m.a.template({1:function(e,t,n,a,r){return'<div class="no-item">'+e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"作品がありません",{name:"t",hash:{},data:r}))+"</div>"},3:function(e,t,n,a,r){var i,o,s;return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i?i:""},4:function(e,t,n,a,r){var i;return null!=(i=(n.is||t&&t.is||n.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?t.type:t,"==","novel",{name:"is",hash:{},fn:e.program(5,r,0),inverse:e.program(12,r,0),data:r}))?i:""},5:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{};return'<a href="/novel/show.php?id='+e.escapeExpression("function"==typeof(o=null!=(o=n.id||(null!=t?t.id:t))?o:n.helperMissing)?o.call(s,{name:"id",hash:{},data:r}):o)+'&amp;ref=profile_card" target="_blank" class="item novel _layout-thumbnail '+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?i:"")+'">'+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(8,r,0),inverse:e.program(10,r,0),data:r}))?i:"")+"</a>"},6:function(e,t,n,a,r){return"muted"},8:function(e,t,n,a,r){return'<ul class="thumbnail-filter-items muted-thumbnail"><li class="negative">'+e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"ミュート中",{name:"t",hash:{},data:r}))+"</li></ul>"},10:function(e,t,n,a,r){var i,o=null!=t?t:e.nullContext||{},s=n.helperMissing,c=e.escapeExpression;return'<h1 class="title">'+c("function"==typeof(i=null!=(i=n.title||(null!=t?t.title:t))?i:s)?i.call(o,{name:"title",hash:{},data:r}):i)+'</h1><div class="word-count">'+c("function"==typeof(i=null!=(i=n.text_length||(null!=t?t.text_length:t))?i:s)?i.call(o,{name:"text_length",hash:{},data:r}):i)+" "+c((n.t||t&&t.t||s).call(o,"文字",{name:"t",hash:{},data:r}))+"</div>"},12:function(e,t,n,a,r){var i;return null!=(i=(n.is||t&&t.is||n.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?t.illust_x_restrict:t,"==",0,{name:"is",hash:{},fn:e.program(13,r,0),inverse:e.program(15,r,0),data:r}))?i:""},13:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression;return'<a href="/member_illust.php?mode=medium&amp;illust_id='+l("function"==typeof(o=null!=(o=n.illust_id||(null!=t?t.illust_id:t))?o:c)?o.call(s,{name:"illust_id",hash:{},data:r}):o)+'&amp;ref=profile_card" target="_blank" class="item '+l((n.get_thumbnail_classes||t&&t.get_thumbnail_classes||c).call(s,null!=t?t.illust_id:t,null!=t?t.illust_type:t,null!=t?t.illust_page_count:t,null!=t?t.illust_book_style:t,{name:"get_thumbnail_classes",hash:{},data:r}))+" "+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?i:"")+'" style="background-image:url('+l(e.lambda(null!=(i=null!=t?t.url:t)?i["480mw"]:i,t))+')">'+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r}))?i:"")+"</a>"},15:function(e,t,n,a,r){var i;return null!=(i=n.if.call(null!=t?t:e.nullContext||{},(i=r&&r.root)&&i.r18_page,{name:"if",hash:{},fn:e.program(16,r,0),inverse:e.program(18,r,0),data:r}))?i:""},16:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression;return'<a href="/member_illust.php?mode=medium&amp;illust_id='+l("function"==typeof(o=null!=(o=n.illust_id||(null!=t?t.illust_id:t))?o:c)?o.call(s,{name:"illust_id",hash:{},data:r}):o)+'&amp;ref=profile_card" target="_blank" class="item  '+l((n.get_thumbnail_classes||t&&t.get_thumbnail_classes||c).call(s,null!=t?t.illust_id:t,null!=t?t.illust_type:t,null!=t?t.illust_page_count:t,null!=t?t.illust_book_style:t,{name:"get_thumbnail_classes",hash:{},data:r}))+" "+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?i:"")+'" style="background-image:url('+l(e.lambda(null!=(i=null!=t?t.url:t)?i["480mw"]:i,t))+')">'+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r}))?i:"")+"</a>"},18:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression;return'<a href="/member_illust.php?mode=medium&amp;illust_id='+l("function"==typeof(o=null!=(o=n.illust_id||(null!=t?t.illust_id:t))?o:c)?o.call(s,{name:"illust_id",hash:{},data:r}):o)+'&amp;ref=profile_card" target="_blank" class="item explicit  '+l((n.get_thumbnail_classes||t&&t.get_thumbnail_classes||c).call(s,null!=t?t.illust_id:t,null!=t?t.illust_type:t,null!=t?t.illust_page_count:t,null!=t?t.illust_book_style:t,{name:"get_thumbnail_classes",hash:{},data:r}))+" "+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?i:"")+'">'+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r}))?i:"")+"</a>"},20:function(e,t,n,a,r){var i,o,s;return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(21,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i?i:""},21:function(e,t,n,a,r){var i;return null!=(i=(n.is||t&&t.is||n.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?t.type:t,"==","novel",{name:"is",hash:{},fn:e.program(5,r,0),inverse:e.program(22,r,0),data:r}))?i:""},22:function(e,t,n,a,r){var i;return null!=(i=(n.is||t&&t.is||n.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?t.illust_x_restrict:t,"==",0,{name:"is",hash:{},fn:e.program(23,r,0),inverse:e.program(25,r,0),data:r}))?i:""},23:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression;return'<a href="/member_illust.php?mode=medium&amp;illust_id='+l("function"==typeof(o=null!=(o=n.illust_id||(null!=t?t.illust_id:t))?o:c)?o.call(s,{name:"illust_id",hash:{},data:r}):o)+'&amp;ref=profile_card" target="_blank" class="item  '+l((n.get_thumbnail_classes||t&&t.get_thumbnail_classes||c).call(s,null!=t?t.illust_id:t,null!=t?t.illust_type:t,null!=t?t.illust_page_count:t,null!=t?t.illust_book_style:t,{name:"get_thumbnail_classes",hash:{},data:r}))+" "+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?i:"")+'" style="background-image:url('+l(e.lambda(null!=(i=null!=t?t.url:t)?i["240mw"]:i,t))+')">'+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r}))?i:"")+"</a>"},25:function(e,t,n,a,r){var i;return null!=(i=n.if.call(null!=t?t:e.nullContext||{},(i=r&&r.root)&&i.r18_page,{name:"if",hash:{},fn:e.program(23,r,0),inverse:e.program(18,r,0),data:r}))?i:""},27:function(e,t,n,a,r){var i,o,s;return o=null!=(o=n.items||(null!=t?t.items:t))?o:n.helperMissing,s={name:"items",hash:{},fn:e.program(28,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(null!=t?t:e.nullContext||{},s):o,n.items||(i=n.blockHelperMissing.call(t,i,s)),null!=i?i:""},28:function(e,t,n,a,r){var i;return null!=(i=(n.is||t&&t.is||n.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?t.type:t,"==","novel",{name:"is",hash:{},fn:e.program(5,r,0),inverse:e.program(29,r,0),data:r}))?i:""},29:function(e,t,n,a,r){var i;return null!=(i=(n.is||t&&t.is||n.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?t.illust_x_restrict:t,"==",0,{name:"is",hash:{},fn:e.program(30,r,0),inverse:e.program(32,r,0),data:r}))?i:""},30:function(e,t,n,a,r){var i,o,s=null!=t?t:e.nullContext||{},c=n.helperMissing,l=e.escapeExpression;return'<a href="/member_illust.php?mode=medium&amp;illust_id='+l("function"==typeof(o=null!=(o=n.illust_id||(null!=t?t.illust_id:t))?o:c)?o.call(s,{name:"illust_id",hash:{},data:r}):o)+'&amp;ref=profile_card" target="_blank" class="item  '+l((n.get_thumbnail_classes||t&&t.get_thumbnail_classes||c).call(s,null!=t?t.illust_id:t,null!=t?t.illust_type:t,null!=t?t.illust_page_count:t,null!=t?t.illust_book_style:t,{name:"get_thumbnail_classes",hash:{},data:r}))+" "+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?i:"")+'" style="background-image:url('+l(e.lambda(null!=(i=null!=t?t.url:t)?i["128x128"]:i,t))+')">'+(null!=(i=n.if.call(s,null!=t?t.is_muted:t,{name:"if",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r}))?i:"")+"</a>"},32:function(e,t,n,a,r){var i;return null!=(i=n.if.call(null!=t?t:e.nullContext||{},(i=r&&r.root)&&i.r18_page,{name:"if",hash:{},fn:e.program(30,r,0),inverse:e.program(18,r,0),data:r}))?i:""},34:function(e,t,n,a,r){var i=null!=t?t:e.nullContext||{},o=n.helperMissing,s=e.escapeExpression;return'<li class="new-context"><a href="/messages.php?receiver_id='+s((n.url_encode||t&&t.url_encode||o).call(i,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'&amp;ref=profile_card" target="_blank">'+s((n.t||t&&t.t||o).call(i,"メッセージを送る",{name:"t",hash:{},data:r}))+'</a></li><li class="new-context"><a href="/user_infomsg.php?id='+s((n.url_encode||t&&t.url_encode||o).call(i,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'&amp;ref=profile_card" target="_blank">'+s((n.t||t&&t.t||o).call(i,"ユーザーを報告・ブロック",{name:"t",hash:{},data:r}))+"</a></li>"},36:function(e,t,n,a,r){var i,o,s,c=null!=t?t:e.nullContext||{},l=n.helperMissing,u=n.blockHelperMissing,d='<div class="_follow-button-container';return o=null!=(o=n.is_follow||(null!=t?t.is_follow:t))?o:l,s={name:"is_follow",hash:{},fn:e.program(37,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.is_follow||(i=u.call(t,i,s)),null!=i&&(d+=i),d+='"><button class="follow-button">',o=null!=(o=n.is_follow||(null!=t?t.is_follow:t))?o:l,s={name:"is_follow",hash:{},fn:e.program(39,r,0),inverse:e.noop,data:r},i="function"==typeof o?o.call(c,s):o,n.is_follow||(i=u.call(t,i,s)),null!=i&&(d+=i),o=null!=(o=n.is_follow||(null!=t?t.is_follow:t))?o:l,s={name:"is_follow",hash:{},fn:e.noop,inverse:e.program(41,r,0),data:r},i="function"==typeof o?o.call(c,s):o,n.is_follow||(i=u.call(t,i,s)),null!=i&&(d+=i),d+"</button></div>"},37:function(e,t,n,a,r){return" following2"},39:function(e,t,n,a,r){return e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"フォロー中",{name:"t",hash:{},data:r}))},41:function(e,t,n,a,r){return e.escapeExpression((n.t||t&&t.t||n.helperMissing).call(null!=t?t:e.nullContext||{},"フォローする",{name:"t",hash:{},data:r}))},compiler:[7,">= 4.0.0"],main:function(e,t,n,a,r){var i,o,s,c=e.escapeExpression,l=null!=t?t:e.nullContext||{},u=n.helperMissing,d="function",h=n.blockHelperMissing,p='<div class="items layout-'+c(e.lambda(null!=(i=null!=t?t.items:t)?i.length:i,t))+'">'+(null!=(i=(n.is||t&&t.is||u).call(l,null!=(i=null!=t?t.illusts:t)?i.length:i,"==",0,{name:"is",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?i:"")+(null!=(i=(n.is||t&&t.is||u).call(l,null!=(i=null!=t?t.items:t)?i.length:i,"==",1,{name:"is",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?i:"")+(null!=(i=(n.is||t&&t.is||u).call(l,null!=(i=null!=t?t.items:t)?i.length:i,"==",2,{name:"is",hash:{},fn:e.program(20,r,0),inverse:e.noop,data:r}))?i:"")+(null!=(i=(n.is||t&&t.is||u).call(l,null!=(i=null!=t?t.items:t)?i.length:i,"==",3,{name:"is",hash:{},fn:e.program(27,r,0),inverse:e.noop,data:r}))?i:"")+'</div><div class="user-info"><div class="user-profile"><a href="/member.php?id='+c((n.url_encode||t&&t.url_encode||u).call(l,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'&amp;ref=profile_card" class="_user-icon cover-texture" target="_blank" title="'+c(typeof(o=null!=(o=n.user_name||(null!=t?t.user_name:t))?o:u)===d?o.call(l,{name:"user_name",hash:{},data:r}):o)+'" style="background-image: url(\''+c(typeof(o=null!=(o=n.profile_img||(null!=t?t.profile_img:t))?o:u)===d?o.call(l,{name:"profile_img",hash:{},data:r}):o)+'\');" ></a><div class="user-menu-items-wrapper"><ul class="user-menu-items"><li><a href="/member.php?id='+c((n.url_encode||t&&t.url_encode||u).call(l,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'&amp;ref=profile_card" target="_blank">'+c((n.t||t&&t.t||u).call(l,"プロフィール",{name:"t",hash:{},data:r}))+'</a></li><li><a href="/member_illust.php?id='+c((n.url_encode||t&&t.url_encode||u).call(l,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'&amp;ref=profile_card" target="_blank">'+c((n.t||t&&t.t||u).call(l,"作品",{name:"t",hash:{},data:r}))+'</a></li><li><a href="/bookmark.php?id='+c((n.url_encode||t&&t.url_encode||u).call(l,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'&amp;ref=profile_card" target="_blank">'+c((n.t||t&&t.t||u).call(l,"ブックマーク",{name:"t",hash:{},data:r}))+'</a></li><li><a href="/stacc/'+c((n.url_encode||t&&t.url_encode||u).call(l,null!=t?t.user_account:t,{name:"url_encode",hash:{},data:r}))+'&amp;ref=profile_card" target="_blank">'+c((n.t||t&&t.t||u).call(l,"フィード",{name:"t",hash:{},data:r}))+"</a></li>";return o=null!=(o=n.controllable||(null!=t?t.controllable:t))?o:u,s={name:"controllable",hash:{},fn:e.program(34,r,0),inverse:e.noop,data:r},i=typeof o===d?o.call(l,s):o,n.controllable||(i=h.call(t,i,s)),null!=i&&(p+=i),p+='</ul></div></div><h1><a href="/member.php?id='+c((n.url_encode||t&&t.url_encode||u).call(l,null!=t?t.user_id:t,{name:"url_encode",hash:{},data:r}))+'&amp;ref=profile_card" target="_blank" class="user-name">'+c(typeof(o=null!=(o=n.user_name||(null!=t?t.user_name:t))?o:u)===d?o.call(l,{name:"user_name",hash:{},data:r}):o)+'</a></h1><p class="description">'+c((n.truncate||t&&t.truncate||u).call(l,null!=t?t.user_comment:t,16,{name:"truncate",hash:{},data:r}))+"</p>",o=null!=(o=n.controllable||(null!=t?t.controllable:t))?o:u,s={name:"controllable",hash:{},fn:e.program(36,r,0),inverse:e.noop,data:r},i=typeof o===d?o.call(l,s):o,n.controllable||(i=h.call(t,i,s)),null!=i&&(p+=i),p+"</div>"},useData:!0});n.d(t,"b",function(){return y}),n.d(t,"a",function(){return k}),u()(function(){y.setup()});var y=function(){function e(t,n){Object(s.a)(this,e),this.target=t,this.data=n}return Object(c.a)(e,null,[{key:"setup",value:function(){var t=null,n=null;d.a.d.on("mouseenter",".ui-profile-popup",function(a){if(!u()(a.relatedTarget).closest("._profile-popup").length){n=null,window.clearTimeout(t);var r=u()(a.currentTarget),i=r.dataset();i.user_id&&(t=window.setTimeout(function(){(n=new e(r,i)).open()},150))}}).on("mouseleave",".ui-profile-popup",function(e){u()(e.relatedTarget).closest("._profile-popup").length||null!=n&&n.close(),n=null,window.clearTimeout(t)})}}]),Object(c.a)(e,[{key:"open",value:function(){var e=this;this.container=u()(g(this.data)).appendTo("body"),d.a.ui.popupPosition(this.container,this.target,{offset:-10,nipple:u()(".nipple",this.container),nippleMargin:5}),this.request(),this.modal=d.a.ui.modal.push(this.container,{disposable:!0}),this.container.on("mouseenter",function(t){u()(t.relatedTarget).closest(e.target).length||e.container.stop(!0).fadeTo(100,1)}).on("mouseleave",function(t){u()(t.relatedTarget).closest(e.target).length||e.close()})}},{key:"request",value:function(){var t=this;return p.q({user_ids:this.data.user_id,illust_num:3,novel_num:3},{cache:d.a.req.storeObject(864e5)}).done(function(n,a,r,i){e.cache=i;var o=n.body[0];o.event_ref=t.data.event_ref,o.controllable=h.default.user.loggedIn&&h.default.user.id!==o.user_id,o.premium=!!h.default.user.premium,o.r18_page=!0,o.items=o.illusts.concat(o.novels).slice(0,3),u()(".wrapper",t.container).html(u()(b(o))),o.self||new k(u()("._follow-button-container",t.container),o)})}},{key:"close",value:function(){var e=this;this.container.stop(!0).fadeOut("fast",function(){d.a.ui.modal.close(e.modal)})}}]),e}(),k=function(){function e(t,n){Object(s.a)(this,e),this.data=n,this.container=u()(t).on("click",".follow-button",this.follow.bind(this)).on("click",".update-button",this.update.bind(this)).on("click",".unfollow-button",this.unfollow.bind(this)),this.data.premium&&this.container.one("mouseenter",this.folder.bind(this))}return Object(c.a)(e,[{key:"folder",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),p.p(h.default.user.id).done(function(e,n,a,r){y.folderCache=r,t.folders=Array.from(new Set(Object(o.a)(y.newFolders||[]).concat(Object(o.a)(Object.keys(e.tag_a))))),t.folders.sort(),t.updateFolder()})}},{key:"newFolder",value:function(){var e=u.a.trim(window.prompt(d.a.t("フォルダー名を指定してください")));if(e&&!this.folders.includes(e)){y.newFolders||(y.newFolders=[]),y.newFolders.push(e),this.folders.push(e),this.folders.sort();var t=this.folders.indexOf(e);t=-1===t?1:t+1,u()(this.folderItem(e)).insertAfter(u()("option",this.container).eq(t)).prop("selected",!0)}}},{key:"updateFolder",value:function(){var e=this,t=u()("select",this.container).append(this.folderItem(this.folders)).prop("disabled",!1).on("change",function(){"new"===t[0].value&&1===t[0].selectedIndex&&e.newFolder()})}},{key:"folderItem",value:function(e){return(Array.isArray(e)?e:[e]).reduce(function(e,t){return e.add(u()("<option>").text(t))},u()([]))}},{key:"updateState",value:function(){this.container.html(v(this.data)),this.container.toggleClass("following2",this.data.is_follow)}},{key:"follow",value:function(e){this.container.hasClass("following2")?this.unfollow(e):this.update(e)}},{key:"update",value:function(){var e=Object(i.a)(r.a.mark(function e(t){var n=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),t.stopPropagation(),u()(".options-wrapper",this.container).addClass("_hidden"),u()("button",this.container).prop("disabled",!0),e.prev=4,e.next=7,p.c(this.data.user_id,u()('input[name="restrict"]:checked',this.container).val(),u()("select",this.container).val());case 7:e.sent,this.data.is_follow=!0,this.updateState(),this.container.trigger("follow"),null!=y.cache&&y.cache.update({body:[{is_follow:!0}]}),y.newFolders=null,null!=y.folderCache&&y.folderCache(null),this.data.premium&&this.container.one("mouseenter",this.folder.bind(this)),this.container.one("mouseleave",function(){u()(".options-wrapper",n.container).removeClass("_hidden")}),this.data.event_ref&&d.a.ga.later(["ui_profile_popup","follow",this.data.event_ref]),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4),this.container.one("mouseleave",function(){u()(".options-wrapper",n.container).removeClass("_hidden")});case 22:return e.prev=22,u()("button",this.container).prop("disabled",!1),e.finish(22);case 25:case"end":return e.stop()}},e,this,[[4,19,22,25]])}));return function(t){return e.apply(this,arguments)}}()},{key:"unfollow",value:function(){var e=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),t.stopPropagation(),u()(".options-wrapper",this.container).addClass("_hidden"),u()("button",this.container).prop("disabled",!0),e.prev=4,e.next=7,p.m(this.data.user_id);case 7:e.sent,this.data.is_follow=!1,this.updateState(),this.data.premium&&this.updateFolder(),this.container.trigger("unfollow"),null!=y.cache&&y.cache.update({body:[{is_follow:!1}]}),u()(".options-wrapper",this.container).removeClass("_hidden"),this.data.event_ref&&d.a.ga.later(["ui_profile_popup","unfollow",this.data.event_ref]),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),u()(".options-wrapper",this.container).removeClass("_hidden");case 20:return e.prev=20,u()("button",this.container).prop("disabled",!1),e.finish(20);case 23:case"end":return e.stop()}},e,this,[[4,17,20,23]])}));return function(t){return e.apply(this,arguments)}}()}]),e}()},118:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"k",function(){return d}),n.d(t,"i",function(){return h}),n.d(t,"f",function(){return p}),n.d(t,"j",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"h",function(){return v});var a=n(11),r=n(21),i=n(2),o=(n(10),function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;return r.b("/rpc/index.php",{mode:"save_novel_bookmark",novel_id:e,restrict:Number(t),comment:n,tags:a.join(" ")},i)}),s=function(e,t){return r.a("/novel/rpc/index.php",{mode:"get_novel_detail_by_ids",novel_ids:e.join()},t)},c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,a=arguments.length>3?arguments[3]:void 0;return r.a("/novel/rpc/index.php",{mode:"get_view_history",date:"".concat(e.getFullYear(),"-").concat(i.a.padding(e.getMonth()+1),"-").concat(i.a.padding(e.getDate())),before:t,count:n},a)},l=function(e){return r.b("/novel/rpc/index.php",{mode:"save_novel_view_history_clear_time"},e)},u=function(e,t,n,a,i,o){return r.b("/novel/rpc_novel_illust.php",{illust_ids:a.map(encodeURIComponent).join(","),mtime:"number"==typeof n?n:parseInt(n,10),content_id:e,user_id:t,x_restrict:i,restrict:o,verbosity:""})},d=function(e,t,n){if(n<1)throw new RangeError("".concat(n," must be strictly positive"));return r.b("/novel/rpc_marker.php",{mode:"save",i_id:e,u_id:t,page:n})},h=function(e,t){return r.b("/novel/rpc_marker.php",{mode:"save",i_id:e,u_id:t,page:0})},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r.b("/novel/rpc_marker.php",{mode:"list",u_id:e,offset:t})},f=function(e){return r.b("/novel/rpc/index.php",Object(a.a)({mode:"save_novel_draft"},e))},m=function(e){return r.a("/novel/rpc/index.php",{mode:"load_novel_draft",release_id:e})},v=function(e){return r.a("/novel/rpc/index.php",{mode:"poll_novel_draft",release_id:e,request_time:Date.now()})}},119:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"c",function(){return h}),n.d(t,"a",function(){return p});var a=n(7),r=n(8),i=n(2),o=n(0),s=n.n(o),c=n(10),l=n(19),u=n(15);s()(function(){i.a.storage.localStorage("hideHistoryBalloon",null),i.a.storage.localStorage("hideToolmenuBalloon",null);var e=s()("#back-to-top");if(!e.length)return;var t=!1;function n(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=i.a.w.scrollTop()<=i.a.w.height()/2;(a!==t||n)&&e.toggleClass("off",t=a)}i.a.w.on("scroll",i.a.throttle(function(){n()})),n(!0)});var d={date:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"undefined"!=typeof Intl?new Intl.DateTimeFormat(Object(u.a)(),{year:t?"numeric":void 0,month:"short",day:"numeric"}).format(e):e.toLocaleDateString()},time:function(e){return"".concat(e.getHours(),":").concat(i.a.padding(e.getMinutes()))},datetime:function(e,t){return"".concat(d.date(e,t)," ").concat(d.time(e))}};function h(e,t,n){switch(n){case"200sq":break;default:var a=n;return e>t?[a,Math.round(a*t/e)]:[Math.round(a*e/t),a]}}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,e),this.preloadAreaRate=1,this.targets=null,this.inTargets=null,this.outTargets=null,t.context&&(this.context=s()(t.context)),t.selector&&(this.selector=t.selector),t.target&&this.watch(t.target)}return Object(r.a)(e,[{key:"off",value:function(){var e=this.context;return(void 0!==e?e:i.a.w).off(".area"),this}},{key:"watch",value:function(e,t){var n=s()(e||this.selector,t||this.context);return n.length?(this.targets?(this.targets=this.targets.add(n),this.outTargets=this.outTargets.add(n)):(this.targets=n,this.on()),this.resize(),this.update(),this):this}},{key:"on",value:function(){var e=this,t=i.a.throttle(function(){e.update()},void 0,500);return this.context?this.context.on("scroll.area",t):i.a.w.on("resize.area",function(){e.resize()}).on("scroll.area resize.area",t),this}},{key:"resize",value:function(){var e=this.context||i.a.w;this.windowWidth=e.width(),this.windowHeight=e.height()}},{key:"update",value:function(){if(this.targets){var e=this.context||i.a.w,t=e.scrollTop(),n=e.scrollLeft(),a=n+this.windowWidth,r=t+this.windowHeight;this.inTargets&&this.outTargets||(this.inTargets=s()(),this.outTargets=s()(this.targets));for(var o=this.windowWidth*this.preloadAreaRate,c=this.windowHeight*this.preloadAreaRate,l=Array.from(this.targets,function(e){return s()(e)}),u=0;u<l.length;u++){var d=l[u],h=d.position();if(h.left+n>=n-o&&h.left+n<a+o&&h.top>=t-2*c&&h.top<r+c){var p=this.outTargets.filter(d).length;d.trigger("area",[p]),p&&(d.trigger("areain"),this.outTargets=this.outTargets.not(d),this.inTargets=this.inTargets.add(d))}else this.inTargets.filter(d).length>0&&(d.trigger("areaout"),this.inTargets=this.inTargets.not(d),this.outTargets=this.outTargets.add(d))}}}}],[{key:"setup",value:function(t){var n=this,a="._area-target";return e.initialized||(e.initialized=!0,i.a.d.on("areain areaout",a,function(e){var t=e.currentTarget,a={areain:0,areaout:1}[e.type],r=(s()(t).dataset("filter")||"").trim().split(/\s+/),i=!0,o=!1,c=void 0;try{for(var l,u=r[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var d=l.value;n.filters[d];var h=n.filters[d];if(void 0!==h&&!1===h[a].call(t,e))break}}catch(e){o=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw c}}})),t?new e({target:a,context:t,selector:a}):f.watch(a)}},{key:"addFilter",value:function(e,t,n){return this.filters[e]=[t,n],this}}]),e}();p.initialized=!1,p.filters={},p.addFilter("lazy-image",function(){var e=s()(this),t=e.data("src");t&&("IMG"===this.nodeName?e.attr("src",t):e.css("background-image",Object(l.b)(t)))},function(){var e=s()(this);e.data("src")&&("IMG"===this.nodeName?e.attr("src","".concat(c.default.sourcePath,"../../images/common/transparent.gif")):e.css("background-image",""),e.css({width:e.width(),height:e.height()}))});var f=new p},120:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(1),r=(n(4),n(5),n(18)),i=n.n(r),o=(new Map([[12,["add","check","menu","limited","tag","remove"]],[20,["limited","logo-twitter","logo-facebook","explicit"]],[30,["close","bookmark","dot","send"]]]),function(e){var t=e.size,n=e.icon,r=e.className,o=void 0===r?"":r,s=e.tooltip,c=void 0===s?null:s;return Object(a.a)("i",{className:i()(o,"_pico-".concat(t),"_icon-".concat(n)),"data-tooltip":c})})},121:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"f",function(){return h}),n.d(t,"e",function(){return p});n(28);var a=n(3),r=n.n(a),i=n(6),o=n(37),s=n.n(o),c="https://factory.pixiv.net",l=function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new URL("/api/v1/pixiv_public/products.json",c),n=t.href,e.next=3,fetch(n);case 3:return e.next=5,e.sent.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(i.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new URL("/api/v1/pixiv_public/pixiv_items.json",c)).search=t.map(function(e){return"".concat(encodeURI("pixiv_item_uid[]"),"=").concat(encodeURI(e))}).join("&"),e.next=4,fetch(n.href);case 4:return e.next=6,e.sent.json();case 6:return a=e.sent,e.abrupt("return",a.pixivItems);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),d=function(e,t,n){return e.post("/ajax/goods/create",{},s.a.stringify({item_group_id:t,illust_id:n}))},h=function(e,t){return e.post("/ajax/goods/unlink",{},s.a.stringify({pixiv_item_uid:t}))},p=function(){var e=Object(i.a)(r.a.mark(function e(t,n,a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.post("/ajax/goods/edit_selling",{},s.a.stringify({pixiv_item_uid:n,selling:a?"1":"0"})));case 1:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()},123:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c});var a,r=n(10),i="https://cdn.onesignal.com/sdks/OneSignalSDK.js",o=new Promise(function(e){a=e}),s=!1;function c(){if(r.default.user.loggedIn&&r.default.user.id&&r.default.config.oneSignalAppId&&a){if(!s){var t=document.createElement("script");t.src=i,document.head.appendChild(t),s=!0}e.OneSignal||(e.OneSignal=[]),OneSignal.push(["init",{appId:r.default.config.oneSignalAppId,autoRegister:!1,persistNotification:!1,notifyButton:{enable:!1},welcomeNotification:{disable:!0}}]),OneSignal.push(function(){a(e.OneSignal),a=void 0})}}}).call(this,n(77))},124:function(e,t,n){e.exports={label:"rvn4y30",disabled:"_1Wzo2uK",text:"_3PnALu6",checkbox:"_1kxzUTA",switch:"teqpeUx",switchKnob:"_3W0k7s1"}},125:function(e,t,n){e.exports={container:"_3dnYKSp",header:"_1NKseNQ",scrollArea:"_2tQHxuE",messageList:"_1-G29mR",loadingArea:"_3JoOytb",footer:"_18X4w4E"}},127:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(1),r=n(16),i=n(7),o=n(8),s=n(14),c=n(12),l=n(13),u=n(18),d=n.n(u),h=n(4),p=n.n(h),f=n(79),m=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.children,i=t.disabled,o=t.title,s=t.onClick,c=t.primary,l=t.linkLike,u=t.inverted,h=t.danger,p=t.big,m=t.middle,b=t.bright,y=t.wide,k=t.forceBubblingWhenDisabled,w=!this.props.primary;var _=c&&i&&k;return Object(a.a)("button",{type:c?"submit":"button",title:o,disabled:!_&&i,"aria-disabled":i,onClick:i&&_&&!this.props.noPreventDefault?v:s,onFocus:i&&_?g:void 0,className:d()((e={},Object(r.a)(e,f.primary,c),Object(r.a)(e,f.alt,w),Object(r.a)(e,f.linkLike,!!l),Object(r.a)(e,f.spaLinkLike,"spa"===l),Object(r.a)(e,f.inverted,u),Object(r.a)(e,f.danger,h),Object(r.a)(e,f.big,p),Object(r.a)(e,f.middle,m),Object(r.a)(e,f.bright,b),Object(r.a)(e,f.wide,y),Object(r.a)(e,f.forceBubbling,_),e))},void 0,n)}}]),t}(p.a.PureComponent);function v(e){e.preventDefault()}function g(e){e.currentTarget.blur()}m.defaultProps={primary:!1,disabled:!1,linkLike:!1,inverted:!1,danger:!1,big:!1,middle:!1,bright:!1,wide:!1}},140:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r}),n.d(t,"i",function(){return d}),n.d(t,"k",function(){return h}),n.d(t,"l",function(){return p}),n.d(t,"d",function(){return f}),n.d(t,"m",function(){return m}),n.d(t,"g",function(){return b}),n.d(t,"j",function(){return w}),n.d(t,"c",function(){return _}),n.d(t,"f",function(){return x});var a,r,i=n(28),o=n(11),s=n(16),c=n(36),l=n(32),u=n(141);function d(){return{type:a.RESET_ALL,payload:void 0}}function h(e,t){return{type:a.SET,payload:Object(s.a)({},e,t)}}function p(e){return{type:a.SET,payload:e}}function f(){return{type:a.COMMIT,payload:void 0}}function m(e){return{type:a.STEP,payload:e}}n.d(t,"h",function(){return u.e}),function(e){e.RESET_ALL="Search/SearchSettings/resetAll",e.SET="Search/SearchSettings/set",e.COMMIT="Search/SearchSettings/commit",e.STEP="Search/SearchSettings/step"}(a||(a={})),function(e){e[e.Top=0]="Top",e[e.WordDetail=1]="WordDetail"}(r||(r={})),t.e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(!e)return e;var n=e.formState?Object(u.c)(e.formState,t):void 0,s=n===e.formState?e:Object(o.a)({},e,{formState:n});switch(t.type){case a.RESET_ALL:return s.formState?Object(o.a)({},s,{formState:void 0}):s;case a.SET:if(s.formState&&Object.entries(t.payload).every(function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];return s.formState.params[n]===a}))return s;for(var l={},d=Object.entries(t.payload),h=0;h<d.length;h++){var p=Object(i.a)(d[h],2),f=p[0],m=p[1];if(!v(f))throw new Error("Invalid SET payload setting unknown SearchParams key ".concat(f));l[f]=void 0===m?s.params[f]:m}return Object(c.a)(s,Object(o.a)({},s,{formState:Object(c.a)(s.formState,{step:s.formState?s.formState.step:r.Top,params:Object(c.a)(s.formState&&s.formState.params,Object(o.a)({},s.formState?s.formState.params:s.params,l))})}));case a.COMMIT:return s.formState?Object(o.a)({},s,{params:s.formState.params,formState:void 0}):s;case a.STEP:return s.formState?Object(c.a)(s,Object(o.a)({},s,{formState:Object(c.a)(s.formState,Object(o.a)({},s.formState,{step:t.payload}))})):Object(o.a)({},s,{formState:{params:s.params,step:t.payload}})}return s;function v(e){return e in s.params}};var v,g=function(e){return e.search},b=Object(l.createSelector)(g,function(e){return e&&e.formState?e.formState.step:r.Top}),y=Object(l.createSelector)(g,function(e){return e&&(e.formState&&e.formState.params||e.params)}),k=Object(l.createSelector)(y,function(e,t){return t},function(e,t){return e?e[t]:void 0});function w(e){void 0===v&&(v=new Map);var t=v.get(e);if(t)return t;var n=function(t){return k(t,e)};return v.set(e,n),n}function _(){return function(e,t){var n=t();if(n.search&&n.search.formState)switch(n.search.formState.step){case r.Top:return;case r.WordDetail:return e(Object(u.b)()),void e(m(r.Top))}}}function x(){return function(e,t){var n=t();if(n.search&&n.search.formState)switch(n.search.formState.step){case r.Top:return;case r.WordDetail:return e(Object(u.f)()),void e(m(r.Top))}}}},141:function(e,t,n){"use strict";var a,r,i,o,s=n(16),c=n(11),l=n(32),u=n(140),d=n(28),h=/[\s\xA0　]+/;function p(e){for(var t,n="string"==typeof e?function(e){var t=0,n=Array.from(e).reduce(function(e,n){if(h.test(n))return""===e.token.source?e:("OR"===e.token.source?e.tokens.push({type:a.Binary,source:e.token.source}):e.tokens.push(e.token),t=0,e.token={type:a.Word,source:""},e);if("("===n){if(""===e.token.source)return e.tokens.push({type:a.Parens,source:n}),e;t+=1}if(")"===n){if(!(t>0))return""!==e.token.source&&(e.tokens.push(e.token),e.token={type:a.Word,source:""}),e.tokens.push({type:a.Parens,source:n}),e;t-=1}return"-"===n&&""===e.token.source?(e.tokens.push({type:a.Unary,source:n}),e):(e.token.source+=n,e)},{tokens:[],token:{type:a.Word,source:""}});return""!==n.token.source&&n.tokens.push(n.token),n.tokens}(e):e,i={type:r.Grouping,nodes:[]},o=[i],s=0;s<n.length;s++){for(var c=o[0];c.type===r.Or&&x(c);c=o[0]){if(o.shift(),(w=o[0]).type!==r.Or)w.nodes.push(c);else{if(x(w))throw new Error("Complete Or node inside another Complete Or node");if(w.right=c.left,!x(w))throw new Error("Or node in stack could not be completed by filling the right side");o.shift(),c.left={type:r.Grouping,nodes:[w]},o.unshift(c)}}var l=n[s];if(l.type!==a.Parens){var u=s+1<n.length?n[s+1]:void 0;if(l.type===a.Unary&&"-"===l.source&&u){if(u.type===a.Word){s+=1;var p={type:r.NegatedWord,word:u.source};t=p;var f=o[0];if(f.type===r.Or){f.right=p;continue}f.nodes.push(p)}}else if(l.type!==a.Word);else{var m={type:r.Word,word:l.source};if(t=m,u&&u.type===a.Binary){s+=1;var v={type:r.Or,left:m,right:void 0};o.unshift(v);continue}var g=o[0];if(g.type===r.Or){g.right=m;continue}g.nodes.push(m)}}else if("("===l.source)o.unshift({type:r.Grouping,nodes:[]});else if(")"===l.source&&o.length>1){var b=o.shift(),y=o[0];if(y.type===r.Grouping)b.type===r.Or?x(b)?y.nodes.push(b):_(b.left)&&y.nodes.push(b.left,{type:r.Word,word:"OR"}):y.nodes.push(b);else{if(b.type!==r.Or){y.right=b;continue}x(b)?y.right={type:r.Grouping,nodes:[b]}:_(b.left)&&(y.right={type:r.Grouping,nodes:[b.left,{type:r.Word,word:"OR"}]})}}else t?t.word+=l.source:(t={type:r.Word,word:l.source},i.nodes.push(t))}for(var k=o[0];k.type===r.Or&&x(k);k=o[0]){var w;if(o.shift(),(w=o[0]).type!==r.Or)w.nodes.push(k);else{if(x(w))throw new Error("Complete Or node inside another Complete Or node");if(w.right=k.left,!x(w))throw new Error("Or node in stack could not be completed by filling the right side");o.shift(),k.left={type:r.Grouping,nodes:[w]},o.unshift(k)}}return function e(t){var n=!0;var a=!1;var i=void 0;try{for(var o,s=t.entries()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=Object(d.a)(o.value,2),l=c[0],u=c[1];if(u.type===r.Grouping)if(1===u.nodes.length){var h=Object(d.a)(u.nodes,1),p=h[0];p.type!==r.Word&&p.type!==r.NegatedWord||(p.word="(".concat(p.word,")")),t[l]=p}else e(u.nodes);else u.type===r.Or&&(u.left.type===r.Grouping&&e(u.left.nodes),u.right.type===r.Grouping&&e(u.right.nodes))}}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}}(i.nodes),i.nodes;function _(e){return void 0!==e&&(e.type!==r.Or||x(e))}function x(e){return!function e(t){return void 0===t.left||void 0===t.right||t.left.type===r.Or&&e(t.left)||t.right.type===r.Or&&e(t.right)}(e)}}function f(e){var t="string"==typeof e?p(e):e,n={allWords:[],orWords:[],notWords:[]};if(0===t.length)return n;var a=!0,i=!1,o=void 0;try{for(var s,c=t[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;if(l.type===r.Word)n.allWords.push(l.word);else if(l.type===r.NegatedWord)n.notWords.push(l.word);else if(l.type===r.Or){if(!d(l))return}else if(l.type===r.Grouping){var u=f(l.nodes);if(void 0===u)return;n.allWords=n.allWords.concat(u.allWords),n.orWords=n.orWords.concat(u.orWords),n.notWords=n.notWords.concat(u.notWords)}}}catch(e){i=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(i)throw o}}return n;function d(e){if(e.left.type===r.Word)n.orWords.push(e.left.word);else{if(e.left.type!==r.Grouping||1!==e.left.nodes.length||e.left.nodes[0].type!==r.Or)return!1;if(!d(e.left.nodes[0]))return!1}if(e.right.type===r.Word)n.orWords.push(e.right.word);else{if(e.right.type!==r.Grouping||1!==e.right.nodes.length||e.right.nodes[0].type!==r.Or)return!1;if(!d(e.right.nodes[0]))return!1}return!0}}function m(){return{type:i.Commit,payload:void 0}}function v(){return{type:i.Revert,payload:void 0}}function g(e,t){return{type:i.SetWord,payload:{type:e,word:t}}}!function(e){e[e.Word=0]="Word",e[e.Parens=1]="Parens",e[e.Unary=2]="Unary",e[e.Binary=3]="Binary"}(a||(a={})),function(e){e[e.Word=0]="Word",e[e.NegatedWord=1]="NegatedWord",e[e.Or=2]="Or",e[e.Grouping=3]="Grouping"}(r||(r={})),n.d(t,"b",function(){return m}),n.d(t,"f",function(){return v}),n.d(t,"a",function(){return o}),n.d(t,"g",function(){return g}),n.d(t,"e",function(){return k}),n.d(t,"d",function(){return _}),function(e){e.Commit="Search/SearchSettings/WordDetailStep/COMMIT",e.Revert="Search/SearchSettings/WordDetailStep/REVERT",e.SetWord="Search/SearchSettings/WordDetailStep/SET_WORD"}(i||(i={})),function(e){e.All="allWords",e.Not="notWords",e.Or="orWords"}(o||(o={}));t.c=function(e,t){switch(t.type){case u.a.STEP:if(t.payload===u.b.WordDetail)return e.wordDetail?e:Object(c.a)({},e,{wordDetail:void 0});break;case i.Commit:if(void 0!==e.wordDetail){var n=x(e.wordDetail.allWords.trim()),a=x(e.wordDetail.notWords.trim()),r=x(e.wordDetail.orWords.trim()),o=n.join(" ")+(1===r.length?" "+r[0]:""),l=a.length>0?"-"+a.join(" -"):"",d=r.length>1?r.join(" OR "):"",h=[o,l,""===d||""===o&&""===l?d:"(".concat(d,")")].filter(function(e){return""!==e}).join(" ");return h===e.params.word?e:Object(c.a)({},e,{params:Object(c.a)({},e.params,{word:h})})}return e;case i.Revert:return void 0===e.wordDetail?e:Object(c.a)({},e,{wordDetail:void 0});case i.SetWord:var p=t.payload,f=p.type,m=p.word,v=e.wordDetail,g=void 0===v?b(e):v;return g[f]===m?e:Object(c.a)({},e,{wordDetail:Object(c.a)({},g,Object(s.a)({},f,m))})}return e};var b=Object(l.createSelector)(function(e){return e},function(e){return{allWords:w(e,o.All)||"",notWords:w(e,o.Not)||"",orWords:w(e,o.Or)||""}}),y=Object(l.createSelector)(function(e){return Object(u.j)("word")(e)},function(e){return"string"==typeof e?f(e):void 0}),k=Object(l.createSelector)(y,function(e){return void 0!==e}),w=Object(l.createSelector)(function(e,t){return e.wordDetail},function(e,t){return e.params.word},function(e,t){return t},function(e,t,n){var a;return e?e[n]:t&&(a=f(t))&&a[n].join(" ")}),_=Object(l.createSelector)(function(e,t){var n=function(e){return e.search}(e);return n&&n.formState},function(e,t){return t},function(e,t){return e?w(e,t):void 0});function x(e){var t=function(e){return e.replace(/^[\s\xA0　]+/,"").replace(/[\s\xA0　]+$/,"")}(e);return t.length>0?t.split(h):[]}},144:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return l});var a=n(3),r=n.n(a),i=n(6),o=n(160);function s(e){return c.apply(this,arguments)}function c(){return(c=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<1)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,o.b;case 4:e.sent.addElement(t.get(0));case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<1)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,o.b;case 4:e.sent.removeElement(t.get(0));case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}},145:function(e,t,n){"use strict";n.r(t),n.d(t,"show",function(){return d}),n.d(t,"close",function(){return h});var a,r=n(11),i=n(3),o=n.n(i),s=n(6),c=n(36),l=n(94),u=n(39);function d(e,t){return function(){var n=Object(s.a)(o.a.mark(function n(r,i){var s,c;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=Object(l.b)(i()),n.next=3,u.f(s,e,t);case 3:c=n.sent,r({type:a.Show,payload:{context:e,contextId:t,items:c}});case 5:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}()}function h(){return{type:a.Close,payload:void 0}}n.d(t,"MuteContext",function(){return u.a}),n.d(t,"MuteValueType",function(){return u.c}),function(e){e.Show="pixiv/mute/modal/SHOW",e.Close="pixiv/mute/modal/CLOSE"}(a||(a={})),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{items:[],context:void 0,contextId:void 0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.Show:var n=t.payload;return e.context===n.context&&e.contextId===n.contextId?e:Object(r.a)({},e,{items:n.items,context:n.context,contextId:n.contextId});case a.Close:return void 0===e.context?e:Object(r.a)({},e,{context:void 0,contextId:void 0,items:[]});default:Object(c.b)(t)}return e}},147:function(e,t,n){e.exports={RecommendUsers:"_2V6YY0n",title:"zu0y9jT",closeButtonContainer:"_1HvZiwX",closeButton:"_24CuIIP",moduleAppear:"_1qj1yZE",moduleAppearActive:"_2Nwu6Iy","slide-in":"_3cwC--C",moduleExit:"JuSIS3g",moduleExitActive:"_232QE_0","slide-out":"_2eS7HWv"}},148:function(e,t,n){e.exports={label:"_1s1lbWD",title:"_1pobPxd",disabled:"_2RffflJ",checkbox:"_2WWvxkP",icon:"_3106ZbM"}},149:function(e,t,n){e.exports={titleAndMuteItemCountWrapper:"_1tB5MG0",muteItemCount:"_3TBavC0",full:"_3L-vzFT",premiumBannerWrapper:"_3BnxyjI",title:"_31r2BMx"}},15:function(e,t,n){"use strict";var a=n(122),r=n(29),i=n(4),o=n.n(i),s=n(162);function c(){var e=Object(a.a)(["Invalid substring \0\0\0 found"],["Invalid substring \\0\\0\\0 found"]);return c=function(){return e},e}var l=Symbol("t.options"),u=/\$\{?(\d+)\}?/g,d=/%\(([a-zA-Z0-9]+)(?::((?:\\\)|[^)])+))?\)/g,h=/%%\(/g;function p(e){for(var t=Object(s.a)(e),n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var p=a.reduce(function(e,t){return e.concat(t)},[]),m=(void 0!==t?t:e).replace(u,function(e,t){return f(p[+t-1]||e)}),v=p[a.length-1];if("object"===Object(r.a)(v)){var g=v[l]||{},b=[],y=m.replace(h,"\0%\0%\0(\0").replace(d,function(e,t,n){var a=void 0!==n?n.replace("\\)",")"):n;if(Object.prototype.hasOwnProperty.call(v,t)){var r=v[t],i="function"==typeof r?r(a):r;return o.a.isValidElement(i)?i.key?b.push(i):b.push(o.a.cloneElement(i,{key:"t-".concat(b.length)})):b.push(i.toString()),"\0\0\0"}return e}).replace(/\0%\0%\0\(\0/g,"%%(");if(b.length>0){var k=y.split("\0\0\0");if(k.length!==b.length+1)throw new Error(String.raw(c()));var w=b.every(function(e){return"string"==typeof e}),_=!g.noEscape&&w,x=k.reduce(function(e,t){return 0===b.length?e.concat(t):e.concat(t,_?f(b.shift()):b.shift())},[]);return w?x.join(""):x}return y}return m}function f(e){return e.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(e){if("en"!==b())return"".concat(e);var t=e%10;if(1===Math.floor(e%100/10))return"".concat(e,"th");switch(t){case 1:return"".concat(e,"st");case 2:return"".concat(e,"nd");case 3:return"".concat(e,"rd");default:return"".concat(e,"th")}}var v,g=n(19);function b(){if(void 0!==v)return v;var e=document.documentElement.lang.toLowerCase();switch(e){case"en":case"ko":v=e;break;case"zh-cn":case"zh":v="zh-CN";break;case"zh-tw":v="zh-TW";break;case"ja":v="ja";break;default:return Object(g.i)(e)}return v}function y(){return b().startsWith("zh")}n.d(t,"a",function(){return b}),n.d(t,"b",function(){return y}),n.d(t,"d",function(){return p}),n.d(t,!1,function(){}),n.d(t,"c",function(){return m})},150:function(e,t,n){e.exports={footer:"_3w1KooZ",buttonContainerWrapper:"a8iz0WS",buttonContainer:"_22h52Df",extraButtonContainerWrapper:"SrSOtVo",extraButtonContainer:"_3i4tBLZ"}},151:function(e,t,n){e.exports={background:"_3xwtgJH",flex:"eqsqPMW",dark:"_1Pr-WhJ",white:"_1CSCU_5",classic:"_3rtAiy7"}},153:function(e,t,n){"use strict";var a,r=n(3),i=n.n(r),o=n(6),s=n(63);function c(e,t){return e.get("/ajax/novels/chatstory_export",{},{novel_id:t})}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"d",function(){return h}),n.d(t,"c",function(){return p}),function(e){e.SetNovelBody="pixiv/chatstory/SET_NOVEL_BODY",e.UnsetNovelBody="pixiv/chatstory/UNSET_NOVEL_BODY",e.ShowChatstoryExportModal="pixiv/chatstory/SHOW_CHATSTORY_EXPORT_MODAL",e.HideChatstoryExportModal="pixiv/chatstory/HIDE_CHATSTORY_EXPORT_MODAL"}(a||(a={}));var l=function(e){return function(){var t=Object(o.a)(i.a.mark(function t(n,a){var r,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(s.b)(a()),t.next=3,c(r,e);case 3:o=t.sent,n(u(o));case 5:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},u=function(e){return{type:a.SetNovelBody,payload:{work:e}}},d=function(){return{type:a.UnsetNovelBody,payload:void 0}},h=function(){return{type:a.ShowChatstoryExportModal,payload:{}}},p=function(){return{type:a.HideChatstoryExportModal,payload:{}}}},159:function(e,t,n){"use strict";n.d(t,"b",function(){return g});var a=n(3),r=n.n(a),i=n(11),o=n(6),s=n(7),c=n(8),l=(n(230),n(50));n.d(t,"a",function(){return l.a});var u,d=n(93),h=n.n(d),p=n(37),f=n.n(p),m=new Map,v=function(){try{return URLSearchParams.toString().includes("[native code]")}catch(e){return"undefined"!=typeof URLSearchParams}}(),g=function(){function e(t){Object(s.a)(this,e),this.token=t}return Object(c.a)(e,[{key:"get",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n,a,o){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchWithQuery(t,n,a||{},Object(i.a)({},o,{headers:Object(i.a)({Accept:"application/json"},o&&o.headers)}));case 2:return s=e.sent,e.t0=this,e.next=6,s.json();case 6:return e.t1=e.sent,e.abrupt("return",e.t0.parseResponse.call(e.t0,e.t1));case 8:case"end":return e.stop()}},e,this)}));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n,a,o){var s,c,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=null===a?void 0:"string"==typeof a?"application/x-www-form-urlencoded; charset=utf-8":a instanceof FormData?void 0:a instanceof URLSearchParams?v?void 0:"application/x-www-form-urlencoded; charset=utf-8":"application/json; charset=utf-8",c=null===a?null:{body:"[object Object]"===Object.prototype.toString.call(a)||Array.isArray(a)?JSON.stringify(a):a},e.next=4,this.fetch(t,n,Object(i.a)({},o,{method:"POST",headers:Object(i.a)({Accept:"application/json"},s&&{"Content-Type":s},o&&o.headers)},c));case 4:return l=e.sent,e.t0=this,e.next=8,l.json();case 8:return e.t1=e.sent,e.abrupt("return",e.t0.parseResponse.call(e.t0,e.t1));case 10:case"end":return e.stop()}},e,this)}));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"fetch",value:function(e,t,n){return this.internalFetch(e,t,void 0,n)}},{key:"fetchWithQuery",value:function(e,t,n,a){var r=n instanceof URLSearchParams?n:f.a.stringify(n,{addQueryPrefix:!0});return this.internalFetch(e,t,r,a)}},{key:"parseResponse",value:function(e){if(e.error)throw new l.b(e.message||"未定義APIエラー");if(!Object.prototype.hasOwnProperty.call(e,"body"))throw new l.b("API responses must have a body. APIs that don't have body must be accessed with .fetch");return e.body}},{key:"internalFetch",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n,a,o){var s,c,l,u,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d=function(e,t){if(void 0===e)return u?{body:a}:void 0;var n=u?Object(i.a)({},e,{body:a}):e;if(void 0!==t){var r=n.headers;if(r instanceof Headers){var o=new Headers(r);return o.set("X-CSRF-Token",t),Object(i.a)({},n,{headers:o})}if(Array.isArray(r)){var s=r.filter(function(e){return"x-csrf-token"!==e[0].toLowerCase()});return s.push(["X-CSRF-Token",t]),Object(i.a)({},n,{headers:s})}return Object(i.a)({},n,{headers:Object(i.a)({},r,{"X-CSRF-Token":t})})}return n},s=m.get(t)||h.a.compile(t),m.has(t)||m.set(t,s),c=s(n),l=o&&"POST"===(o.method||"").toUpperCase()&&b(c),u="string"!=typeof a&&void 0!==a,e.abrupt("return",this.internalFetchWithoutParse(c.concat("string"==typeof a?a:""),d(o,l?this.token:void 0)));case 7:case"end":return e.stop()}},e,this)}));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"internalFetchWithoutParse",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,Object(i.a)({credentials:"same-origin"},n));case 2:if((a=e.sent).ok){e.next=6;break}throw new l.a(a.status,a.statusText);case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.origin;void 0===u&&(u=new Map);var n=u.get(e);if(void 0!==n)return n;var a=h.a.parse(e);if(a.length<1||"string"!=typeof a[0])return u.set(e,!1),!1;var r=new URL(t),i=new URL(a[0],t),o=r.origin===i.origin;return u.set(e,o),o}},160:function(e,t,n){"use strict";n.d(t,"b",function(){return _}),n.d(t,"a",function(){return C});var a=n(58),r=n(28),i=n(1),o=n(7),s=n(8),c=n(14),l=n(12),u=n(13),d=n(11),h=n(4),p=n.n(h),f=n(152),m=n.n(f),v=n(128),g=n.n(v),b=n(27),y=n(19),k=(n(470),n(468),n(272)),w=function(){var e;return{promise:new Promise(function(t){e=t}),resolve:e,resolved:!1}}(),_=w.promise,x=Object(y.g)("slide",k),j=Object(y.g)("fadeIn",k),O=Object(d.a)({},j,x),C=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).apply(this,arguments))).state={elementItems:new Map,elementCounter:0,reactItems:new Map},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"addElement",value:function(e){var t=new Map(this.state.elementItems);t.set(e,this.state.elementCounter+1),t.size!==this.state.elementItems.size&&this.setState({elementItems:t,elementCounter:this.state.elementCounter+1})}},{key:"addReactElement",value:function(e){if(!e.key||this.state.reactItems.has(e.key))throw new Error("A unique key is required, ".concat(e.key," is either missing or duplicate"));var t=new Map(this.state.reactItems);t.set(e.key,e),this.setState({reactItems:t})}},{key:"removeElement",value:function(e){var t=new Map(this.state.elementItems);t.delete(e),t.size!==this.state.elementItems.size&&this.setState({elementItems:t})}},{key:"removeReactElement",value:function(e){var t=new Map(this.state.reactItems);t.delete(e),this.setState({reactItems:t})}},{key:"componentDidMount",value:function(){if(w.resolved)throw new Error("Duplicate singleton");w.resolved=!0,w.resolve(this)}},{key:"componentWillUnmount",value:function(){throw new Error("Unmounting singleton")}},{key:"render",value:function(){return Object(i.a)(b.a,{},void 0,Object(i.a)(g.a,{id:"toolbar-items"},void 0,p.a.Children.map(this.props.children,function(e){return Object(i.a)(S,{appear:!0},void 0,e)}),Array.from(this.state.reactItems.values(),function(e){return Object(i.a)(S,{},e.key,e)}),this.state.elementItems.size>0&&this.replacedElementHack(this.state.elementItems)))}},{key:"replacedElementHack",value:function(e){return Array.from(e,function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(i.a)(S,{},a,Object(i.a)("div",{style:{float:"right"},dangerouslySetInnerHTML:{__html:n.outerHTML.replace(/\s*\bid=(['"])[^"]+\1/g,"")}}))})}}]),t}(p.a.Component);function S(e){return p.a.createElement(m.a,Object(a.a)({},e,{appear:e.appear,classNames:O,timeout:400}),e.children)}},161:function(e,t,n){"use strict";n.r(t),n.d(t,"request",function(){return i}),n.d(t,"user",function(){return o}),n.d(t,"illust",function(){return s});var a=n(11),r=n(21),i=function(e,t,n){return r.a("/rpc/recommender.php",Object(a.a)({type:e},t),n)},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return i("user",{sample_users:e,num_recommendations:t,nc:n})},s=function(e,t,n,a){return i("illust",{sample_illusts:e,num_recommendations:t,ranking_fallback:n?1:null},a)}},162:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var a=Object.create(null);function r(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a=Object.assign(Object.create(null),e):Object.assign(a,e)}function i(e){return a[e]}},163:function(e,t,n){e.exports={followButton:"_19QoINo",simple:"_1n4JNxJ"}},165:function(e,t,n){"use strict";var a=n(4),r=n.n(a),i=n(11),o=n(164),s=n(7),c=n(8),l=n(14),u=n(12),d=n(13),h=n(2);function p(e,t){var n=function(t){function n(){var e;return Object(s.a)(this,n),(e=Object(l.a)(this,Object(u.a)(n).apply(this,arguments))).handleClick=function(t){var n=e.props,a=n.onClick,r=n.later;a&&a(t),t.isDefaultPrevented()||(r?h.a.ga.later([e.props.gaCategory,e.props.gaAction,e.props.gaLabel,e.props.gaValue]):h.a.ga.trackEvent([e.props.gaCategory,e.props.gaAction,e.props.gaLabel,e.props.gaValue]))},e}return Object(d.a)(n,t),Object(c.a)(n,[{key:"render",value:function(){var t=this.props,n=(t.gaCategory,t.gaAction,t.gaLabel,t.gaValue,t.onClick,t.innerRef),a=(t.later,Object(o.a)(t,["gaCategory","gaAction","gaLabel","gaValue","onClick","innerRef","later"]));return r.a.createElement(e,Object(i.a)({},a,{ref:n,onClick:this.handleClick}))}}]),n}(r.a.Component);return n.displayName="tracked(".concat(e.displayName||e.name,")"),n.defaultProps=t,m&&Object.defineProperty(n,"name",{configurable:!0,value:"tracked(".concat(e.name,")")}),n}var f=Object.getOwnPropertyDescriptor(p,"name"),m=!f||f.configurable;n.d(t,"a",function(){return v}),n.d(t,"b",function(){return p});var v=p(function(e){return r.a.createElement("a",e)})},166:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(1),r=n(18),i=n.n(r),o=(n(4),n(275)),s=function(e){var t=e.loading,n=e.size,r=void 0===n?32:n;return Object(a.a)("div",{className:i()(t&&o.circleSpinner),style:{height:r}},void 0,Object(a.a)("div",{className:o.animation,style:{width:r,height:r,marginTop:-1*r/2,marginLeft:-1*r/2}}))}},167:function(e,t,n){"use strict";var a=n(1),r=n(58),i=n(29),o=n(7),s=n(8),c=n(14),l=n(12),u=n(13),d=n(18),h=n.n(d),p=n(4),f=n.n(p),m=n(15),v=n(273),g=(n(479),n(69)),b=n(16),y=Symbol("Separator"),k={label:y,disabled:!0},w=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).apply(this,arguments))).blockEvent=function(e){e.preventDefault(),e.stopPropagation(),function(e){return"href"in e&&"A"===e.tagName}(e.target)&&(e.target.target?window.open(e.target.href,e.target.target):window.location.href=e.target.href)},e.handleMouseDown=function(t){t.preventDefault(),t.stopPropagation(),e.props.onSelect(e.props.option,t)},e.handleMouseEnter=function(t){e.onFocus(t)},e.handleMouseMove=function(t){e.onFocus(t)},e.handleTouchEnd=function(t){e.dragging||e.handleMouseDown(t)},e.handleTouchMove=function(){e.dragging=!0},e.handleTouchStart=function(){e.dragging=!1},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e;if(this.props.option.label===y)return Object(a.a)(x,{});var t=this.props,n=t.option,r=t.instancePrefix,i=t.optionIndex,o=h()(g.menuOption,n.className,(e={},Object(b.a)(e,g.focused,this.props.isFocused),Object(b.a)(e,g.selected,this.props.isSelected),Object(b.a)(e,g.disabled,this.props.isDisabled||n.disabled),e));return n.disabled?Object(a.a)("div",{className:o,onMouseDown:this.blockEvent,onClick:this.blockEvent},void 0,this.props.children):Object(a.a)("div",{className:o,style:n.style,role:"option",onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,id:r+"-option-"+i,title:n.title},void 0,this.props.isSelected?Object(a.a)(_,{}):null,Object(a.a)("span",{},void 0,this.props.children))}},{key:"onFocus",value:function(e){this.props.isFocused||this.props.onFocus(this.props.option,e)}}]),t}(f.a.Component);function _(){return Object(a.a)("svg",{className:g.checkmark,viewBox:"0 0 18 15",width:12,height:10},void 0,Object(a.a)("polyline",{points:"1 7 6 12 17 1",strokeWidth:3}))}function x(){return Object(a.a)("hr",{className:g.separator})}n.d(t,"b",function(){return j}),n.d(t,"a",function(){return k});var j=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).apply(this,arguments))).saveRef=function(t){e.ref=t},e.handleCreate=function(t){if(e.props.creatable){var n=e.props.onCreate;e.createdOption=n(t)||t}},e.promptTextCreator=function(e){return Object(m.d)("「%(title)」を作る",{title:e})},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"focus",value:function(){this.ref.focus()}},{key:"componentDidMount",value:function(){var e=this;this.props.autoFocus&&requestAnimationFrame(function(){e.focus()})}},{key:"componentDidUpdate",value:function(e){if(this.props.creatable&&void 0!==this.createdOption&&this.props.value!==e.value){var t=this.createdOption,n=this.props.value;this.createdOption=void 0,(n===t||n===t.value||null!==n&&"object"===Object(i.a)(n)&&n.value===t.value||Array.isArray(n)&&n.some(function(e){return e===t||e.value===t.value}))&&this.ref.select.setValue(t)}}},{key:"render",value:function(){return this.props.creatable?f.a.createElement(v.a,Object(r.a)({autoBlur:!0},this.props,{onChange:this.props.onChange,onNewOptionClick:this.handleCreate,isValidNewOption:this.props.isValidNewOption,promptTextCreator:this.promptTextCreator,shouldKeyDownEventCreateNewOption:C,searchable:!0,autosize:!1,className:h()(g.select,this.props.transparent&&g.transparent),arrowRenderer:O,optionComponent:w,clearable:!1,ref:this.saveRef})):f.a.createElement(v.b,Object(r.a)({autoBlur:!0},this.props,{onChange:this.props.onChange,searchable:this.props.searchable||!1,autosize:!1,className:h()(g.select,this.props.transparent&&g.transparent),arrowRenderer:O,optionComponent:w,clearable:!1,ref:this.saveRef}))}}]),t}(f.a.Component);function O(e){return Object(a.a)("svg",{className:g.arrow,width:16,height:16,viewBox:"0 0 60 40",onMouseDown:e.onMouseDown},void 0,Object(a.a)("polyline",{points:"11 11 30 30 49 11",strokeWidth:10}))}function C(e){var t=e.key,n=e.keyCode;return void 0!==t?"Enter"===t:13===n}j.defaultProps={transparent:!1}},169:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var a=n(26),r=n(15);function i(e){var t=Object(r.a)(),n=Object(a.default)(e).locale(t),i=Object(a.default)();return n.isAfter(Object(a.default)(i).startOf("day"))?n.format("LT"):a.default.duration(Object(a.default)(i).diff(n),"ms").as("days")<=3?n.from(i):Object(a.default)(n).isBefore(Object(a.default)(i).startOf("year"))?n.format("LL"):"en"===t||"ko"===t?n.format("MMM Do"):n.format("MMMDo")}function o(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(r.a)();return Object(a.default)(e).locale(n).format(t?"LLL":"LL")}},171:function(e,t,n){"use strict";n.d(t,"a",function(){return y});var a=n(14),r=n(12),i=n(13),o=n(3),s=n.n(o),c=n(6),l=n(7),u=n(8),d=n(4),h=n.n(d),p=n(45),f=n.n(p),m=n(19),v=n(44),g=n.n(v),b=function(){function e(t,n){Object(l.a)(this,e),this.target=t,this.attached=n}return Object(u.a)(e,[{key:"unmount",value:function(){var e=Object(c.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f.a.unmountComponentAtNode(this.target),this.attached&&this.target.parentElement&&this.target.parentElement.removeChild(this.target),e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(e){var t=this;return null===e?this.unmount():new Promise(function(){var n=Object(c.a)(s.a.mark(function n(a,r){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.attached||t.target.parentElement){n.next=4;break}return n.next=3,m.h;case 3:document.body.appendChild(t.target);case 4:try{f.a.render(e,t.target,function(){a(t)})}catch(e){r(e)}case 5:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}())}}]),e}(),y=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(a.a)(this,Object(r.a)(t).apply(this,arguments))).state={target:null},e}return Object(i.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(c.a)(s.a.mark(function e(){var t,n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.props.id){e.next=19;break}return e.next=3,m.h;case 3:if(!(t=document.getElementById(this.props.id))){e.next=8;break}this.setState({target:t}),e.next=17;break;case 8:if(!this.props.createIfMissing){e.next=15;break}(n=document.createElement("div")).id=this.props.id,document.body.appendChild(n),this.setState({target:n}),e.next=17;break;case 15:if(this.props.allowMissing){e.next=17;break}throw new Error("Could not locate '#".concat(this.props.id,"' in the document"));case 17:e.next=24;break;case 19:return a=document.createElement("div"),e.next=22,m.h;case 22:document.body.appendChild(a),this.setState({target:a});case 24:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){g()(e.id===this.props.id&&e.allowMissing===this.props.allowMissing&&e.createIfMissing===this.props.createIfMissing,"A Portal's configuration cannot be changed once created")}},{key:"componentWillUnmount",value:function(){var e=Object(c.a)(s.a.mark(function e(){var t,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.noDispose,!(n=this.state.target)||t){e.next=6;break}return e.next=5,m.h;case 5:document.body.removeChild(n);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.target;return e?f.a.createPortal(this.props.children,e):null}}],[{key:"mount",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new b(document.createElement("div"),t).update(e)}}]),t}(h.a.Component);y.defaultProps={createIfMissing:!1,allowMissing:!1,noDispose:!1}},173:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(1),r=n(18),i=n.n(r),o=(n(4),n(274)),s=function(e){var t=e.white,n=e.size;return Object(a.a)("svg",{className:i()(o.crossIcon,t&&o.white),viewBox:"0 0 8 8",width:n,height:n},void 0,Object(a.a)("line",{x1:1,y1:1,x2:7,y2:7}),Object(a.a)("line",{x1:7,y1:1,x2:1,y2:7}))};s.defaultProps={white:!1,size:16}},174:function(e,t,n){"use strict";var a,r=n(11),i=n(36),o=n(93),s=n.n(o),c=n(102),l=n(37),u=n.n(l),d=n(32),h=n(266),p=n(20),f=n(140),m=n(178);function v(e){return{type:a.SET,payload:e}}!function(e){e.SET="Search/toolList/SET"}(a||(a={}));var g,b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(!e)return e;var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.SET:var n=t.payload;return e===n||e.length===n.length&&n.every(function(t,n){return Object(m.shallowEqual)(t,e[n])})?e:n.slice().map(function(e){return e.slice()})}return e}(e.toolList,t);return n!==e.toolList?Object(r.a)({},e,{toolList:n}):e},y=Object(d.createSelector)(function(e){return e.search},function(e){return e?e.toolList:void 0});function k(e){return{type:g.SetPopularSearchEnabled,payload:e}}n.d(t,"h",function(){return k}),n.d(t,"g",function(){return C}),n.d(t,"a",function(){return S}),n.d(t,"d",function(){return T}),n.d(t,"b",function(){return I}),n.d(t,"c",function(){return M}),n.d(t,"i",function(){return v}),n.d(t,"f",function(){return y}),(g||(g={})).SetPopularSearchEnabled="pixiv/Search/SET_POPULAR_SEARCH_ENABLED";t.e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=b(Object(f.e)(e,t),t);switch(t.type){case c.b:var a=t.payload.pathname;if(!a.match(w))break;var o=u.a.parse(t.payload.search,{ignoreQueryPrefix:!0}),s=a.match(_),l=a.match(x)?p.e.User:s?p.e.Novel:p.e.Illust,d=Object(h.b)(o,l);return d.bookmarkRange=Object(i.a)(n&&n.params.bookmarkRange,d.bookmarkRange),d.dateRange=Object(i.a)(n&&n.params.dateRange,d.dateRange),d.widthRange=Object(i.a)(n&&n.params.widthRange,d.widthRange),d.heightRange=Object(i.a)(n&&n.params.heightRange,d.heightRange),Object(i.a)(n,Object(r.a)({popularSearchEnabled:void 0},n,{searchType:l,params:Object(i.a)(n&&n.params,d)}));case g.SetPopularSearchEnabled:if(!n)throw new Error;return Object(r.a)({},n,{popularSearchEnabled:t.payload})}return n};var w=new RegExp([s()("/novel/tags.php"),s()("(/novel)?/search.php"),s()("/search_user.php")].map(function(e){return e.source}).join("|"),"i"),_=s()("/novel/(.*)"),x=s()("/search_user.php"),j=function(e){return e.search},O=Object(d.createSelector)(j,function(e){return e&&e.params}),C=Object(d.createSelector)(j,function(e){return e?e.popularSearchEnabled:void 0}),S=Object(d.createSelector)(O,C,function(e,t){return!e||void 0===t||t?e:e.order===p.c.DateAsc||e.order===p.c.DateDesc?e:Object(r.a)({},e,{order:p.c.DateDesc})}),T=Object(d.createSelector)(j,function(e){return e&&e.searchType}),I=Object(d.createSelector)(S,T,function(e,t){return null===e||null===t?"":t===p.e.Illust?"/search.php":t===p.e.Novel?e.target===p.d.Tag&&e.mode===p.b.Full?"/novel/tags.php":"/novel/search.php":"/search_user.php"}),M=Object(d.createSelector)(S,T,function(e,t){return null===e||null===t?"":u.a.stringify(Object(h.a)(e,t),{addQueryPrefix:!0})})},175:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return l});var a,r=n(32),i=n(36);function o(){var e=document.getElementById("meta-pixiv-tests"),t=JSON.parse(e&&e.content||"{}"),n=Object.keys(t);if(0===n.length)return{type:a.ReloadState,payload:{}};for(var r={},i=0;i<n.length;i++){var o=n[i];if("toggles"===o){r.toggle={};for(var s=Object.keys(t.toggles),c=0;c<s.length;c++){var l=s[c];r.toggle[l]=t.toggles[l]}}else"ab"in r||(r.ab={}),r.ab[o]=t[o]}return{type:a.ReloadState,payload:r}}!function(e){e.ReloadState="pixiv/test/RELOAD_STATE"}(a||(a={})),t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.ReloadState:return t.payload;default:Object(i.b)(t)}return e};var s=function(e){return e.test},c=Object(r.createSelector)(s,function(e,t){return t},function(e,t){return!!e.ab&&!!e.ab[t]}),l=Object(r.createSelector)(s,function(e,t){return t},function(e,t){return!!e.toggle&&!!e.toggle[t]})},177:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return s});var a,r=n(36);function i(e){return{type:a.SetTitle,payload:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"!=typeof document?document.title:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.SetTitle:return t.payload;default:Object(r.b)(t)}return e}function s(e){return e.subscribe(function(){var t=function(e){return e.title}(e.getState());t!==document.title&&(document.title=t)})}!function(e){e.SetTitle="pixiv/title/SET_TITLE"}(a||(a={}))},179:function(e,t,n){"use strict";n.r(t),n.d(t,"setup",function(){return l}),n.d(t,"show",function(){return u}),n.d(t,"hide",function(){return d});var a,r,i=n(11),o=n(0),s=n.n(o),c=n(2);function l(){if(a=s()("#ui-tooltip-container"),r=s()(".content",a),a.length){var e=s()(".wrapper",a);c.a.d.on("mousedown","._ui-tooltip",d).on("mouseleave","._ui-tooltip",d).on("mouseenter","._ui-tooltip",function(t){var n=s()(t.currentTarget),a=n.dataset(),r=a.tooltip||n.attr("title");r&&(e.attr("class","wrapper"),a.tooltipType&&e.addClass(a.tooltipType),u(n,r))})}}function u(e,t,n){"function"==typeof t?t(r):r.text(t),a.removeClass("_hidden"),c.a.ui.popupPosition(a,e,Object(i.a)({},n,{margin:3,nipple:".nipple",nippleMargin:3}))}function d(){a&&a.addClass("_hidden")}},189:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(7),r=n(8),i=n(16),o=n(0),s=n.n(o),c=n(2),l=n(25),u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(a.a)(this,e),Object(i.a)(this,"paused",!1),Object(i.a)(this,"completed",!1),this.options=n;var r=n.scrollContext=n.scrollContext&&s()(n.scrollContext);this.target=s()(t,r),n.enable?(window.setTimeout(this.on.bind(this)),this.active=!0):(!r&&!n.config&&(n.config=c.a.storage.config("autoView")),this.active=n.config?!!n.config("enabled"):!1!==n.active,this.active&&window.setTimeout(this.on.bind(this)))}return Object(r.a)(e,[{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.active&&!e||l.a.reset(this.target),this}},{key:"cancel",value:function(){return l.a.done(this.target),this}},{key:"on",value:function(){var e=this.options;return e.scrollContext&&(l.a.unwatch(e.scrollContext),l.a.watch(e.scrollContext)),l.a.reset(this.target),this.active=!0,e.config&&e.config("enabled",1),this.target.triggerHandler("autoViewOn"),this}},{key:"off",value:function(){var e=this.options;return l.a.unwatch(e.scrollContext),l.a.done(this.target),this.active=!1,e.config&&e.config("enabled",null),this.target.triggerHandler("autoViewOff"),this}},{key:"restart",value:function(){return this.active?(l.a.reset(this.target),this.paused=!1,this):this}},{key:"pause",value:function(){return l.a.done(this.target),this.paused=!0,this}},{key:"complete",value:function(){return this.completed=!0,this.target.triggerHandler("autoViewComplete"),this.options.scrollContext&&l.a.unwatch(this.options.scrollContext),this}}],[{key:"setup",value:function(){l.a.registerFilter("auto-view")}}]),e}()},19:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"h",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"f",function(){return h}),n.d(t,"d",function(){return p}),n.d(t,"e",function(){return f}),n.d(t,"i",function(){return m}),n.d(t,"b",function(){return v}),n.d(t,"c",function(){return g});var a=n(28),r=n(404),i=n.n(r),o=n(37),s=n.n(o),c=n(15);function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.replace(/-([a-z]|[0-9])/gi,function(e,t){return t.toUpperCase()});return t?n.charAt(0).toUpperCase()+n.slice(1):n}var u="undefined"!=typeof document?i()():Promise.resolve();function d(e,t){for(var n={appear:"".concat(e,"Appear"),appearActive:"".concat(e,"AppearActive"),enter:"".concat(e,"Enter"),enterActive:"".concat(e,"EnterActive"),exit:"".concat(e,"Exit"),exitActive:"".concat(e,"ExitActive")},r=Object.create(null),i=Object.entries(n),o=0;o<i.length;o++){var s=Object(a.a)(i[o],2),c=s[0],l=s[1];l in t&&(r[c]=t[l])}return r}function h(e){return"/login.php"+s.a.stringify({return_to:e},{addQueryPrefix:!0})}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(c.a)();return"undefined"!=typeof Intl&&Intl.NumberFormat?new Intl.NumberFormat(n,t).format(e):e.toLocaleString()}function f(e){var t="string"==typeof e?e:void 0;if("string"==typeof e)return i;for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return i.apply(void 0,[e].concat(a));function i(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return e.map(function(e,n){if(n>=a.length)return e;var r=a[n];return e.concat("number"==typeof r?p(r,void 0,t):r)}).join("")}}function m(e){throw new Error(0===arguments.length?"unreachable":"unreachable (".concat(JSON.stringify(e),")"))}function v(e){return"string"==typeof e?'url("'.concat(encodeURI(e),'")'):e||void 0}function g(e){if(void 0===e)throw new Error("Expected argument to be defined");return e}},2:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c});var a=n(9),r=(n(349),n(61)),i=(n(206),n(582),n(581),n(580),n(579),n(578),n(346),n(577),n(48)),o=(n(415),n(576),n(15)),s=a.default;s.storage={addExpires:i.a,cleanup:i.b,config:i.c,cookie:i.d,id:i.e,localStorage:i.f,object:i.g,off:i.h,on:i.i,one:i.j,parse:i.k,parseExpires:i.l,sessionStorage:i.m,storage:i.n,updateCookie:i.p},s.storeObject=i.o,s.t=o.d.bind(void 0),s.t.ord=o.c;var c=s.t;r.d(),e.colon=s}).call(this,n(77))},20:function(e,t,n){"use strict";var a,r,i,o,s;n.d(t,"e",function(){return a}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return s}),function(e){e.Illust="illust",e.Novel="novel",e.User="user"}(a||(a={})),function(e){e.Partial="partial",e.Full="full"}(r||(r={})),function(e){e.Tag="tag",e.TitleCaption="title/caption",e.TagTitleCaption="tag+title/caption",e.Description="description"}(i||(i={})),function(e){e.All="",e.Illust="illust",e.Manga="manga",e.Ugoira="ugoira"}(o||(o={})),function(e){e.DateDesc="date_d",e.DateAsc="date",e.PopularDesc="popular_d",e.PopularMaleDesc="popular_male_d",e.PopularFemaleDesc="popular_female_d"}(s||(s={}))},200:function(e,t,n){"use strict";n.d(t,"a",function(){return p}),n.d(t,"b",function(){return f});var a=n(1),r=n(7),i=n(8),o=n(14),s=n(12),c=n(13),l=n(4),u=n.n(l),d=u.a.createContext(void 0),h=d.Provider,p=d.Consumer,f=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(o.a)(this,Object(s.a)(t).apply(this,arguments))).listeners=new Set,e.handleKeyDown=function(t){if(!(e.state.disabled||t.isComposing||"Escape"!==t.key&&"Delete"!==t.key&&(t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLSelectElement))){var n=!0,a=!1,r=void 0;try{for(var i,o=e.listeners[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){(0,i.value)(t);0}}catch(e){a=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}}},e.addListener=function(t){e.listeners=new Set(e.listeners).add(t)},e.removeListener=function(t){var n=new Set(e.listeners);n.delete(t),e.listeners=n},e.state={context:{addListener:e.addListener,removeListener:e.removeListener},disabled:!1},e}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){document.body.addEventListener("keydown",this.handleKeyDown,!1)}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return Object(a.a)(h,{value:this.state.context},void 0,this.props.children)}}]),t}(u.a.Component)},201:function(e,t,n){"use strict";n.d(t,"b",function(){return _}),n.d(t,"a",function(){return j});var a=n(98),r=n(11),i=n(1),o=n(28),s=n(7),c=n(8),l=n(14),u=n(12),d=n(13),h=n(4),p=n.n(h),f=n(45),m=n.n(f),v=n(78),g=p.a.createContext(void 0),b=g.Provider,y=g.Consumer,k=document.documentElement,w=v.a?"":null,_=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).apply(this,arguments))).state={context:e.makeBaseContext(),modals:new Map},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.state.modals!==t.modals){var n=Array.from(this.state.modals.values()).some(function(e){return e.blocksScroll});k.style.overflowX=k.style.overflowY=n?"hidden":w;var a=!0,r=!1,i=void 0;try{for(var s,c=t.modals[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=Object(o.a)(s.value,2),u=l[0],d=l[1];if(!this.state.modals.has(u))try{var h=d.onDispose;h&&h()}finally{document.body.removeChild(d.portal)}}}catch(e){r=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}}}},{key:"componentWillUnmount",value:function(){Array.from(this.state.modals.values()).some(function(e){return e.blocksScroll})&&(k.style.overflowX=k.style.overflowY=w);var e=!0,t=!1,n=void 0;try{for(var a,r=this.state.modals.values()[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var i=a.value.portal;document.body.removeChild(i)}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"render",value:function(){return Object(i.a)(b,{value:this.state.context},void 0,this.props.children)}},{key:"getModal",value:function(e,t){var n=this.state.modals.get(e);if(void 0!==n)return n;var a=document.body.appendChild(document.createElement("div"));a.setAttribute("role","presentation");var i=Object(r.a)({},t,{portal:a});return this.setState(function(t){return{modals:new Map(t.modals).set(e,i)}}),i}},{key:"makeBaseContext",value:function(){var e=this;return{getModal:function(t,n){return e.getModal(t,n)},close:function(t){e.state.modals.has(t)&&e.setState(function(e){var n=new Map(e.modals);return n.delete(t),{modals:n}})},closeAll:function(){e.setState({modals:new Map})}}}}]),t}(p.a.Component),x=1,j=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).uniqueId="_modal".concat(x++),n.renderConsumer=function(e){if(void 0===e)throw new Error("Modal used outside of a ModalProvider context");return Object(i.a)(O,{id:n.uniqueId,show:n.props.show,onDispose:n.props.onDispose,close:e.close,closeAll:e.closeAll,getModal:e.getModal},void 0,n.props.children)},Object.defineProperty(Object(a.a)(Object(a.a)(n)),"uniqueId",{writable:!1,configurable:!1}),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return Object(i.a)(y,{},void 0,this.renderConsumer)}}]),t}(p.a.Component),O=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).apply(this,arguments))).state={modal:null},e.handleDispose=function(){var t=e.props.onDispose;t&&t()},e.modalConfig={onDispose:e.handleDispose,blocksScroll:!0},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){if(this.props.show){var e=this.props.getModal(this.props.id,this.modalConfig);this.setState({modal:e})}}},{key:"componentDidUpdate",value:function(e){if(this.props.show&&null===this.state.modal){var t=this.props.getModal(this.props.id,this.modalConfig);this.setState({modal:t})}e.show&&!this.props.show&&null!==this.state.modal&&(this.props.close(this.props.id),this.setState({modal:null}))}},{key:"componentWillUnmount",value:function(){this.props.close(this.props.id)}},{key:"render",value:function(){return null!==this.state.modal&&this.props.show?m.a.createPortal(this.props.children,this.state.modal.portal):null}}]),t}(p.a.Component)},202:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return p}),n.d(t,"d",function(){return f}),n.d(t,"c",function(){return m});var a,r=n(11),i=n(28),o=n(3),s=n.n(o),c=n(6),l=n(63),u=n(121);!function(e){e.SuccessFetchItemGroupDetails="SUCCESS_FETCH_ITEMGROUP_DETAILS",e.ItemGroupDetailReloaded="ITEM_GROUP_DETAIL_RELOADED",e.StartFetchGoodsUnlink="START_FETCH_GOODS_UNLINK",e.SuccessFetchGoodsUnlink="SUCCESS_FETCH_GOODS_UNLINK",e.SuccessEditItemSelling="SUCCESS_EDIT_ITEM_SELLING"}(a||(a={}));var d=function(e){return{type:a.SuccessFetchItemGroupDetails,payload:e}},h=function(e){return{type:a.ItemGroupDetailReloaded,payload:e}},p=function(e,t,n){return function(){var a=Object(c.a)(s.a.mark(function a(r,i){var o,c,d,p,f;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=Object(l.b)(i()),a.next=3,u.d(o,e,t);case 3:return c=a.sent,a.next=6,u.c([c.pixivItemUID]);case 6:if(d=a.sent,p={pixivItemUID:d[0].pixivItemUID,isSelling:!0,itemGroup:d[0].itemGroup},!n.removingItemUID){a.next=13;break}return f=Object(l.b)(i()),a.next=12,u.f(f,n.removingItemUID);case 12:a.sent;case 13:r(h(p));case 14:case"end":return a.stop()}},a,this)}));return function(e,t){return a.apply(this,arguments)}}()},f=function(e){return function(){var t=Object(c.a)(s.a.mark(function t(n){var a,o,c,l,h,p;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([u.c(e.map(function(e){return e.pixivItemUID})),u.b()]);case 2:a=t.sent,o=Object(i.a)(a,2),c=o[0],l=o[1],h=e.map(function(e){return Object(r.a)({},e,{itemGroup:(c.find(function(t){return t.pixivItemUID===e.pixivItemUID})||{}).itemGroup})}),p=l.map(function(e){var t=h.find(function(t){return!!t.itemGroup&&t.itemGroup.product.id===e.id});return{product:e,goods:t}}),n(d(p));case 9:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},m=function(e,t){return function(){var n=Object(c.a)(s.a.mark(function n(a,r){var i,o;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=Object(l.b)(r()),n.next=3,u.e(i,e,t);case 3:o=n.sent,a(v(e,o.isSelling));case 5:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}()},v=function(e,t){return{type:a.SuccessEditItemSelling,payload:{pixivItemUID:e,newSellingState:t}}}},205:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return d});var a=n(11),r=n(2),i=n(0),o=n.n(i),s=n(10),c=/^lang=(.+)$/,l=r.a.logger("api-patch");o.a.ajaxPrefilter(function(e){if("script"!==e.dataType){if(e.crossDomain){if(!e.pixivApi)return;e.pixivApi=void 0;var t=e.url,n=window.location.origin;if(t.startsWith("https:")&&!t.startsWith(n.replace(/^http:/,"https:")))return}if(""!==window.location.search){var i=window.location.search.substr(1),l=!0,u=!1,d=void 0;try{for(var h,p=i.split("&")[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var f=h.value.match(c);if(null!==f){if("undefined"!=typeof FormData&&e.data instanceof FormData)e.data.append("lang",f[1]);else if("GET"!==e.type&&"HEAD"!==e.type&&"string"==typeof e.data)try{JSON.parse(e.data)}catch(t){e.data=o.a.param(Object(a.a)({},r.a.query.parse(e.data),{lang:f[1]}))}else e.data=o.a.param(Object(a.a)({},"string"==typeof e.data?r.a.query.parse(e.data):e.data,{lang:f[1]}));break}}}catch(e){u=!0,d=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw d}}}if(s.default.context.token)if("undefined"!=typeof FormData&&e.data instanceof FormData)e.data.append("tt",s.default.context.token);else if(e.type&&"GET"!==e.type.toUpperCase()&&"string"==typeof e.data)try{e.data=JSON.stringify(Object(a.a)({},JSON.parse(e.data),{tt:s.default.context.token})),e.contentType="application/json; charset=UTF-8"}catch(t){e.data=o.a.param(Object(a.a)({},r.a.query.parse(e.data),{tt:s.default.context.token}))}else e.data=o.a.param(Object(a.a)({},"string"==typeof e.data?r.a.query.parse(e.data):e.data,{tt:s.default.context.token}))}});var u=!1;function d(t,n){var r=n.secure,i=t;if(!u&&(void 0===r||r)){var o=new URL(i,window.location.href);if("http:"===o.protocol&&i.startsWith("http:")&&(l.warn("Hardcoded http: request without {secure: false} in options: ".concat(i)),l.trace()),"https:"!==o.protocol&&o.origin===window.location.origin){o.protocol="https:",e.hot||window.location.port?l.info("Would have rewritten ".concat(i," to ").concat(o.toString())):i=o.toString();var s=n.ajaxSettings,c=void 0===s?{}:s,d=c.xhrFields,h=void 0===d?{}:d;!1!==h.withCredentials&&(n.ajaxSettings=Object(a.a)({},c,{xhrFields:Object(a.a)({},h,{withCredentials:!0}),pixivApi:!0}))}}return i}}).call(this,n(212)(e))},206:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return l});var a=n(9),r=n(0),i=n.n(r);i.a.fn.boxHeight=function(){var e=[],t=0,n=0;return this.each(function(){var a=i()(this);a.position().top!==t&&(e.length>1&&i()(e).height(n),e=[],n=0,t=a.position().top),e.push(this),n=Math.max(a.height(),n)}),e.length>1&&i()(e).height(n),this},i.a.fn.getId=function(e){var t=e||/(\d+)/,n=this.attr("id");if(!n)return null;var a=(t.exec(n)||[]).slice(1);return(a.length>1?a:a[0])||null},i.a.fn.selectbox=function(e){var t=e||{};return this.each(function(){var e=i()(this),n=t.current||i()("div.current",this),a=t.item_container||i()("ul.items",this),r=i()("li",a),o=t.default_item||r.filter(".current"),s=t.callback,c=!1;e.hover(function(){c||(r.each(function(){var t=i()(this).on("click",function(a){return!t.hasClass("current")&&(o.removeClass("current"),o=t.addClass("current"),n.text(o.text()),e.mouseleave(),s?s.call(this,a):void 0)})}),c=!0),a.show()},function(){a.hide()})})},i.a.fn.urlLink=i.a.fn.urlAutoLink=function(){return this.each(function(){this.innerHTML=c(this.innerHTML)})},i.a.fn.hashTagLink=i.a.fn.hashTagAutoLink=function(){return this.each(function(){this.innerHTML=l(this.innerHTML)})};var o=new RegExp("https?://[^/@\\s]+\\.([,.]?[-_!~*a-zA-Z0-9;/?:&=+$%#])+","g"),s=/(^|[^a-zA-Z0-9])(#[a-zA-Z0-9_]*[a-zA-Z_]+[a-zA-Z0-9_]*)/g;function c(e){return e.replace(o,function(e){return'<a href="'+a.default.html.escape(function(e){return/^https?:\/\/[0-9A-Za-z-]+\.pixiv\.net(?:\/|$)/.test(e)?encodeURI(e):"/jump.php?"+encodeURIComponent(e)}(a.default.html.unescape(e)))+'" target="_blank">'+e+"</a>"})}function l(e){return e.replace(s,function(e,t,n){var r=encodeURIComponent(a.default.html.unescape(n));return t+'<a href="http://twitter.com/search?q='+(r=a.default.html.escape(r))+'" target="_blank">'+n+"</a>"})}},207:function(e,t,n){"use strict";n.r(t),n.d(t,"ie",function(){return r}),n.d(t,"v",function(){return i}),n.d(t,"firefox",function(){return o}),n.d(t,"chrome",function(){return s}),n.d(t,"safari",function(){return c}),n.d(t,"webkit",function(){return l});var a=navigator.userAgent.toLowerCase(),r=/(?:msie|trident)/.test(a),i=r?+(/(?:msie|rv:?)\s?([\d.]+)/.exec(a)||[])[1]:void 0,o=!r&&/firefox/.test(a),s=!r&&!o&&/chrome/.test(a),c=!r&&!o&&!s&&/safari/.test(a),l=c||s},208:function(e,t,n){e.exports={usersContainer:"mKJU29E",carousel:"_3eFa8qi",itemEnter:"_1KQg_7r",itemEnterActive:"_2Yedmhk","slide-in":"_1j8Qt1n",itemExit:"_3bP2aAb",itemExitActive:"yNVDzFA"}},209:function(e,t,n){e.exports={header:"_2u372qC",title:"zmS5eGM",closeButton:"_2vIgooZ"}},21:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u});var a=n(2),r=n(0),i=n.n(r),o=n(50),s=n(205);var c=function(e){return function(t,n,r){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=Object(s.a)(t,r);return r.filter=function(e,t){if(e&&!e.error){for(var n=arguments.length,a=new Array(n>2?n-2:0),r=2;r<n;r++)a[r-2]=arguments[r];return i.a.Deferred().resolveWith(this,[e,t].concat(a))}return i.a.Deferred().rejectWith(this,[e,t,e&&(e.message||e.error)])},a.a.req.to(e,c,n,r).fail(function(t){if(0===t.readyState){var a="";if("mode"in n&&"string"==typeof n.mode)a="mode=".concat(n.mode);else if(Array.isArray(n)){var r=n.find(function(e){return"mode"===e.name});r&&(a="mode=".concat(r.value))}else if("undefined"!=typeof FormData&&n instanceof FormData)if(Symbol.iterator in n){var s=new Map(n).get("mode");s&&(a="mode=".concat(s))}else a="opaque FormData";setTimeout(function(){throw new o.c(e,c,t.status,a)})}for(var l=arguments.length,u=new Array(l>1?l-1:0),d=1;d<l;d++)u[d-1]=arguments[d];return i.a.Deferred().rejectWith(this,[t].concat(u))})}(e,t,n,r)}},l=c("GET"),u=c("POST")},210:function(e,t,n){e.exports={strokedSymbol:"i64s6Ml",filledSymbol:"_1jbE1yA",backgroundCircle:"Q5hrJWC i64s6Ml"}},213:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var a=n(78);function r(e,t){a.b()&&localStorage.setItem(e,JSON.stringify(t))}function i(e){if(a.b()){var t=localStorage.getItem(e);if(null!==t)return JSON.parse(t)}}},23:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return u});var a=n(52),r=n(211),i=n.n(r),o=n(207);i.a.setDefaultLevel(3),function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.methodFactory;e.methodFactory=function(e,r,i){var o=this,s=n(e,r,i),c=[null!=i?"[".concat(i,"]"):null].filter(function(e){return null!==e});return t?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];s.apply(o,[(new Date).toTimeString().slice(0,8)].concat(Object(a.a)(c),t))}:s.bind.apply(s,[this].concat(Object(a.a)(c)))},e.setLevel(e.getLevel(),!1)}(i.a,o.safari);var s=new Map,c=u("colon.log"),l=c.debug;function u(e,t){if(!e)return c;var n=s.get(e);if(n)return n;var a=i.a.getLogger(e);return(t||0===t)&&a.setDefaultLevel(t),s.set(e,a),a}},231:function(e,t,n){"use strict";(function(e){!e.hot&&window.bundle_public_path&&(n.p=window.bundle_public_path);n.p}).call(this,n(212)(e))},232:function(e,t){
/*
  @author: remy sharp / http://remysharp.com
  @params:
    feedback - the selector for the element that gives the user feedback. Note that this will be relative to the form the plugin is run against.
    hardLimit - whether to stop the user being able to keep adding characters. Defaults to true.
    useInput - whether to look for a hidden input named 'maxlength' instead of the maxlength attribute. Defaults to false.
    words - limit by characters or words, set this to true to limit by words. Defaults to false.
  @license: Creative Commons License - ShareAlike http://creativecommons.org/licenses/by-sa/3.0/
  @version: 1.2
  @changes: code tidy via Ariel Flesler and fix when pasting over limit and including \t or \n
*/
!function(e){e.fn.maxlength=function(t){function n(e){var n=e.value;return t.words&&(n=e.value.length?n.split(/\s+/):{length:0}),n.length}return"string"==typeof t&&(t={feedback:t}),t=e.extend({},e.fn.maxlength.defaults,t),this.each(function(){var a=this,r=e(a),i=e(a.form),o=t.useInput?i.find("input[name=maxlength]").val():r.attr("maxlength"),s=i.find(t.feedback);var c=function(){var e=n(a);s.html(e||"0"),t.hardLimit&&e<0&&(a.value=t.words?a.value.split(/(\s+)/,2*o-1).join(""):a.value.substr(0,o),c())};r.keyup(c).change(c),t.hardLimit&&r.keydown(function(e){var a=n(this),r=a>=o,i=e.keyCode;if(r)switch(i){case 8:case 9:case 17:case 36:case 35:case 37:case 38:case 39:case 40:case 46:case 65:return;default:return t.words&&32!=i&&13!=i&&a==o}}),c()})},e.fn.maxlength.defaults={useInput:!1,hardLimit:!0,feedback:".charsLeft",words:!1}}(jQuery)},233:function(e,t){!function(e){var t,n=e.fn.domManip,a="_tmplitem",r=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,i={},o={},s={key:0,data:{}},c=0,l=0,u=[];function d(t,n,a,r){var s={data:r||0===r||!1===r?r:n?n.data:{},_wrap:n?n._wrap:null,tmpl:null,parent:n||null,nodes:[],calls:b,nest:y,wrap:k,html:w,update:_};return t&&e.extend(s,t,{nodes:[],parent:n}),a&&(s.tmpl=a,s._ctnt=s._ctnt||s.tmpl(e,s),s.key=++c,(u.length?o:i)[c]=s),s}function h(t,n,r){var i,o=r?e.map(r,function(e){return"string"==typeof e?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+a+'="'+t.key+'" $2'):e:h(e,t,e._ctnt)}):t;return n?o:((o=o.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,n,a,r){g(i=e(a).get()),n&&(i=p(n).concat(i)),r&&(i=i.concat(p(r)))}),i||p(o))}function p(t){var n=document.createElement("div");return n.innerHTML=t,e.makeArray(n.childNodes)}function f(t){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+e.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,n,a,r,i,o,s){var c,l,u,d=e.tmpl.tag[a];if(!d)throw"Unknown template tag: "+a;return c=d._default||[],o&&!/\w$/.test(i)&&(i+=o,o=""),i?(i=v(i),s=s?","+v(s)+")":o?")":"",l=o?i.indexOf(".")>-1?i+v(o):"("+i+").call($item"+s:i,u=o?l:"(typeof("+i+")==='function'?("+i+").call($item):("+i+"))"):u=l=c.$1||"null",r=v(r),"');"+d[n?"close":"open"].split("$notnull_1").join(i?"typeof("+i+")!=='undefined' && ("+i+")!=null":"true").split("$1a").join(u).split("$1").join(l).split("$2").join(r||c.$2||"")+"__.push('"})+"');}return __;")}function m(t,n){t._wrap=h(t,!0,e.isArray(n)?n:[r.test(n)?n:e(n).html()]).join("")}function v(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function g(t){var n,r,s,u,h,p="_"+l,f={};for(s=0,u=t.length;s<u;s++)if(1===(n=t[s]).nodeType){for(h=(r=n.getElementsByTagName("*")).length-1;h>=0;h--)m(r[h]);m(n)}function m(t){var n,r,s,u,h=t;if(u=t.getAttribute(a)){for(;h.parentNode&&1===(h=h.parentNode).nodeType&&!(n=h.getAttribute(a)););n!==u&&(h=h.parentNode?11===h.nodeType?0:h.getAttribute(a)||0:0,(s=i[u])||((s=d(s=o[u],i[h]||o[h])).key=++c,i[c]=s),l&&m(u)),t.removeAttribute(a)}else l&&(s=e.data(t,"tmplItem"))&&(m(s.key),i[s.key]=s,h=(h=e.data(t.parentNode,"tmplItem"))?h.key:0);if(s){for(r=s;r&&r.key!=h;)r.nodes.push(t),r=r.parent;delete s._ctnt,delete s._wrap,e.data(t,"tmplItem",s)}function m(e){s=f[e+=p]=f[e]||d(s,i[s.parent.key+p]||s.parent)}}}function b(e,t,n,a){if(!e)return u.pop();u.push({_:e,tmpl:t,item:this,data:n,options:a})}function y(t,n,a){return e.tmpl(e.template(t),n,a,this)}function k(t,n){var a=t.options||{};return a.wrapped=n,e.tmpl(e.template(t.tmpl),t.data,a,t.item)}function w(t,n){var a=this._wrap;return e.map(e(e.isArray(a)?a.join(""):a).filter(t||"*"),function(e){return n?e.innerText||e.textContent:e.outerHTML||function(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}(e)})}function _(){var t=this.nodes;e.tmpl(null,null,null,this).insertBefore(t[0]),e(t).remove()}e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(n,a){e.fn[n]=function(r){var o,s,c,u,d=[],h=e(r),p=1===this.length&&this[0].parentNode;if(t=i||{},p&&11===p.nodeType&&1===p.childNodes.length&&1===h.length)h[a](this[0]),d=this;else{for(s=0,c=h.length;s<c;s++)l=s,o=(s>0?this.clone(!0):this).get(),e(h[s])[a](o),d=d.concat(o);l=0,d=this.pushStack(d,n,h.selector)}return u=t,t=null,e.tmpl.complete(u),d}}),e.fn.extend({tmpl:function(t,n,a){return e.tmpl(this[0],t,n,a)},tmplItem:function(){return e.tmplItem(this[0])},template:function(t){return e.template(t,this[0])},domManip:function(a,r,o){if(a[0]&&e.isArray(a[0])){for(var s,c=e.makeArray(arguments),u=a[0],d=u.length,h=0;h<d&&!(s=e.data(u[h++],"tmplItem")););s&&l&&(c[2]=function(t){e.tmpl.afterManip(this,t,o)}),n.apply(this,c)}else n.apply(this,arguments);return l=0,!t&&e.tmpl.complete(i),this}}),e.extend({tmpl:function(t,n,a,r){var c,l=!r;if(l)r=s,t=e.template[t]||e.template(null,t),o={};else if(!t)return t=r.tmpl,i[r.key]=r,r.nodes=[],r.wrapped&&m(r,r.wrapped),e(h(r,null,r.tmpl(e,r)));return t?("function"==typeof n&&(n=n.call(r||{})),a&&a.wrapped&&m(a,a.wrapped),c=e.isArray(n)?e.map(n,function(e){return e?d(a,r,t,e):null}):[d(a,r,t,n)],l?e(h(r,null,c)):c):[]},tmplItem:function(t){var n;for(t instanceof e&&(t=t[0]);t&&1===t.nodeType&&!(n=e.data(t,"tmplItem"))&&(t=t.parentNode););return n||s},template:function(t,n){return n?("string"==typeof n?n=f(n):n instanceof e&&(n=n[0]||{}),n.nodeType&&(n=e.data(n,"tmpl")||e.data(n,"tmpl",f(n.innerHTML))),"string"==typeof t?e.template[t]=n:n):t?"string"!=typeof t?e.template(null,t):e.template[t]||e.template(null,r.test(t)?t:e(t)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),e.extend(e.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){i={}},afterManip:function(t,n,a){var r=11===n.nodeType?e.makeArray(n.childNodes):1===n.nodeType?[n]:[];a.call(t,n),g(r),l++}})}(jQuery)},234:function(e,t){jQuery.cookie=function(e,t,n){if(void 0===t){var a=null;if(document.cookie&&""!=document.cookie)for(var r=document.cookie.split(";"),i=0;i<r.length;i++){var o=jQuery.trim(r[i]);if(o.substring(0,e.length+1)==e+"="){a=decodeURIComponent(o.substring(e.length+1));break}}return a}n=n||{},null===t&&(t="",n.expires=-1);var s,c="";n.expires&&("number"==typeof n.expires||n.expires.toUTCString)&&("number"==typeof n.expires?(s=new Date).setTime(s.getTime()+24*n.expires*60*60*1e3):s=n.expires,c="; expires="+s.toUTCString());var l=n.path?"; path="+n.path:"",u=n.domain?"; domain="+n.domain:"",d=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),c,l,u,d].join("")}},24:function(e,t,n){"use strict";n.d(t,"b",function(){return p});var a=n(7),r=n(8),i=n(14),o=n(12),s=n(13),c=n(4),l=n.n(c),u=n(285),d=n.n(u),h=n(27);function p(e){return d()({loader:e,loading:f})}n.d(t,"a",function(){return h.a});var f=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props;return e.error&&setTimeout(function(){throw e.error}),null}}]),t}(l.a.Component)},25:function(e,t,n){"use strict";n.d(t,"b",function(){return d});var a=n(0),r=n.n(a),i=n(2),o=n(82),s=n(10),c=n(19),l=n(104),u=n(54);function d(){Object(o.b)(),o.a.registerFilter("lazy-image",function(e){var t=e.dataset("src");t&&"IMG"===e[0].nodeName?e.attr("src")!==t&&e.attr("src",t).on("load",function(e){r()(e.currentTarget).css("opacity",1)}):e.css("background-image",Object(c.b)(t)||"")});var e=l.c();o.a.registerFilter("thumbnail-filter",function(t){if(s.default.user.loggedIn&&"IMG"===t[0].nodeName){var n=t.dataset();if(void 0!==n.tags&&void 0!==n.userId&&n.userId!==s.default.user.id){var a={userId:n.userId,tags:i.a.ui.Tag.split(n.tags)};e(t);var o={mute:l.d};if(u.f(o)){var c=t.closest("a").removeClass("muted-thumbnail");if(u.h(o,a)){var d=r()(".thumbnail-filter-items",c);d.length?d.empty():d=r()('<ul class="thumbnail-filter-items"></ul>').insertBefore(t);var h=r()(document.createElement("li"));return h.addClass("negative"),h.text(i.a.t("ミュート中")),d.append(h),c.addClass("muted-thumbnail"),t.attr("src",t.dataset("srcFiltered")||"".concat(s.default.sourcePath,"images/filtered.png?1")).css("opacity",1),t.closest(".image-item, .rank-detail, .ranking-item, ._novel-item").addClass("muted"),!0}r()(".thumbnail-filter-items",c).remove(),t.closest(".image-item, .rank-detail, .ranking-item, ._novel-item").removeClass("muted")}}}})}n.d(t,"a",function(){return o.a})},264:function(e,t,n){"use strict";n.r(t),function(e){n(737);var t=n(277),a=n.n(t),r=n(409),i=n.n(r),o=n(408),s=n.n(o);e.$=e.jQuery=a.a,e.Handlebars=i.a,a.a.uiBackCompat=!1,s.a.cfg.lazyClass="js-lazyload"}.call(this,n(77))},265:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var a=n(41),r=function(e,t,n){return a.a("/rpc/index.php",{mode:"get_recommend_users_and_works",user_id:"".concat(e),user_num:"".concat(t),work_num:"".concat(n)})},i=function(e,t,n){return a.a("/rpc/index.php",{mode:"get_recommend_users_and_works_by_user_ids",user_ids:"".concat(e),user_num:"".concat(t),work_num:"".concat(n)},{cache:!1})}},266:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"a",function(){return d});var a=n(11),r=n(26),i=n(103),o=n(19),s=n(20),c={illustType:s.a.All,order:s.c.DateDesc,tool:"",aspectRatio:null,adultMode:i.a.All};function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.e.Illust;return{word:(t===s.e.User?e.nick:t===s.e.Novel&&void 0===e.s_mode?e.tag:e.word)||"",page:e.p&&parseInt(e.p,10)||1,adultMode:"r18"===e.mode?i.a.R18:"safe"===e.mode?i.a.Safe:i.a.All,aspectRatio:void 0!==e.ratio?parseFloat(e.ratio):null,dateRange:[e.scd?Object(r.default)(e.scd,"YYYY-MM-DD").utcOffset(9).toISOString():null,e.ecd?Object(r.default)(e.ecd,"YYYY-MM-DD").utcOffset(9).toISOString():null],bookmarkRange:[void 0!==e.blt&&"*"!==e.blt?parseInt(e.blt,10):null,void 0!==e.bgt&&"*"!==e.bgt?parseInt(e.bgt,10):null],widthRange:[void 0!==e.wlt&&"*"!==e.wlt?parseInt(e.wlt,10):null,void 0!==e.wgt&&"*"!==e.wgt?parseInt(e.wgt,10):null],heightRange:[void 0!==e.hlt&&"*"!==e.hlt?parseInt(e.hlt,10):null,void 0!==e.hgt&&"*"!==e.hgt?parseInt(e.hgt,10):null],illustType:"illust"===e.type?s.a.Illust:"manga"===e.type?s.a.Manga:"ugoira"===e.type?s.a.Ugoira:s.a.All,mode:t===s.e.User?e.nick_mf&&"0"!==e.nick_mf?s.b.Full:s.b.Partial:t===s.e.Illust&&"s_tag_tc"===e.s_mode?s.b.Partial:"s_tag_full"===e.s_mode||t===s.e.Novel&&void 0===e.s_mode?s.b.Full:s.b.Partial,order:"popular_d"===e.order?s.c.PopularDesc:"popular_male_d"===e.order?s.c.PopularMaleDesc:"popular_female_d"===e.order?s.c.PopularFemaleDesc:"date"===e.order?s.c.DateAsc:s.c.DateDesc,target:t===s.e.User||"s_tc"===e.s_mode?s.d.TitleCaption:t===s.e.Novel&&"s_tag"===e.s_mode?s.d.Description:t===s.e.Illust&&"s_tag_tc"===e.s_mode?s.d.TagTitleCaption:s.d.Tag,tool:e.tool||"",posterUser:t===s.e.User&&(!e.i||"0"!==e.i)}}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.e.Illust;switch(n){case s.e.Illust:return t===s.d.TitleCaption?"s_tc":t===s.d.TagTitleCaption?"s_tag_tc":e===s.b.Full?"s_tag_full":e===s.b.Partial?"s_tag":Object(o.i)(e);case s.e.Novel:return t===s.d.TitleCaption||t===s.d.TagTitleCaption?"s_tc":t===s.d.Description?"s_tag":t===s.d.Tag?"":Object(o.i)(t);case s.e.User:return e===s.b.Full?"1":e===s.b.Partial?"0":Object(o.i)(e)}return Object(o.i)(n)}function d(e,t){var n={};if(t===s.e.User)n.s_mode="s_usr",n.nick=e.word,n.nick_mf=e.mode===s.b.Full?"1":void 0,n.i=e.posterUser?void 0:"0";else if(t===s.e.Novel&&e.target===s.d.Tag&&e.mode===s.b.Full)n.tag=e.word;else{var l=u(e.mode,e.target,t);n.s_mode=t===s.e.Illust&&"s_tag"===l?void 0:l,n.word=e.word}var d=t===s.e.User?void 0:{type:t!==s.e.Illust||e.illustType===c.illustType?void 0:function(e){return e===s.a.All?"":e===s.a.Illust?"illust":e===s.a.Manga?"manga":e===s.a.Ugoira?"ugoira":Object(o.i)(e)}(e.illustType),order:e.order===c.order?void 0:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e===s.c.DateAsc?"date":e===s.c.DateDesc?"date_d":t?e===s.c.PopularDesc?"popular_d":e===s.c.PopularFemaleDesc?"popular_female_d":e===s.c.PopularMaleDesc?"popular_male_d":Object(o.i)(e):"date_d"}(e.order,!0),scd:null!==e.dateRange[0]?Object(r.default)(e.dateRange[0]).utcOffset(9).format("YYYY-MM-DD"):void 0,ecd:null!==e.dateRange[1]?Object(r.default)(e.dateRange[1]).utcOffset(9).format("YYYY-MM-DD"):void 0,wlt:null!==e.widthRange[0]?e.widthRange[0].toString():void 0,wgt:null!==e.widthRange[1]?e.widthRange[1].toString():void 0,hlt:null!==e.heightRange[0]?e.heightRange[0].toString():void 0,hgt:null!==e.heightRange[1]?e.heightRange[1].toString():void 0,blt:null!==e.bookmarkRange[0]?e.bookmarkRange[0].toString():void 0,bgt:null!==e.bookmarkRange[1]?e.bookmarkRange[1].toString():void 0,tool:e.tool===c.tool?void 0:e.tool,ratio:null!==e.aspectRatio&&e.aspectRatio!==c.aspectRatio?e.aspectRatio.toString():void 0,mode:e.adultMode===c.adultMode||e.adultMode===i.a.All?void 0:e.adultMode===i.a.R18?"r18":e.adultMode===i.a.Safe?"safe":Object(o.i)(e.adultMode)};return Object(a.a)({},n,d,{p:e.page>1?e.page.toString():void 0})}},267:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var a=n(1),r=n(16),i=n(7),o=n(8),s=n(14),c=n(12),l=n(13),u=n(18),d=n.n(u),h=n(26),p=n(4),f=n.n(p),m=n(19),v=n(169),g=n(83),b=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.item,i=t.highlight,o=t.isNew;return Object(a.a)("li",{className:d()(g.item,(e={},Object(r.a)(e,g.unread,n.unread),Object(r.a)(e,g.highlight,i),Object(r.a)(e,g.new,o),e))},void 0,Object(a.a)("a",{className:g.link,href:n.linkUrl,target:n.targetBlank?"_blank":void 0},void 0,Object(a.a)("div",{className:d()(g.icon,Object(r.a)({},g.profile,n.isProfileIcon)),style:{backgroundImage:Object(m.b)(n.iconUrl)}}),Object(a.a)("div",{className:g.contentContainer},void 0,Object(a.a)("div",{className:g.content,dangerouslySetInnerHTML:{__html:n.content}}),o&&Object(a.a)("p",{className:g.date},void 0,Object(v.b)(Object(h.default)(n.notifiedAt,h.default.ISO_8601))))))}}]),t}(f.a.Component)},27:function(e,t,n){"use strict";var a=n(171),r=n(7),i=n(8),o=n(14),s=n(12),c=n(13),l=n(44),u=n.n(l),d=n(4),h=n.n(d),p=n(45),f=n.n(p),m=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(o.a)(this,Object(s.a)(t).apply(this,arguments))).state={target:void 0!==e.props.id?e.getTarget(e.props.id):null,targets:void 0!==e.props.class?e.getTargets(e.props.class):null},e}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){u()(e.class===this.props.class&&e.id===this.props.id&&e.optional===this.props.optional,"MountOn: cannot change configuration after creation")}},{key:"render",value:function(){var e=this.props.children,t=this.state,n=t.target,a=t.targets;return a?a.map(function(t,n){var a="function"==typeof e?e(t,n):e;return f.a.createPortal(a,t)}):n?f.a.createPortal(this.props.children,n):null}},{key:"getTargets",value:function(e){var t=Array.from(document.getElementsByClassName(e));if(!this.props.optional&&0===t.length)throw new Error("Could not locate .".concat(this.props.class," elements"));return t}},{key:"getTarget",value:function(e){var t=document.getElementById(e);if(!this.props.optional&&null===t)throw new Error("Could not locate #".concat(this.props.id," element"));return t}}]),t}(h.a.Component);m.defaultProps={optional:!1};var v=n(58),g=n(299),b=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(o.a)(this,Object(s.a)(t).apply(this,arguments))).renderChild=function(t){var n=e.props,a=n.component,r=n.render,i=n.children,o=a;if(null===t.match&&(o||r))return null;var s=void 0!==e.props.id?{id:e.props.id,optional:e.props.optional}:{class:e.props.class,optional:e.props.optional};if(o)return h.a.createElement(m,s,h.a.createElement(o,t));if(r)return h.a.createElement(m,Object(v.a)({},s,{children:r(t)}));var c="function"==typeof i?void 0!==e.props.class?function(e,n){return i(t,n)}:i(t):0===h.a.Children.count(i)?null:h.a.Children.only(i);return h.a.createElement(m,Object(v.a)({},s,{children:c}))},e}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e={exact:this.props.exact,location:this.props.location,path:this.props.path,strict:this.props.strict};return h.a.createElement(g.a,Object(v.a)({},e,{children:this.renderChild}))}}]),t}(h.a.Component);n.d(t,"a",function(){return a.a}),n.d(t,!1,function(){return m}),n.d(t,"b",function(){return b})},270:function(e,t,n){e.exports={userIcon:"_1IM6wJM",coverTexture:"HX5arpI"}},271:function(e,t,n){e.exports={body:"_1wga7bX",description:"M25uTI8"}},272:function(e,t,n){e.exports={fadeInAppear:"_22mVTM-",fadeInAppearActive:"_1hxqyIM",slideEnter:"_3COQvq3",slideEnterActive:"_2aldk6y",slideExit:"wmh3e27",slideExitActive:"_3zkgYlj"}},274:function(e,t,n){e.exports={crossIcon:"_3CaaWeE",white:"_1h8_ueG"}},275:function(e,t,n){e.exports={circleSpinner:"_2NKkBOh",animation:"_3AGimX1",scaleout:"_2cp3aq4"}},278:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var a=n(58),r=n(11),i=n(7),o=n(8),s=n(14),c=n(12),l=n(13),u=n(4),d=n.n(u);function h(e){return function(t){var n=function(n){function u(){var t;return Object(i.a)(this,u),(t=Object(s.a)(this,Object(c.a)(u).apply(this,arguments))).state=null,t.loadDataset=function(n){if(null!==n){var a=n.parentElement;if(null===a)throw new Error("Attempted to load the parent of an orphaned component");var i=Object(r.a)({},a.dataset);Object.keys(i).length!==Object.keys(a.dataset).length&&Object.keys(a.dataset).forEach(function(e){i[e]=a.dataset[e]}),t.setState(e(i))}},t}return Object(l.a)(u,n),Object(o.a)(u,[{key:"render",value:function(){return null===this.state?d.a.createElement("span",{style:{display:"none"},ref:this.loadDataset}):d.a.createElement(t,Object(a.a)({},this.state,this.props))}}]),u}(d.a.Component);return n.WrappedComponent=t,n}}},279:function(e,t,n){"use strict";var a=n(173),r=n(1),i=(n(4),n(210)),o=function(e){var t=e.size;return Object(r.a)("svg",{viewBox:"0 0 16 16",width:t,height:t},void 0,Object(r.a)("circle",{className:i.backgroundCircle,strokeWidth:2,cx:8,cy:8,r:6.75}),Object(r.a)("line",{className:i.strokedSymbol,strokeWidth:2,strokeLinecap:"round",x1:8,y1:7.75,x2:8,y2:11.25}),Object(r.a)("circle",{className:i.filledSymbol,cx:8,cy:5,r:1.25}))};o.defaultProps={size:16},n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return o})},280:function(e,t,n){"use strict";var a=n(127),r=n(297),i=n(120),o=n(1),s=(n(4),n(396)),c=function(){return Object(o.a)("span",{className:s.required},void 0,"*")},l=n(290),u=n(171),d=n(42),h=n(289);n.d(t,"a",function(){return a.a}),n.d(t,!1,function(){return r.a}),n.d(t,!1,function(){return i.a}),n.d(t,"g",function(){return c}),n.d(t,"h",function(){return l.a}),n.d(t,"f",function(){return u.a}),n.d(t,"b",function(){return d.d}),n.d(t,"e",function(){return d.c}),n.d(t,"d",function(){return d.b}),n.d(t,"c",function(){return d.a}),n.d(t,!1,function(){}),n.d(t,!1,function(){return h.a})},284:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(1),r=n(7),i=n(8),o=n(14),s=n(12),c=n(13),l=n(18),u=n.n(l),d=n(4),h=n.n(d),p=n(270),f=n(19),m=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.url,n=e.size;return Object(a.a)("div",{className:u()(p.userIcon,p.coverTexture),style:{backgroundImage:Object(f.b)(t),width:n,height:n}})}}]),t}(h.a.Component);m.defaultProps={size:40}},287:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var a="undefined"!=typeof globalInitData?globalInitData.commonResourcePath:"";function r(e){return new URL(e,a)}function i(e){a=e}},288:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var a=n(1),r=n(16),i=n(7),o=n(8),s=n(14),c=n(12),l=n(13),u=n(18),d=n.n(u),h=n(4),p=n.n(h),f=n(2),m=n(10),v=n(19),g=n(163),b=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.userId,n=e.isFollowing,i=e.gaCategory,o=e.onFollow,s=e.simple;return Object(a.a)("div",{className:d()("_follow-buttons",g.followButton)},void 0,m.default.user.loggedIn?Object(a.a)("div",{},void 0,Object(a.a)("div",{className:d()("follow-button","js-follow-button","off","js-click-trackable",Object(r.a)({_hidden:n},g.simple,s)),"data-click-category":i,"data-click-action":"click","data-click-label":"follow","data-user-id":t,onClick:o},void 0,Object(a.a)("span",{className:"text"},void 0,!s&&Object(f.b)("フォローする"))),Object(a.a)("div",{className:d()("follow-button","js-follow-button","on","js-click-trackable",Object(r.a)({_hidden:!n},g.simple,s)),"data-click-category":i,"data-click-action":"click","data-click-label":"unfollow","data-user-id":t},void 0,Object(a.a)("span",{className:"text"},void 0,!s&&Object(f.b)("フォロー中")))):Object(a.a)("a",{href:v.f(location.href)},void 0,Object(a.a)("div",{className:d()("follow-button","off",Object(r.a)({},g.simple,s))},void 0,Object(a.a)("span",{className:"text"},void 0,!s&&Object(f.b)("フォローする")))))}}]),t}(p.a.PureComponent);b.defaultProps={simple:!1}},289:function(e,t,n){"use strict";n.d(t,"a",function(){return k});var a=n(7),r=n(8),i=n(14),o=n(12),s=n(13),c=n(1),l=n(4),u=n.n(l),d=n(395),h=n.n(d),p=n(269),f=n.n(p),m=n(18),v=n.n(m),g=n(2),b=n(26),y=(n(443),n(441),n(70));function k(){var e=document.documentElement.lang;return"zh"===e?e="zh-cn":e||(e="ja"),Object(c.a)(w,{lang:e})}var w=function(e){function t(e){var n;Object(a.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).dateFormat="YYYY-MM-DD",n.handleSearchButtonClick=function(){location.href=g.a.query.replace({scd:Object(b.default)(n.state.from).format(n.dateFormat),ecd:Object(b.default)(n.state.to).format(n.dateFormat),p:null},!1)},n.handleFromBoxClick=function(){n.setState({fromSelectMode:!0,toSelectMode:!1})},n.handleToBoxClick=function(){n.setState({fromSelectMode:!1,toSelectMode:!0})},n.handleDayClick=function(e,t){var a=n.state.fromSelectMode;if(!t.disabled)if(a){n.setState({from:e,fromSelectMode:!1,toSelectMode:!0});var r=Object(b.default)(e).add(1,"year").subtract(1,"day"),i=Object(b.default)(n.state.to);r.isBefore(i)&&n.setState({to:r.toDate()})}else{n.setState({to:e});var o=Object(b.default)(e).subtract(1,"year").add(1,"day"),s=Object(b.default)(n.state.from);o.isAfter(s)&&n.setState({from:o.toDate()})}};var r=n.getParamValue("scd",Object(b.default)().subtract(7,"days").format(n.dateFormat)),s=n.getParamValue("ecd",Object(b.default)().format(n.dateFormat)),c=Object(b.default)(r).add(1,"year").subtract(1,"day");return c.isBefore(s)&&(s=c.format(n.dateFormat)),n.state={from:Object(b.default)(r).toDate(),to:Object(b.default)(s).toDate(),fromSelectMode:!0,toSelectMode:!1},n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"getParamValue",value:function(e,t){return g.a.query.parse()[e]||t}},{key:"formatMonthTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";return"ja"===t?Object(b.default)(e).locale(t).format("YYYY年 M月"):Object(b.default)(e).locale(t).format("MMMM YYYY")}},{key:"render",value:function(){var e=this.state,t=e.from,n=e.to,a=e.fromSelectMode,r=e.toSelectMode,i=a?t:n,o=a?{after:n}:[{before:t},{after:Object(b.default)().toDate()}],s=r?v()(y.searchCustomTermDateButtonSelected):null,l=a?v()(y.searchCustomTermDateButtonSelected):null;return f.a.formatMonthTitle=this.formatMonthTitle,Object(c.a)("div",{},void 0,Object(c.a)("div",{className:y.searchCustomTermNoticeContainer},void 0,Object(c.a)("span",{},void 0,Object(g.b)("＊期間は最大一年まで指定可能です。"))),Object(c.a)("div",{className:y.searchCustomTermDateContainer},void 0,Object(c.a)("span",{className:v()(y.searchCustomTermDateButton,y.searchCustomTermFrom,l),onClick:this.handleFromBoxClick},void 0,Object(b.default)(t).format("L")),Object(c.a)("span",{className:y.searchCustomTermDateBetween},void 0,"〜"),Object(c.a)("span",{className:v()(y.searchCustomTermDateButton,y.searchCustomTermTo,s),onClick:this.handleToBoxClick},void 0,Object(b.default)(n).format("L"))),Object(c.a)("div",{className:y.searchCustomTermCalendar},void 0,Object(c.a)(h.a,{month:i,toMonth:new Date,numberOfMonths:1,selectedDays:[t,n,{from:t,to:n}],disabledDays:o,onDayClick:this.handleDayClick,localeUtils:f.a,locale:this.props.lang})),Object(c.a)("div",{className:y.searchCustomTermEnterButtonContainer},void 0,Object(c.a)("span",{className:y.searchCustomTermEnter,onClick:this.handleSearchButtonClick},void 0,Object(g.b)("決定"))))}}]),t}(u.a.Component)},290:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var a=n(1),r=n(7),i=n(8),o=n(14),s=n(12),c=n(13),l=n(18),u=n.n(l),d=n(4),h=n.n(d),p=n(124),f=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(o.a)(this,Object(s.a)(t).apply(this,arguments))).ref=null,e.saveRef=function(t){e.ref=t},e.handleClick=function(){e.ref.click()},e.handleKeyDown=function(t){" "!==t.key||t.nativeEvent.isComposing||(t.preventDefault(),e.ref.click())},e}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.onChange,r=e.checked,i=e.disabled;return Object(a.a)("div",{role:"checkbox","aria-checked":r,"aria-disabled":i,tabIndex:0,className:u()(p.label,i&&p.disabled),onClick:this.handleClick,onKeyDown:this.handleKeyDown},void 0,h.a.createElement("input",{role:"none",type:"checkbox",className:p.checkbox,name:name,onChange:n,checked:r,disabled:i,ref:this.saveRef}),Object(a.a)("div",{role:"presentation",className:p.switch},void 0,Object(a.a)("span",{className:p.switchKnob})),Object(a.a)("div",{className:p.text},void 0,t))}}]),t}(h.a.PureComponent)},291:function(e,t,n){"use strict";var a=n(174);n.d(t,"f",function(){return a.a}),n.d(t,"g",function(){return a.d}),n.d(t,"i",function(){return a.f}),n.d(t,"j",function(){return a.g}),n.d(t,"h",function(){return a.e});var r=n(20);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b}),n.d(t,"c",function(){return r.c}),n.d(t,"d",function(){return r.d}),n.d(t,"e",function(){return r.e})},294:function(e,t,n){"use strict";n.d(t,"f",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"g",function(){return d});var a=n(21),r=n(2),i=function(e,t,n){return a.b("/rpc_rating.php",{mode:"save",i_id:e,score:t},n)},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return a.b("/rpc/index.php",{mode:"save_illust_bookmark",illust_id:e,restrict:Number(t),comment:n,tags:r.join(" ")})},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2?arguments[2]:void 0;return a.a("/rpc/index.php",{mode:"get_bookmark_illusts",max_bookmark_id:e,num:t},n)},c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=arguments.length>3?arguments[3]:void 0;return a.a("/rpc/index.php",{mode:"get_view_history",date:"".concat(e.getFullYear(),"-").concat(r.a.padding(e.getMonth()+1),"-").concat(r.a.padding(e.getDate())),before:t,count:n},i)},l=function(e){return a.b("/rpc/index.php",{mode:"save_illust_view_history_clear_time"},e)},u=function(e,t){return a.a("/rpc/index.php",{mode:"get_illust_detail_by_ids",illust_ids:e.join(",")},t)},d=function(e,t,n){return a.a("/rpc/index.php",{mode:"get_recommend_illusts",ids:e,num:t},n)}},295:function(e,t,n){"use strict";var a=n(3),r=n.n(a),i=n(6),o=n(41);var s,c=n(2),l=n(10),u=n(123);function d(){return h.apply(this,arguments)}function h(){return(h=Object(i.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=void 0!==l.default.user.webPushEnabled,!e.t0){e.next=5;break}return e.next=4,u.a;case 4:e.t0=e.sent.isPushNotificationsSupported();case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function p(){return f.apply(this,arguments)}function f(){return(f=Object(i.a)(r.a.mark(function e(){var t,n,a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a;case 2:return t=e.sent,e.next=5,t.getNotificationPermission();case 5:return n=e.sent,e.next=8,t.isPushNotificationsEnabled();case 8:return a=e.sent,i=l.default.user.webPushEnabled,e.abrupt("return",{permission:n,isSubscribed:a,enabled:i,isNotificationReceivable:"granted"===n&&a&&i===s.Enabled});case 11:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}n.d(t,"a",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return v}),n.d(t,"g",function(){return y}),n.d(t,"d",function(){return _}),n.d(t,"f",function(){return O}),function(e){e.Unknown="unknown",e.Enabled="enabled",e.Disabled="disabled"}(s||(s={}));var m=new Set;function v(e){m.add(e)}function g(e){return b.apply(this,arguments)}function b(){return(b=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Array.from(m,function(e){return e(t)}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function y(){return k.apply(this,arguments)}function k(){return(k=Object(i.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a;case 2:return t=e.sent,e.next=5,p();case 5:if(!(n=e.sent).isNotificationReceivable){e.next=13;break}return e.next=9,t.setSubscription(!1);case 9:return e.next=11,g(!1);case 11:e.next=21;break;case 13:if("granted"!==n.permission){e.next=20;break}return e.next=16,t.setSubscription(!0);case 16:return e.next=18,g(!0);case 18:e.next=21;break;case 20:t.registerForPushNotifications();case 21:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var w=new Set;function _(e){w.add(e)}function x(e){return j.apply(this,arguments)}function j(){return(j=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Array.from(w,function(e){return e(t)}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function O(){void 0!==l.default.user.webPushEnabled&&u.a.then(function(){var e=Object(i.a)(r.a.mark(function e(t){var n,a,u,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u=function(){return(u=Object(i.a)(r.a.mark(function e(a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=11;break}return e.t0=Promise,e.t1=n(),e.next=5,o.b("/ajax/webpush/enable");case 5:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=9,e.t0.all.call(e.t0,e.t3);case 9:l.default.user.webPushEnabled=s.Enabled,t.sendSelfNotification("pixiv",Object(c.b)("pixivから通知が届くようになりました"));case 11:case"end":return e.stop()}},e,this)}))).apply(this,arguments)},a=function(e){return u.apply(this,arguments)},n=function(){t.sendTags({user_id:parseInt(l.default.user.id,10)})},t.isPushNotificationsSupported()){e.next=5;break}return e.abrupt("return");case 5:return v(a),t.on("subscriptionChange",function(){var e=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),t.on("notificationPermissionChange",function(){var e=Object(i.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),e.next=10,p();case 10:(d=e.sent).isSubscribed&&d.enabled===s.Enabled&&n();case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())}},297:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(1),r=n(16),i=n(7),o=n(8),s=n(14),c=n(12),l=n(13),u=n(18),d=n.n(u),h=n(4),p=n.n(h),f=n(148),m=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.title,i=e.onChange,o=e.refFunc,s=e.checked,c=e.name,l=e.value;return p.a.createElement("li",{ref:o},Object(a.a)("label",{className:d()(f.label,Object(r.a)({},f.disabled,t))},void 0,Object(a.a)("input",{type:"checkbox",className:f.checkbox,name:c,checked:s,value:l,disabled:t,onChange:i}),Object(a.a)("span",{className:f.title},void 0,n),Object(a.a)("div",{className:f.icon})))}}]),t}(p.a.PureComponent)},298:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var a=n(1),r=n(7),i=n(8),o=n(14),s=n(12),c=n(13),l=n(4),u=n.n(l),d=n(398),h=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return Object(a.a)("div",{className:d.body},void 0,this.props.children)}}]),t}(u.a.Component)},30:function(e,t,n){"use strict";n.d(t,"d",function(){return v}),n.d(t,"h",function(){return b}),n.d(t,"a",function(){return k}),n.d(t,"g",function(){return C}),n.d(t,"e",function(){return S}),n.d(t,"f",function(){return T}),n.d(t,"b",function(){return I}),n.d(t,"c",function(){return E});var a=n(3),r=n.n(a),i=n(6),o=n(11),s=n(7),c=n(8),l=n(16),u=n(0),d=n.n(u),h=n(2),p=n(10),f=n(25),m=n(19),v={updateProcesses:["fixed"],setup:function(){b.setup(),y.setup(),T.setup(),g.setup(),h.a.ui.expander.setup(),h.a.ui.Counter.setup(),h.a.ui.modal.setup(),h.a.ui.toggleSwitch.setup(),h.a.ua.ie&&d()(".ui-autofocus:last").trigger("focus")},update:function(e){var t=this.updateProcesses,n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){this[i.value](e)}}catch(e){a=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}}};function g(e){window.setTimeout(function(){e.select()},0)}g.setup=function(){h.a.d.on("focusin",".ui-select-all",function(e){g(e.target)})};var b={setup:function(){var e=this;h.a.d.on("click",".ui-tab",function(t){return e.open(t.currentTarget),!1}).on("click",".ui-tab-prev",function(t){return e.prev(t),!1}).on("click",".ui-tab-next",function(t){return e.next(t),!1}),this.update()},update:function(){var e=this;d()(".ui-tab-container.root").each(function(t,n){e.restore(n)})},open:function(e){var t=d()(e),n=t.siblings().addBack(),a=t.hasClass("_current"),r=t.closest(".ui-tab-container"),i=r.find("> .ui-tab-content"),o=t.dataset("target"),s=i.filter(".".concat(o));n.removeClass("_current"),i.hide().addClass("_hidden"),a&&"yes"===t.dataset("toggle")||(t.addClass("_current"),s.show().removeClass("_hidden"),r.trigger("uiTabUpdate",[t,n])),h.a.lazyImage(s.filter("._lazy-image-container")),r.data("saveState")&&h.a.storage.localStorage("pixiv.ui.tab.".concat(h.a.storage.id(r.data("name"))),o,2592e6),this.restore(s.find("> .ui-tab-container"))},prev:function(e){var t=d()(e.currentTarget).closest(".ui-tab-container"),n=d()("> .ui-tabs .ui-tab",t),a=n.filter("._current").prev();a.length?a.trigger("click"):t.trigger("uiTabUpdate",[a,n])},next:function(e){var t=d()(e.currentTarget).closest(".ui-tab-container"),n=d()("> .ui-tabs .ui-tab",t),a=n.filter("._current").next();a.length?a.trigger("click"):t.trigger("uiTabUpdate",[a,n])},restore:function(e){var t=d()(e);if(t.length){var n,a,r=t.data(),i=r.name,o=d()("> .ui-tabs .ui-tab",t);r.saveState&&i&&(n=h.a.storage.localStorage("pixiv.ui.tab.".concat(h.a.storage.id(i))))&&(a=o.filter('[data-target="'.concat(n,'"]'))).length?this.open(a):this.open(o.filter(".default"))}}},y={target:null,setup:function(){var e=this;h.a.w.on("scroll.uifixed",function(){e.check()}).on("resize.uifixed",function(){e.resize()}),this.update()},update:function(e){this.target=d()(".ui-fixed",e),this.check()},check:function(){var e=this;if(this.target.length){var t=h.a.w.scrollTop(),n=0;this.target.each(function(a,r){var i,o,s=d()(r),c=s.data("status")||"off",l=s.data("position"),u=s.parent(),h=u.parent(),p=u.outerHeight(!0),f=h.offset().top+h.innerHeight()+parseInt(h.css("border-top-width"),10);l||(l=s.data("position",s.offset().top),d()(window).width()>=640&&u.height(p)),t+n>=l?(o=t+n+p)>f?(-1*(i=f-o)>p?e.off(s):"on:edge"===c?s.css("top",i):e.on(s,i,"on:edge"),p+=i):"on"!==c&&e.on(s,n):"off"!==c&&e.off(s),n+=p})}},resize:function(){var e=this;this.target.each(function(t,n){e.position(n)})},position:function(e){var t=d()(e),n=t.parent();"off"!==t.data("status")&&t.css({left:n.offset().left,width:n.width()})},setHeight:function(e){var t=d()(e),n=t.outerHeight(!0);t.parent().height(n)},on:function(e,t,n){e.data("status",n||"on").addClass("ui-fixed-on").removeClass("ui-fixed-paused").css("top",t),this.position(e)},pause:function(e){e.data("status","paused").addClass("ui-fixed-paused")},off:function(e){e.data("status","off").removeClass("ui-fixed-on ui-fixed-paused").css({top:"",left:"",width:""})}},k=function(){function e(t,n){var a=this;Object(s.a)(this,e),Object(l.a)(this,"container",null),Object(l.a)(this,"target",null),Object(l.a)(this,"counter",null),Object(l.a)(this,"data",null),Object(l.a)(this,"over",!1),n?(this.target=d()(t),this.counter=d()(n)):(this.container=d()(t),this.target=d()("input, textarea",t).eq(0),this.counter=d()(".current-count",t)),this.data=Object(o.a)({limit:140},this.target.dataset()),this.target.on("keyup blur",function(){a.update()}).trigger("keyup")}return Object(c.a)(e,[{key:"update",value:function(){var e=this.target.val().length;this.counter.text(e),!this.over&&e>this.data.limit&&(this.over=!0,this.container&&this.container.trigger("uiCounterOK",e),this.ng()),this.over&&e<=this.data.limit&&(this.over=!1,this.container&&this.container.trigger("uiCounterNG",e),this.ok())}},{key:"ok",value:function(){this.counter.removeClass("over")}},{key:"ng",value:function(){this.counter.addClass("over")}}]),e}(),w=function(e){var t;return function(){if(null==t){var n=Promise.resolve(d.a.getScript(e)).then(function(){return!0});return t=n.then(function(){return!1}),n}return t}},_=w("https://platform.twitter.com/widgets.js"),x={ja:"ja_JP",en:"en_US",fr:"fr_FR",ko:"ko_KR",ru:"ru_RU",th:"th_TH",zh:"zh_CN","zh-tw":"zh_TW",es:"es_ES"}[document.documentElement.lang||"ja"],j=w("https://connect.facebook.net/".concat(x,"/sdk.js")),O={twitter:!1,facebook:!1},C={container:[],template:null,setup:function(){d()('<div id="fb-root"/>').appendTo("body"),this.update();var e=d()("ul.share-button");e.length&&(this.template=d()("#template-ui-share-container"),e.find(".weibo-button").each(this.weibo).end().find(".qq-button").each(this.qq).end().find(".ui-share-button").on("click",this.open.bind(this)))},update:function(){d()(".twitter-share-button").length&&this.twitter(),d()(".fb-like").length&&this.facebook(),d()(".qq-button").length&&this.qq()},twitter:function(){var e=Object(i.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!O.twitter){e.next=2;break}return e.abrupt("return");case 2:return O.twitter=!0,e.prev=3,e.next=6,_();case 6:t=e.sent;case 7:return e.prev=7,O.twitter=!1,e.finish(7);case 10:if("undefined"!=typeof twttr){e.next=12;break}return e.abrupt("return");case 12:twttr.widgets&&twttr.widgets.load(),t&&twttr.ready(function(){twttr.events.bind("tweet",function(e){if(e){var t=e.target&&e.target instanceof HTMLIFrameElement?e.target.src:void 0;h.a.ga.track(["_trackSocial","twitter","tweet",t])}}),twttr.events.bind("click",function(e){if(e){var t=e.target&&e.target instanceof HTMLIFrameElement?e.target.src:void 0;h.a.ga.track(["_trackSocial","twitter",m.a("click-".concat(e.region)),t])}})});case 14:case"end":return e.stop()}},e,this,[[3,,7,10]])}));return function(){return e.apply(this,arguments)}}(),facebook:function(){var e=Object(i.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!O.facebook){e.next=2;break}return e.abrupt("return");case 2:return O.facebook=!0,e.prev=3,e.next=6,j();case 6:t=e.sent;case 7:return e.prev=7,O.facebook=!1,e.finish(7);case 10:if("undefined"!=typeof FB){e.next=12;break}return e.abrupt("return");case 12:FB.init({appId:p.default.config.facebookAppId,version:"v2.3",xfbml:!0}),t&&(FB.Event.subscribe("edge.create",function(e){h.a.ga.track(["_trackSocial","facebook","like",e])}),FB.Event.subscribe("edge.remove",function(e){h.a.ga.track(["_trackSocial","facebook","unlike",e])}),FB.Event.subscribe("message.send",function(e){h.a.ga.track(["_trackSocial","facebook","send",e])}));case 14:case"end":return e.stop()}},e,this,[[3,,7,10]])}));return function(){return e.apply(this,arguments)}}(),weibo:function(){for(var e=d()(this).dataset(),t={url:e.url,type:"3",count:"1",appKey:"",title:"".concat(e.title,"#"),pic:e.pic||d()('meta[property="og:image"]').attr("content")||"",relateUid:"2230227495",language:e.language,rnd:(new Date).valueOf()},n=[],a=Object.keys(t),r=0;r<a.length;r++){var i=a[r];n.push("".concat(i,"=").concat(encodeURIComponent(t[i]||"")))}d()("".concat('<iframe allowTransparency="true" frameborder="0" scrolling="no" style="vertical-align:middle"src="http://hits.sinajs.cn/A1/weiboshare.html?').concat(n.join("&"),'" width="').concat(72,'" height="').concat(16,'"></iframe>')).appendTo(this)},qq:function(){for(var e=d()(this).dataset(),t={url:e.url,desc:"",summary:"",title:e.title,site:"",pics:e.pic||d()('meta[property="og:image"]').attr("content")||""},n=[],a=Object.keys(t),r=0;r<a.length;r++){var i=a[r];n.push("".concat(i,"=").concat(encodeURIComponent(t[i]||"")))}d()(this).html('<a href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?'.concat(n.join("&"),'" target="_blank" title="分享到QQ空间">')+'<img src="http://qzonestyle.gtimg.cn/qzone_v6/proj_connect_open/img/qzone_share_txt_s.png" alt="分享到QQ空间" border="0"></a>')},open:function(e){var t=d()(e.target),n=t.dataset(),a=n.shareButtonId||0,r=this.container[a]=this.container[a]||this.template.tmpl(n).appendTo("body"),i=t.offset();return h.a.ui.modal.toggle(t,r.css({top:i.top+t.outerHeight()+7,left:i.left+t.outerWidth()/2-r.outerWidth()/2})),a||d.a.getScript("https://b.st-hatena.com/js/bookmark_button.js"),!1}},S={modals:[],latestTrigger:null,blockCount:0,backgroundSelector:".ad",initialized:!1,paused:!1,initialize:function(){var e=this;h.a.d.on("click.modal",function(t){e.click(t)}),h.a.ui.shortcut.bind("ESC",function(){return e.close(),!1}),this.initialized=!0},terminate:function(){h.a.d.off("click.modal"),h.a.ui.shortcut.unbind("ESC"),this.initialized=!1},current:function(e){var t=this.modals[this.modals.length-1];return e?(t||{})[e]:t},scrollTop:function(){var e;if(this.blockCount){e=this.modals.slice().reverse();var t=!0,n=!1,a=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;if(o.block)return o.target.scrollTop()-h.a.w.scrollTop()}}catch(e){n=!0,a=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}}return null},block:function(){++this.blockCount,d()(this.backgroundSelector).addClass("_invisible"),d()("html").addClass("no-scroll")},unblock:function(){this.blockCount=0,d()(this.backgroundSelector).removeClass("_invisible"),d()("html").removeClass("no-scroll")},pause:function(){this.paused=!0},restart:function(){this.paused=!1},click:function(e){if(!this.paused){var t=d()(e.target),n=t.closest(".ui-modal-trigger")[0];t.hasClass("ui-modal-close")||n&&n===this.latestTrigger||this.modals.length&&!n&&!t.closest(this.current("target")).length?this.close():n&&(this.latestTrigger=n)}},open:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=d()(e);return this.paused?n:(this.initialized||this.initialize(),this.blockCount,this.current("block")||this.close(),this.modals.push(Object(o.a)({target:n},t)),t.block&&(f.a.add(".ui-scroll-view",n),f.a.watch(n),this.blockCount||this.block()),n.show().trigger("uimodalopen"))},close:function(){if(!this.paused){var e=this.modals.pop();if(this.latestTrigger=null,e){var t=e.target;this.blockCount,e.block&&(f.a.remove(".ui-scroll-view",t),f.a.unwatch(t),this.blockCount<=1&&this.unblock()),e.close&&e.close(t),e.disposable?t.remove():t.hide(),t.trigger("uimodalclose"),this.modals.length||this.terminate()}}},clear:function(){for(var e=this.modals.length;e--;)this.close()}};function T(e,t){var n=0;if("number"==typeof e)n=e;else{var a=d()(e);a.length&&(n=a.offset().top)}if(n){var r=d()("#ceiling").outerHeight();r&&(n-=r),n=Math.max(n,0)}var i=d()([document.body,document.documentElement]).stop(!0,!0);if(null===t)return T.scrolling=!1,h.a.w.scrollTop(n).promise();var o=d.a.Deferred();return h.a.d.on("scroll.uiscroll DOMMouseScroll.uiscroll mousewheel.uiscroll",function(){return!1}),T.scrolling=!0,o.then(function(){h.a.d.off("scroll.uiscroll DOMMouseScroll.uiscroll mousewheel.uiscroll"),T.scrolling=!1}),i.animate({scrollTop:n},t||800,"easeOutExpo",function(){o.resolve()}),o.promise()}S.push=S.open,S.pop=S.close,T.scrolling=!1,T.setup=function(){h.a.d.on("click.scroll",".ui-scroll",function(e){var t=d()(e.currentTarget);if(!t.hasClass("off")){var n=!!t.dataset().hashLink,a=t.data("target")||t.attr("href");if(n){e.preventDefault();var r=window.location.hash;if(r){if(r===a)return;if(h.a.ua.ie){var i=document.getElementById(r.slice(1));i&&d()(i).removeClass("target"),d()(a).addClass("target")}}window.location.hash=a}e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),T(a),t.trigger("uiScroll")}}),h.a.w.on("load",function(){var e=window.location.hash;if(e){var t=document.getElementById(e.slice(1));t&&T(t)}})};var I=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s.a)(this,e),this.container=d()(t),this.labelContainer=d()("> div, .label",this.container),this.itemContainer=d()("> ul, .items",this.container),this.options=n,this.options.sensitive?this.container.on("mouseenter mouseleave",this.toggle.bind(this)):this.labelContainer.on("click",this.toggle.bind(this)),this.container.on("click","li:not(.selected)",this.select.bind(this))}return Object(c.a)(e,[{key:"toggle",value:function(){this.itemContainer.is(":visible")?S.pop():S.push(this.itemContainer)}},{key:"select",value:function(e){if(!(e.isDefaultPrevented()||this.options.select&&!1===this.options.select(e))){var t=d()(e.target);S.pop(),this.labelContainer.text("".concat(t.text()," ▾"));var n=t.dataset();n.url&&(window.location.href=n.url),this.itemContainer.removeClass("selected"),t.addClass("selected")}}}]),e}(),M=/[\s\xA0　]+/,E=function(){function e(t,n){Object(s.a)(this,e),this.target=d()(t),this.options=Object(o.a)({maxCount:10},n),this.recentValue="",this.container=void 0,this.tagsContainer=void 0,this.countContainer=void 0,this.input=void 0,this.tags=void 0}return Object(c.a)(e,[{key:"make",value:function(){var t=this;if(!this.container){var n=this.target,a=h.a.ui.Tag.split(n.val()),r=d.a.tmpl(e.template,{tags:a,maxCount:this.options.maxCount}).insertBefore(n);n.hide(),this.container=r.on("click",function(){t.input[0].focus()}).on("click","span.close",this.remove.bind(this)),this.tagsContainer=d()("ul.tags",r),this.countContainer=d()("span.count",r),this.input=d()("input",r).on("keydown keyup blur",this.update.bind(this)),this.tags=a}}},{key:"value",value:function(){return this.tags.join(" ")}},{key:"update",value:function(e){var t=this.input.val(),n=e.altKey||e.ctrlKey||e.shiftKey,a=e.originalEvent.isComposing,r="keydown"===e.type&&!a&&"Enter"===e.key&&!n;if(/[\s　]$/.test(t)||r||"blur"===e.type){var i=h.a.ui.Tag.trim(t);if(i){var o=i.split(M);this.input.val(""),this.recentValue="",this.add(o)}}else if("keyup"!==e.type||""!==this.recentValue||a||"Delete"!==e.key||n)this.recentValue=t;else{var s=d()("span",this.tagsContainer).get(-1);s&&this.remove({target:s})}r&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())}},{key:"updateCount",value:function(){var e=this.countContainer;if(e.length){var t=this.tags.length;e.text(t),e.toggleClass("over",t>this.options.maxCount)}}},{key:"add",value:function(t){var n=!1;if(!t)return n;var a=("string"==typeof t?[t]:t).map(h.a.ui.Tag.trim),r=!0,i=!1,o=void 0;try{for(var s,c=a[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;l&&(h.a.ui.Tag.find(l,this.tags)>=0||(d.a.tmpl(e.itemTemplate,{tag:l}).appendTo(this.tagsContainer),this.tags.push(l),n=!0))}}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n&&(this.target.val(this.value()).trigger("uiTagUpdate"),this.updateCount()),n}},{key:"remove",value:function(e){var t=!1,n=d()(e.target).parent(),a=n.attr("data-tag"),r=h.a.ui.Tag.find(a,this.tags);return r>=0&&(n.remove(),this.tags.splice(r,1),this.target.val(this.value()).trigger("uiTagUpdate"),this.updateCount(),t=!0),void 0!==e.stopPropagation&&e.stopPropagation(),t}}]),e}();Object(l.a)(E,"template",['<div class="ui-tag-container">','<ul class="tags">','{{each tags}}<li data-tag="{{= $value}}">{{= $value}}<span class="close">×</span></li>{{/each}}',"</ul>",'<input type="text" value="">','<div class="count"><span class="count{{if tags.length > maxCount}} over{{/if}}">{{= tags.length}}</span>/{{= maxCount}}</div>',"</div>"].join("")),Object(l.a)(E,"itemTemplate",'<li data-tag="{{= tag}}">{{= tag}}<span class="close">×</span></li>')},300:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return s});var a=n(37),r=n.n(a),i=function(e){return e.get("/ajax/notification",{},{},{cache:"no-cache"})},o=function(e){return e.get("/ajax/notification_all",{})},s=function(e,t,n){return e.post("/ajax/notification/update",{},r.a.stringify({key:t,value:n?"1":"0"}))}},303:function(e,t,n){"use strict";var a=n(16),r=n(1),i=n(58),o=n(11),s=n(3),c=n.n(s),l=n(6),u=n(7),d=n(8),h=n(14),p=n(12),f=n(13),m=n(50),v=n(39),g=n(18),b=n.n(g),y=n(4),k=n.n(y),w=n(15),_=n(120),x=n(57),j=function(e){return Object(r.a)("div",{className:x.text},void 0,e.visibleItemType===I.UserOnly?Object(w.d)("ユーザーの作品の%(dotIcon)メニューからそのユーザーをミュートすることができます。",{dotIcon:Object(r.a)(_.a,{size:20,icon:"dot"})}):Object(w.d)("作品の%(dotIcon)メニューからミュートしたいタグを選択することができます。",{dotIcon:Object(r.a)(_.a,{size:20,icon:"dot"})}))},O=function(e){return Object(r.a)("div",{className:x.guideWrapper},void 0,Object(r.a)("div",{className:x.title},void 0,Object(w.d)("ミュート機能の使い方")),e.visibleItemType===I.TagOnly?Object(r.a)("div",{className:b()(x.guide,x.twoColumnGuide)},void 0,Object(r.a)("div",{className:x.guideColumn},void 0,Object(r.a)("div",{className:b()(x.example,x.fromFormExample)}),Object(r.a)("div",{className:x.text},void 0,Object(w.d)("目的のタグを入力し、選択することでミュートできます。"))),Object(r.a)("div",{className:x.guideColumn},void 0,Object(r.a)("div",{className:b()(x.example,x.fromMenuExample)}),j(e))):Object(r.a)("div",{className:x.guide},void 0,Object(r.a)("div",{className:b()(x.example,x.fromMenuExample)}),j(e)))},C=n(19),S=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(p.a)(t).apply(this,arguments))).handleClick=function(){!e.props.busy&&e.props.enabled&&e.props.onToggle(e.props)},e}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.busy&&Object(r.a)("span",{className:"circle-spinner"},void 0,Object(r.a)("span",{className:"animation"}));return Object(r.a)("div",{className:b()("item",e.type,{disabled:!e.enabled}),onClick:this.handleClick},void 0,e.type===v.c.Tag&&Object(r.a)(_.a,{size:12,icon:"tag"}),e.type===v.c.User&&Object(r.a)("span",{className:"_user-icon size-20",style:{backgroundImage:Object(C.b)(e.iconUrl)}}),Object(r.a)("span",{className:"label"},void 0,Object(r.a)("span",{title:e.label},void 0,e.label)),!!e.enabled&&(e.isMuted?Object(r.a)("span",{className:"_action-button unmute"},void 0,Object(w.d)("ミュート中"),t):Object(r.a)("span",{className:"_action-button mute"},void 0,Object(w.d)("ミュートする"),t)))}}]),t}(k.a.PureComponent);S.defaultProps={iconUrl:"",busy:!1};var T,I,M,E=n(149),N=n(63),D=n(55),P=n(54),L=n(96);n(463);function U(e){return e?200:1}n.d(t,"c",function(){return I}),n.d(t,"b",function(){return M}),n.d(t,"d",function(){return U}),n.d(t,"a",function(){return z}),function(e){e[e.Mixed=0]="Mixed",e[e.TagOnly=1]="TagOnly",e[e.UserOnly=2]="UserOnly"}(I||(I={})),function(e){e[e.ZeroCandidatesOnly=0]="ZeroCandidatesOnly",e[e.Always=1]="Always"}(M||(M={}));var z=Object(D.b)(function(e){return{client:Object(N.b)(e),selfUserId:L.a(e)}})(((T=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(p.a)(t).apply(this,arguments))).state={muteItems:e.props.muteItems},e.handleToggle=function(t){t.enabled&&e.updateMuteItems(t)},e}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.muteItems!==e.muteItems&&this.setState({muteItems:this.props.muteItems})}},{key:"addMuteItem",value:function(){var e=Object(l.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.d(this.props.client,t,this.props.context);case 3:n=this.state.muteItems.find(function(e){return e.isMuted}),a=t!==n,e.t0=t.type,e.next=e.t0===v.c.Tag?8:e.t0===v.c.User?10:12;break;case 8:return this.props.dispatch(P.b(t.value,a)),e.abrupt("break",13);case 10:return this.props.dispatch(P.c(t.value,a)),e.abrupt("break",13);case 12:Object(C.i)(t.type);case 13:e.next=19;break;case 15:e.prev=15,e.t1=e.catch(0),this.undoStateByAddingMuteItem(t,this.state.muteItems),e.t1 instanceof m.b?alert(e.t1.message):alert(Object(w.d)("ミュート設定の保存に失敗しました。しばらく時間をおいてから、再度お試しください。"));case 19:case"end":return e.stop()}},e,this,[[0,15]])}));return function(t){return e.apply(this,arguments)}}()},{key:"undoStateByAddingMuteItem",value:function(e,t){var n=t.map(function(t){return t.enabled&&t.type===e.type&&t.value===e.value?Object(o.a)({},t,{isMuted:!1,busy:!1}):t});this.setState({muteItems:n})}},{key:"deleteMuteItem",value:function(){var e=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.e(this.props.client,t,this.props.context);case 3:e.t0=t.type,e.next=e.t0===v.c.Tag?6:e.t0===v.c.User?8:10;break;case 6:return this.props.dispatch(P.d(t.value)),e.abrupt("break",11);case 8:return this.props.dispatch(P.e(t.value)),e.abrupt("break",11);case 10:Object(C.i)(t.type);case 11:e.next=17;break;case 13:e.prev=13,e.t1=e.catch(0),this.undoStateByDeletingMuteItem(t,this.state.muteItems),e.t1 instanceof m.b?alert(e.t1.message):alert(Object(w.d)("ミュート設定の削除に失敗しました。しばらく時間をおいてから、再度お試しください。"));case 17:case"end":return e.stop()}},e,this,[[0,13]])}));return function(t){return e.apply(this,arguments)}}()},{key:"undoStateByDeletingMuteItem",value:function(e,t){var n=t.map(function(t){return t.enabled&&t.type===e.type&&t.value===e.value?Object(o.a)({},t,{isMuted:!0,busy:!1}):t});this.setState({muteItems:n})}},{key:"saveUpdatedMuteItems",value:function(){var e=Object(l.a)(c.a.mark(function e(t,n){var a,r,i,o,s=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({muteItems:t}),a=t.filter(function(e,t){return e!==n[t]}),r=a.filter(function(e){return!e.isMuted}).map(function(e){return s.deleteMuteItem(e)}),e.next=5,Promise.all(r);case 5:return i=a.filter(function(e){return e.isMuted}).map(function(e){return s.addMuteItem(e)}),e.next=8,Promise.all(i);case 8:o=this.cancelBusyState(this.state.muteItems,t,n),this.setState({muteItems:o});case 10:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"cancelBusyState",value:function(e,t,n){return e.map(function(e,a){return t[a].isMuted!==n[a].isMuted?Object(o.a)({},e,{busy:!1}):e})}},{key:"updateMuteItems",value:function(e){var t=this.state.muteItems.filter(function(e){return e.enabled&&e.isMuted}).length,n=this.props.isPremium,a=U(n);if(!e.isMuted&&t>=a){if(1!==a)return void alert(Object(w.d)("ミュートは$1件まで登録できます。",a));if(!confirm(Object(w.d)("一般ユーザーはタグとユーザーどちらか1件のみミュートできます。既にミュートした項目と入れ替えますか?")))return}var r=this.state.muteItems.map(function(t){var a=t.type===e.type&&t.value===e.value;return e.isMuted||1!==U(n)?t.enabled&&a?Object(o.a)({},t,{isMuted:!t.isMuted,busy:!0}):t:t.enabled&&(a||t.isMuted)?Object(o.a)({},t,{isMuted:!t.isMuted,busy:!0}):t});return this.saveUpdatedMuteItems(r,this.state.muteItems)}},{key:"renderItem",value:function(e){return k.a.createElement(S,Object(i.a)({key:"".concat(e.type,":").concat(e.value),onToggle:this.handleToggle},e))}},{key:"createExistingMuteItems",value:function(){return this.state.muteItems.filter(function(e){return e.listType===v.b.Existing}).map(function(e){return Object(o.a)({},e,{key:(e.enabled?"1":"2")+(e.type===v.c.User?"1":"2")+e.label.toUpperCase()})}).sort(function(e,t){return e.key.localeCompare(t.key)})}},{key:"createCandidateMuteItems",value:function(){return this.state.muteItems.filter(function(e){return e.listType===v.b.Candidate})}},{key:"wasPremiumUser",value:function(){return this.state.muteItems.some(function(e){return!e.enabled})}},{key:"render",value:function(){var e=this,t=this.state.muteItems,n=this.createCandidateMuteItems().filter(function(t){return!(t.type===v.c.User&&!t.isMuted&&t.value===e.props.selfUserId)}),a=this.createExistingMuteItems(),i=a.filter(function(e){return e.isMuted}),o=a.filter(function(t){if(t.type===v.c.User&&t.value===e.props.selfUserId)return!1;switch(e.props.visibleItemType){case I.TagOnly:return t.type===v.c.Tag;case I.UserOnly:return t.type===v.c.User;default:return!0}}),s=(this.props.showGuideCondition===M.ZeroCandidatesOnly&&0===t.length&&!this.props.inModal||this.props.showGuideCondition===M.Always)&&!this.props.inModal,c=0!==t.length||this.props.inModal,l=this.props.isPremium,u=(0!==t.length||this.props.inModal)&&!l;return Object(r.a)("div",{className:b()("_mute-edit-container",{premium:l})},void 0,c&&Object(r.a)("div",{className:"lists"},void 0,n.length>0&&this.renderCandidateMuteItems(n),o.length>0&&this.renderVisibleItems(i,o,l)),u&&this.renderPremiumBanner(),s&&Object(r.a)(O,{visibleItemType:this.props.visibleItemType}))}},{key:"renderCandidateMuteItems",value:function(e){var t=this;return Object(r.a)("div",{className:"list"},void 0,Object(r.a)("div",{className:"title"},void 0,Object(w.d)("候補")),e.map(function(e){return t.renderItem(e)}))}},{key:"renderVisibleItems",value:function(e,t,n){var i=this,o=U(n);return Object(r.a)("div",{className:"list"},void 0,Object(r.a)("div",{className:b()(Object(a.a)({},E.titleAndMuteItemCountWrapper,this.props.showCount))},void 0,Object(r.a)("div",{className:b()("title",Object(a.a)({},E.title,this.props.showCount))},void 0,Object(w.d)("設定中")),this.props.showCount&&Object(r.a)("div",{className:b()(Object(a.a)({},E.full,e.length===o),E.muteItemCount)},void 0,e.length,"/",o)),t.map(function(e){return i.renderItem(e)}))}},{key:"renderPremiumBanner",value:function(){var e=this.props.context===v.a.Setting?"setting_mute":"w_mute",t="/premium.php?ref=".concat(e,"&page=visitor");return Object(r.a)("div",{className:b()("premium-banner",E.premiumBannerWrapper)},void 0,Object(r.a)("div",{className:"normal-description"},void 0,Object(w.d)("一般ユーザーはタグとユーザー合わせて$1件までミュートできます。",U(!1))),Object(r.a)("div",{className:"premium-description"},void 0,Object(w.d)("pixivプレミアムユーザーになると$1件までミュートできるようになります。",U(!0))," ",this.wasPremiumUser()&&Object(w.d)("以前プレミアムユーザーだった際に設定した項目は、再度pixivプレミアムに登録すると使えるようになります。")),Object(r.a)("div",{className:"premium-button-container"},void 0,Object(r.a)("a",{href:t,target:"_blank",rel:"noopener",className:"_action-button"},void 0,Object(w.d)("pixivプレミアムに登録する"))))}}]),t}(k.a.Component)).defaultProps={visibleItemType:I.Mixed,showGuideCondition:M.ZeroCandidatesOnly,inModal:!0,showCount:!1},T))},31:function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"deleteImage",function(){return d}),n.d(a,"calendar",function(){return h});var r={};n.r(r),n.d(r,"getList",function(){return v}),n.d(r,"remove",function(){return g});var i={};n.r(i),n.d(i,"email",function(){return k});var o=n(21),s=n(41),c=function(e,t){return o.b("/rpc/index.php",e,t)},l=function(e,t,n){return s.c("GET","/rpc/index.php",{mode:"following_users",offset:e||0,num:t},n)},u=n(2),d=function(e,t){return function(e,t,n){return s.b("/event_add.php",{mode:e,type:t,id:n})}("delete_img",e,t)},h=function(e,t){return s.a("/rpc_event_calendar.php",{y:e,m:u.a.padding(t)},{cache:p})},p={},f=n(11),m=n(10),v=function(e,t){return s.c("GET","/rpc_group_setting.php",Object(f.a)({mode:"get",type:e,id:m.default.user.id},t))},g=function(e,t){return function(e,t,n,a){return s.c("POST","/rpc_group_setting.php",Object(f.a)({mode:e,type:t,id:n},a))}("del",e,t)},b=n(161),y={},k=function(e){return o.a("/setting_mail_address.php",{mode:"validation",mail_address:e},{cache:y})};n.d(t,"n",function(){return w}),n.d(t,"c",function(){return _}),n.d(t,"m",function(){return x}),n.d(t,"o",function(){return j}),n.d(t,"j",function(){return O}),n.d(t,"h",function(){return C}),n.d(t,"r",function(){return S}),n.d(t,"a",function(){return T}),n.d(t,"q",function(){return I}),n.d(t,"p",function(){return M}),n.d(t,"l",function(){return E}),n.d(t,"g",function(){return N}),n.d(t,"f",function(){return D}),n.d(t,"k",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return a}),n.d(t,"e",function(){return r}),n.d(t,"i",function(){return b}),n.d(t,"s",function(){return i});var w=function(e,t){return o.a("/rpc/url_fetch.php",{url:e,size:t},{cache:864e5})},_=function(e,t,n){return s.c("POST","/bookmark_add.php",{mode:"add",type:"user",user_id:e,tag:n,restrict:Number(t)||0,format:"json"})},x=function(e){return g("bookuser",e)},j=function(e,t,n){var a=isNaN(e)?(/id=(\d+)/.exec(e)||[])[1]:e;return s.c("GET","/rpc/user_fetch.php",{id:a,size:t,options:n.join(",")},{cache:6e4})},O=function(e){return o.a("/rpc/cps.php",{keyword:e},{cache:!1})},C=function(e){return o.b("./rpc_rating.php",{mode:"save2",i_id:m.default.context.illustId,u_id:m.default.user.id,qr:Number(m.default.context.hasQuestionnaire),num:e})},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return b.request("user",{sample_users:e,num_recommendations:t,following_booster_model:n})},T=function(e){for(var t=e||"illust",n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return o.a("/rpc/".concat(t,"_bookmark_tags.php"),{attributes:a.join(",").replace("level","lev")||"none"},{cache:y})},I=function(e,t){return o.a("/rpc/get_profile.php",e,t)},M=function(e,t){return o.a("/rpc_group_setting.php",{mode:"get",type:"bookuser",id:e},t)},E=function(e,t){var n=Array.isArray(e)?e:"string"==typeof e?[e]:Array.from(e);return o.a("/rpc/get_ugoira.php",{illust_ids:n.join(",")},t)},N=function(e){return o.b("/rpc_info_setting.php",{mode:"mark_as_read",id:e},{ajaxSettings:{dataType:"text"}})},D=function(e,t,n){return o.a("/rpc/illust_list.php",{illust_ids:e.join(","),verbosity:"",exclude_muted_illusts:t},n)}},314:function(e,t,n){},316:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return h});var a=n(1),r=n(7),i=n(8),o=n(14),s=n(12),c=n(13),l=n(4),u=n.n(l),d=n(200),h=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(o.a)(this,Object(s.a)(t).apply(this,arguments))).consumeContext=function(t){return void 0===t?null:(t!==e.ksContext&&(e.ksContext&&e.unregister(e.ksContext),e.register(t),e.ksContext=t),null)},e.handleEvent=function(t){if(!e.props.disabled){var n=e.props,a=n.alt,r=n.ctrl,i=n.meta,o=n.shift,s=n.vk,c=n.code,l=n.onShortcut;if(!("ignore"!==a&&t.altKey!==a||"ignore"!==r&&t.ctrlKey!==r||"ignore"!==i&&t.metaKey!==i||"ignore"!==o&&("useKey"===o&&void 0!==s?!/^Key[A-Z]$/.test(t.code)&&t.shiftKey:t.shiftKey!==o))&&(void 0!==s?u(t.key,s):u(t.code,c)))return l(t),!0}function u(e,t){return"string"!=typeof t?t.some(function(t){return u(e,t)}):e===t||("Spacebar"===e?" "===t:"Del"===e&&"Delete"===t)}},e}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentWillUnmount",value:function(){this.ksContext&&this.unregister(this.ksContext)}},{key:"render",value:function(){return Object(a.a)(d.a,{},void 0,this.consumeContext)}},{key:"register",value:function(e){e.addListener(this.handleEvent)}},{key:"unregister",value:function(e){e.removeListener(this.handleEvent)}}]),t}(u.a.PureComponent);h.defaultProps={alt:!1,ctrl:!1,meta:!1,shift:"useKey"}},317:function(e,t,n){"use strict";function a(){var e=n.c[9];return e&&e.exports.default}n.d(t,"a",function(){return a})},34:function(e,t,n){"use strict";n.r(t),n.d(t,"countStrlen",function(){return s}),n.d(t,"countTags",function(){return c}),n.d(t,"screen",function(){return l}),n.d(t,"tracking",function(){return u}),n.d(t,"EventTracker",function(){return d}),n.d(t,"toggleState",function(){return h});var a=n(29),r=n(0),i=n.n(r),o=n(2);function s(e,t,n){if(!e||!t||!n)return!1;var a=i()("#"+e).val().replace(/\r\n?/,"\n").length;n<a?i()("#"+t).html('<span class="error">'+a+"</span>"):i()("#"+t).html(a)}function c(e,t,n){if(!e||!t||!n)return!1;var a="".concat(i()("#"+e).val()).trim().split(/\s+|　+/);if(!a)return!1;var r=a.length;i()("#"+t).html(r>n?'<span class="error">'+r+"</span>":r)}i.a.browser={msie:o.a.ua.ie},window.countStrlen=s,window.countTags=c;var l={stash:[],setup:function(){i()(window).on("click",function(e){var t=i()(e.target);0===t.parents(".dialog").length&&0===t.closest("#favorite-button, #mypixiv-button").length&&l.close()})},register:function(e){"object"===Object(a.a)(e)&&"function"==typeof e.close&&this.stash.push(e)},unregister:function(e){for(var t=this.stash,n=0;n<t.length;++n)void 0===e&&t.splice(n,1)},close:function(e){var t=this.stash,n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;s!==e&&s.close()}}catch(e){a=!0,r=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}}},u={track:function(e){try{_gaq.push(e)}catch(e){}},event:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];u.track(["_trackEvent"].concat(t))},pageview:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];u.track(["_trackPageview"].concat(t))}},d={setup:function(){"/bookmark.php"===location.pathname&&location.search.match(/type=user/)&&i()('.column-action-menu input[type="submit"]').on("click",function(){try{_gaq.push(["_trackEvent","pixiv","ModBookmarkUser",i()(this).attr("name"),i()(".list_box input:checked").length])}catch(e){}}),"/mypixiv_all.php"===location.pathname&&i()('.column-action-menu input[type="submit"]').on("click",function(){try{_gaq.push(["_trackEvent","pixiv","ModMypixivUser",i()(this).attr("name"),i()(".list_box input:checked").length])}catch(e){}})}};function h(e){var t=i()(e).hasClass("disabled");return t?function(e){i()(e).removeClass("disabled").find("input").each(function(){var e=i()(this);e.closest(".disabled").length||e.prop("disabled",!1)})}(e):function(e){i()(e).addClass("disabled").find("input button").prop("disabled",!0)}(e),t}},346:function(e,t,n){"use strict";var a=n(29),r=n(0),i=n.n(r);i.a.fn.dataset=function(e,t){var n;if(void 0===e){var r={};if(!this.length||1!==this[0].nodeType)return r;for(var o,s=this[0].attributes,c=0,l=s.length;c<l;++c)0===(n=(o=s[c]).name).indexOf("data-")&&(r[i.a.fn.dataset.camelize(n.slice(5))]=o.value);return r}if("object"===Object(a.a)(e)){for(var u in e)n="data-"+i.a.fn.dataset.dashize(u),this.attr(n,e[u]);return this}return n="data-"+i.a.fn.dataset.dashize(e),void 0===t?this.attr(n):this.attr(n,t)};var o=/([a-z])([A-Z])/g,s=/-([a-z]|[0-9])/gi;i.a.fn.dataset.dashize=function(e){return e.replace(o,"$1-$2").toLowerCase()},i.a.fn.dataset.camelize=function(e,t){var n=e.replace(s,function(e,t){return t.toUpperCase()});return t?n.charAt(0).toUpperCase()+n.slice(1):n}},349:function(e,t,n){"use strict";var a=n(11),r=n(29),i=n(52),o=n(9),s=n(61),c=n(0),l=n.n(c),u=n(23);o.default.throttle=function(e,t,n){var a=null;return function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];if(!a){var c=this;e.apply(t||this,i),a=o.default.loop.timeout(function(){o.default.ua.ie?window.setTimeout(function(){a=null},0):a=null,e.apply(t||c,i)},null,n)}}},o.default.debounce=function(e,t,n){var a=function a(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var s=this;a.cancel(),a.timer=window.setTimeout(function(){a.timer=null,e.apply(t||s,i)},n||250)};return a.timer=null,a.cancel=function(){a.timer&&window.clearTimeout(a.timer)},a};o.default.Loop=function(e){(e||0===e)&&(this.delay=e),this.processes={}},o.default.Loop.prototype={delay:250,timer:null,processes:null,size:0,uid:0,cycle:0,interval:function(e,t,n){return Object(u.a)("Loop",!1).debug("set:",n||this.delay),this.processes[++this.uid]=[e,t,n,0],this.timer||this.start(),++this.size,this.uid},timeout:function(e,t,n){return this.interval(function(n){return e.call(t,n),!1},null,n)},clear:function(e){this.processes[e]&&(delete this.processes[e],--this.size||this.stop())},process:function(){++this.cycle;var e,t,n,a,r,i,o,s=this.processes,c=this.delay,l=this.cycle;for(i in s)e=(o=s[i])[0],t=o[1],n=o[2],a=o[3],(!n||n*(a+1)<=c*l)&&(!1===(r=e.call(t,a))?this.clear(i):"number"==typeof r&&r!==c&&(o[2]=r),++o[3])},start:function(){var e=this;Object(u.a)("Loop",!1).debug("start:",this.delay),this.stop(),this.timer=setInterval(function(){e.process()},this.delay)},stop:function(){this.timer&&(Object(u.a)("Loop",!1).debug("stop:",this.delay),clearInterval(this.timer),this.timer=null),this.cycle=0},reset:function(){this.stop(),this.processes=[]}},o.default.loop=new o.default.Loop,o.default.async=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=l.a.Deferred();return window.setTimeout(function(){a.resolveWith(null,t)},100),a.promise()},o.default.addTimeout=function(e,t){var n=e,a=t;return"[object Object]"!==Object.prototype.toString.call(n)&&(a=n,n=null),n||(n=l.a.Deferred()),a=a||0===a?a:o.default.config.timeout,window.setTimeout(function(){Object(u.a)("addTimeout").debug("timed out",a),n.reject(null,"timeout")},a),n},s.b("colon.req.fire",function(e){var t;(t=o.default.req).fire.apply(t,Object(i.a)(e))}),o.default.req={queue:{},id:function(e,t,n){var a,i=e,o=t,s=n;return"object"!==Object(r.a)(o)&&1!==arguments.length||(s=o,o=i,i="GET"),window.FormData&&s instanceof FormData?null:(s&&(a=-1===o.indexOf("?")?"?":"&"),i.toUpperCase()+"+"+o+(s?a+l.a.param(s):""))},storeObject:function(e){return function(t,n){return o.default.storage.localStorage(t,n,e)}},to:function(e,t,n,i){var s,c,d,h=i||{},p=n;if(window.FormData&&p instanceof FormData?(h.ajaxSettings||(h.ajaxSettings={}),h.ajaxSettings.contentType=!1,h.ajaxSettings.processData=!1):null==p||"object"!==Object(r.a)(p)||Array.isArray(p)||(p=o.default.query.slim(p)),"GET"===e&&(void 0===h.cache&&(h.cache=1e4),h.cache)){var f=this.id(e,t,p);if("function"==typeof h.cache_callback&&h.cache_callback(f),(s=o.default.storeObject(h.cache,f))&&(c=s())&&"..."!==c)return Object(u.a)("colon.req").debug("restore cache",c),o.default.async(c,"cache",null,s)}return d=this.unite(null,function(){var n=l.a.ajax(Object(a.a)({type:e,url:t,data:p,dataType:"json",timeout:o.default.config.timeout},h.ajaxSettings));return h.filter&&(n=n.done(h.filter)),n}),s&&(d=d.then(function(e){s(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return n.push(s),l.a.Deferred().resolveWith(this,[e].concat(n))})),d.always(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object(u.a)("colon.req").debug("result",this,t)}),d.promise()},unite:function(e,t){var n;return e&&0===e.indexOf("GET")?this.loading(e)?(Object(u.a)("colon.req.unite").debug("add queue",e),n=l.a.Deferred(),this.queue[e]||(this.queue[e]=[]),this.queue[e].push(n),n):(Object(u.a)("colon.req.unite").debug("new request"),o.default.storage.localStorage(e,"...",o.default.config.timeout),this.queue[e]=[],t().done(function(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];var i=[!0,e,a];s.c("colon.req.fire",i),(t=o.default.req).fire.apply(t,i)}).fail(function(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];var i=[!1,e,a];s.c("colon.req.fire",i),(t=o.default.req).fire.apply(t,i)}).always(function(){"..."===o.default.storage.localStorage(e)&&o.default.storage.localStorage(e,null),delete o.default.req.queue[e]})):(Object(u.a)("colon.req.unite").debug("skip "+(e?e.slice(0,e.indexOf("+"))+" method":" request"),e),t())},loading:function(e){return!(!this.queue[e]&&"..."!==o.default.storage.localStorage(e))},fire:function(e,t,n){var a,r=o.default.req.queue[t];if(r){a=e?"resolveWith":"rejectWith";for(var i,s=0;i=r[s];++s)i[a](void 0,n)}}},["GET","POST","PUT","DELETE"].forEach(function(e){o.default.req[e.toLowerCase()]=function(t,n,a){return o.default.req.to(e,t,n,a)}}),o.default.get={css:function(e){var t=document.createElement("link");t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)},script:function(e){return l.a.ajax({url:e,dataType:"script",cache:!0,scriptCharset:"utf-8"})}}},36:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var a=n(178);function r(e,t){return Object(a.shallowEqual)(e,t)?e:t}function i(e){}},39:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"f",function(){return d}),n.d(t,"d",function(){return p}),n.d(t,"e",function(){return m});var a,r,i,o=n(3),s=n.n(o),c=n(6),l=n(37),u=n.n(l);function d(e,t,n){return h.apply(this,arguments)}function h(){return(h=Object(c.a)(s.a.mark(function e(t,n,a){var r,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/ajax/mute/items",{},{context:n,id:a});case 2:return r=e.sent,i=r.mute_items,e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function p(e,t,n){return f.apply(this,arguments)}function f(){return(f=Object(c.a)(s.a.mark(function e(t,n,a){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post("/ajax/mute/items/add",{},u.a.stringify({context:a,type:n.type,value:n.value}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function m(e,t,n){return v.apply(this,arguments)}function v(){return(v=Object(c.a)(s.a.mark(function e(t,n,a){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post("/ajax/mute/items/delete",{},u.a.stringify({context:a,type:n.type,value:n.value}));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}!function(e){e.Illust="illust",e.Novel="novel",e.User="user",e.Setting="setting"}(a||(a={})),function(e){e.Candidate="candidate",e.Existing="existing"}(r||(r={})),function(e){e.User="user",e.Tag="tag"}(i||(i={}))},391:function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l});var a,r=n(11),i=n(32),o=n(36);function s(){return{type:a.OpenModal,payload:{}}}function c(){return{type:a.CloseModal,payload:{}}}!function(e){e.OpenModal="pixiv/TagTranslationSuggestion/OPEN_MODAL",e.CloseModal="pixiv/TagTranslationSuggestion/CLOSE_MODAL"}(a||(a={})),t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isModalOpen:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.OpenModal:if(!e.isModalOpen)return Object(r.a)({},e,{isModalOpen:!0});break;case a.CloseModal:if(e.isModalOpen)return Object(r.a)({},e,{isModalOpen:!1});break;default:Object(o.b)(t)}return e};var l=Object(i.createSelector)(function(e){return e.tagTranslationSuggestion},function(e){return e.isModalOpen})},396:function(e,t,n){e.exports={required:"_1te--GO"}},398:function(e,t,n){e.exports={body:"_2lc9x3V"}},41:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return m});var a=n(3),r=n.n(a),i=n(6),o=n(2),s=n(50),c=n(205);function l(e){return null!=e&&"boolean"==typeof e.error&&"body"in e}function u(e,t,n){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(r.a.mark(function e(t,n,a){var i,u,d,h,p=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=p.length>3&&void 0!==p[3]?p[3]:{},u=Object(c.a)(n,i),e.prev=2,e.next=5,Promise.resolve(o.a.req.to(t,u,a,i));case 5:return d=e.sent,e.abrupt("return",d);case 9:if(e.prev=9,e.t0=e.catch(2),!l(e.t0.responseJSON)){e.next=13;break}return e.abrupt("return",e.t0.responseJSON);case 13:if(!e.t0.statusText){e.next=16;break}throw h=e.t0,new s.a(h.status,h.statusText);case 16:if(e.t0 instanceof Error){e.next=18;break}throw new Error(e.t0);case 18:throw e.t0;case 19:case"end":return e.stop()}},e,this,[[2,9]])}))).apply(this,arguments)}function h(){return(h=Object(i.a)(r.a.mark(function e(t,n,a){var i,o,c=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>3&&void 0!==c[3]?c[3]:{},e.next=3,u(t,n,a,i);case 3:if(!(o=e.sent).error){e.next=6;break}throw new s.b(o.message||"未定義APIエラー");case 6:return e.abrupt("return",o.body);case 7:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var p=function(e){return function(t,n,a){return function(e,t,n){return h.apply(this,arguments)}(e,t,n,a)}},f=p("GET"),m=p("POST");p("PUT"),p("DELETE")},411:function(e,t,n){"use strict";n.d(t,"c",function(){return y}),n.d(t,"b",function(){return w}),n.d(t,"a",function(){return C});var a=n(29),r=n(3),i=n.n(r),o=n(6),s=n(28),c=n(52),l=n(11),u=n(7),d=n(8),h=n(2),p=n(0),f=n.n(p),m=n(10),v=n(19),g=n(118),b=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;
/*!
 * Thanks to http://snippets.dzone.com/posts/show/452
 */
function y(e){return b.test(e)}var k=/(http|https):\/\/(\w+\.pixiv\.net.*|p\.tl\/i\/\d+|p\.tl\/e\/\d+|p\.tl\/t\/\d+)/;function w(e){return k.test(e)}var _="default";
/*!
 * Thanks to http://stackoverflow.com/a/4399718/2864502
 */
function x(e){return e.find(":not(iframe)").addBack().contents().filter(function(){return 3===this.nodeType})}function j(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(!(e.length<1)){var a=t?_:"default";if(void 0===n)switch(a){case"default":return e.scrollLeft();case"negative":return e.scrollLeft()+e.get(0).scrollWidth-e.width();case"reverse":return e.width()-e.scrollLeft();default:return Object(v.i)(a)}switch(a){case"default":return e.scrollLeft(n);case"negative":return e.scrollLeft(n-e.get(0).scrollWidth+e.width());case"reverse":return e.scrollLeft(e.width()-n);default:return Object(v.i)(a)}}}!function(){!function(){for(var e=document.createElement("div"),t=["writing-mode: tb-rl;","writing-mode: vertical-rl;","-o-writing-mode: vertical-rl;","-ms-writing-mode: tb-rl;","-ms-writing-mode: vertical-rl;","-moz-writing-mode: vertical-rl;","-webkit-writing-mode: vertical-rl;"],n=0;n<t.length;n++){var a=t[n];e.style.cssText=a;var r=e.style,i=r.writingMode,o=r.webkitWritingMode;if("tb-rl"===i||"vertical-rl"===i||"tb-rl"===o||"vertical-rl"===o)return!0}return!1}()?f()("html").addClass("no-verticaltext"):f()("html").addClass("verticaltext");!function(){for(var e=document.createElement("span"),t=["text-combine-upright: all;","-o-text-combine-upright: all;","-ms-text-combine-upright: all;","-moz-text-combine-upright: all;","-webkit-text-combine-upright: all;"],n=0;n<t.length;n++){var a=t[n];e.style.cssText=a;var r=e.style,i=r.textCombineUpright,o=r.webkitTextCombineUpright;if("all"===i||"all"===o)return!0}return!1}()?f()("html").addClass("no-textcombine"):f()("html").addClass("textcombine");navigator.userAgent.includes("Edge/")&&f()(":root").addClass("edge")
/*!
   * jQuery RTL Scroll Type Detector | Copyright (c) 2012 Wei-Ko Kao | MIT License
   */;f()(function(){var e=f()("<div/>",{text:"A",css:{fontSize:"14px",width:"1px",height:"1px",position:"absolute",top:"-1000px",overflow:"scroll",writingMode:"tb-rl",OWritingMode:"vertical-rl",MsWritingMode:"tb-rl",MozWritingMode:"vertical-rl",WebkitWritingMode:"vertical-rl"}});e.css({writingMode:"vertical-rl",MsWritingMode:"vertical-rl"});var t=e.appendTo("body")[0],n="reverse";t.scrollLeft>0?n="default":(t.scrollLeft=1,0===t.scrollLeft&&(n="negative")),f()(t).remove(),_=n})}();var O={writingMode:"horizontal",font:"sans-serif",size:"medium",line:"normal",scrollMode:"scroll",theme:"white",horizontalView:"classic",instantFullscreen:!0,preventHashChange:!1},C=function(){function e(t){Object(u.a)(this,e),this.rawBody="",this.page=0,this.pagesize=0,this.config=Object(l.a)({},O),this.clickCounter={},this.id="0",this.marker=null,this.markers=null,this.chapters=[],this.readChars=0,this.fullscreen=!1,this.sentEvent={enableFullscreen:!1},this.onIllustLoad=this.onIllustLoad.bind(this),this.onResizeInFullscreen=this.onResizeInFullscreen.bind(this),this.onFullscreenScroll=this.onFullscreenScroll.bind(this),this.onMousewheel=this.onMousewheel.bind(this),this.$root=f()(t),this.$extendedBackground=this.$root.parents(".novel-extended-background"),this.$text=this.$root.find("#novel_text"),this.$body=this.$root.find(".novel-body"),this.$textWrapper=this.$root.find(".novel-pages"),this.$pagerPrev=this.$root.find(".pager-prev"),this.$pagerNext=this.$root.find(".pager-next"),this.$pagerPage=this.$root.find(".pager-page"),this.$quitFullscreenButton=this.$root.find(".novel-quit-fullscreen"),this.$writingModeController=this.$root.find(".controller-writing-mode"),this.$fontController=this.$root.find(".controller-font"),this.$markerController=this.$root.find(".controller-marker"),this.$insertMarkerButton=this.$root.find(".insert-marker"),this.$destroyMarkerButton=this.$root.find(".destroy-marker"),this.$followMarkerButton=this.$root.find(".follow-marker"),this.$scrollFollower=this.$root.find(".scroll-follower"),this.$enableFullscreenButton=this.$root.find(".enable-fullscreen"),this.$bodyMarker=this.$root.find(".body-marker"),this.$scrollerPrev=this.$root.find(".scroller-prev"),this.$scrollerNext=this.$root.find(".scroller-next"),this.$configController=this.$root.find(".controller-config"),this.$markerTooltip=this.$root.find(".novel-tooltip-marker"),this.$configTooltip=this.$root.find(".novel-tooltip-config"),this.$sizeChoices=this.$root.find(".novel-size input"),this.$lineChoices=this.$root.find(".novel-line input"),this.$scrollModeChoices=this.$root.find(".novel-scroll-mode input"),this.$themeChoices=this.$root.find(".novel-theme"),this.$markerList=this.$root.find(".marker-list"),this.$chapterList=f()("#novel_chapter"),this.$pixivimages=f()(),this.illustIds=[],this.meta={workId:this.$root.data("workid"),explicit:this.$root.data("explicit"),permission:this.$root.data("permission"),userId:this.$root.data("userid")},this.page=0,this.rawBody=this.$text.val(),this.id=m.default.context.workId,this.marker=m.default.context.marker;try{this.params=JSON.parse(m.default.context.serialized_value)}catch(e){this.params={}}this.niceScrollEnabled=!("safari"in window),this.generate(),this.updateChapters(),this.bind(),this.niceScrollEnabled&&(this.niceScrollProps={zindex:10001,rtlmode:!0,verticalmode:!0,mousescrollstep:60,scrollspeed:30,autohidemode:"scroll",cursoropacitymin:0,cursoropacitymax:.5,enablekeyboard:!1,onmousewheel:this.onMousewheel,noscrolllength:1},this.$textWrapper.niceScroll(this.niceScrollProps),this.niceScroll=this.$textWrapper.getNiceScroll());var n=this.getHash()||0;Array.isArray(n)&&this.chapterTo(n[0],n[1],{preventHashChange:!0}),"number"==typeof n&&this.pageTo(n,{preventScroll:!0,preventHashChange:!0}),this.config=Object(l.a)({},this.config,h.a.storage.localStorage("novel_config")),this.clickCounter=Object(l.a)({},this.clickCounter,h.a.storage.localStorage("novel_click_counter")),h.a.storage.localStorage("novel_seen_fullscreen_button")||(this.$enableFullscreenButton.trigger("mouseenter"),h.a.storage.localStorage("novel_seen_fullscreen_button",!0)),h.a.ga.trackEvent(["novel","view_with_theme",this.config.theme]);var a=this.clickCounter.writingMode?this.config.writingMode:"default";if(h.a.ga.trackEvent(["novel","view_with_writing_mode",a]),"vertical"===this.config.writingMode){var r=this.clickCounter.scrollMode?this.config.scrollMode:"default";h.a.ga.trackEvent(["novel","view_with_scroll_mode",r])}a=this.params.view_mode?{1:"vertical",2:"horizontal"}[this.params.view_mode]||"horizontal":this.config.writingMode,this.setFont(this.config.font),this.setSize(this.config.size,{preventReadCharsSync:!0}),this.setLine(this.config.line,{preventReadCharsSync:!0}),this.setScrollMode(this.config.scrollMode),this.setTheme(this.config.theme),this.setHorizontalView("classic",{preventReadCharsSync:!0}),this.setInstantFullscreen(this.config.instantFullscreen),this.setWritingMode(a,{preventReadCharsSync:!0,preventStoreConfig:!0}),this.updateMarker(),this.updateScrollers(!1),this.updateFullscreenState(),this.$root.removeClass("novel-loading")}return Object(d.a)(e,[{key:"onKeypress",value:function(e){switch(e){case"up":if("vertical"===this.config.writingMode){var t=this.$pages.get(this.page).getBoundingClientRect();return!(t.bottom>=0&&t.bottom<h.a.w.height()&&t.top>=0&&t.top<h.a.w.height())||(this.pagePrev(),!1)}return!0;case"down":if("vertical"===this.config.writingMode){var n=this.$pages.get(this.page).getBoundingClientRect();return!(n.bottom>=0&&n.bottom<h.a.w.height()&&n.top>=0&&n.top<h.a.w.height())||(this.pageNext(),!1)}return!0;case"left":if("horizontal"===this.config.writingMode)this.pagePrev();else if(this.countUpClick("scroller"),"scroll"===this.config.scrollMode)if(!1===this.fullscreen)if(this.niceScrollEnabled)this.$pages.eq(this.page).getNiceScroll(0).doScrollLeftBy(120);else{var a=this.$pages.eq(this.page),r=a.scrollLeft()-120;a[0].scroll({left:r,behavior:"smooth"})}else if(this.niceScrollEnabled)this.$textWrapper.getNiceScroll(0).doScrollLeftBy(120);else{var i=this.$pages.eq(this.page),o=i.scrollLeft()-120;i[0].scroll({left:o,behavior:"smooth"})}else this.pageDown();return!1;case"right":if("horizontal"===this.config.writingMode)this.pageNext();else if(this.countUpClick("scroller"),"scroll"===this.config.scrollMode)if(!1===this.fullscreen)if(this.niceScrollEnabled)this.$pages.eq(this.page).getNiceScroll(0).doScrollLeftBy(-120);else{var s=this.$pages.eq(this.page),c=s.scrollLeft()+120;s[0].scroll({left:c,behavior:"smooth"})}else if(this.niceScrollEnabled)this.$textWrapper.getNiceScroll(0).doScrollLeftBy(-120);else{var l=this.$pages.eq(this.page),u=l.scrollLeft()+120;l[0].scroll({left:u,behavior:"smooth"})}else this.pageUp();return!1;case"space":return"vertical"!==this.config.writingMode&&!1!==this.fullscreen||(h.a.w.scrollTop()<this.$root.offset().top?h.a.w.scrollTop(this.$root.offset().top):(this.countUpClick("scroller"),this.pageDown()),!1);case"pageup":return"vertical"!==this.config.writingMode||(this.countUpClick("scroller"),this.pageUp(),!1);case"pagedown":return"vertical"!==this.config.writingMode&&!1!==this.fullscreen||(h.a.w.scrollTop()<this.$root.offset().top?h.a.w.scrollTop(this.$root.offset().top):(this.countUpClick("scroller"),this.pageDown()),!1);case"escape":return!0!==this.fullscreen||(this.disableFullscreen(),!1);case"v":return this.toggleFullscreen(),!1}return Object(v.i)(e)}},{key:"parseSinglePage",value:function(e){var t=this,n=this.$pages.eq(e);if(!(n.length<1)){var a=n.data("unparsedText");if(a){n.removeData("unparsedText");var r=0,i=!1,o=[];a.replace(/\r\n?/g,"\n").split("\n").forEach(function(n){if(""===n)return o.push(f()("<br>")),!0;var a=new PixivNovelParser.Parser;a.parse(n);var l=function(n){return n.map(function(n){if("text"===n.type)return f()(document.createTextNode(n.val));if("rb"===n.name)return f()("<ruby/>").append([f()("<rb/>",{text:n.rubyBase}),f()("<rt/>",{text:n.rubyText})]);if("chapter"===n.name){var a=f()("<h4/>",{class:"chapter",id:"chapter_".concat(e,"_").concat(r)}).append(u(n.title));return r++,a}if("pixivimage"===n.name){var o=null===n.pageNumber?n.illustID:n.illustID+"-"+n.pageNumber;if(i)return f()("<span/>",{class:"error",text:h.a.t("【エラー: 1ページ内に挿入できる挿絵タグは1つまでです】")});var s=f()("<span/>",{class:"novelimage novelimage-".concat(o),data:{illust_id:o}}).append(f()("<a/>",{href:"/member_illust.php?mode=medium&illust_id=".concat(o),target:"_blank"}).append(f()("<img/>",{src:"https://s.pximg.net/source/pixpedia/images/noimage300.gif"})));return i=!0,t.$pixivimages=t.$pixivimages.add(s),-1===f.a.inArray(o,t.illustIds)&&t.illustIds.push(o),s}if("jump"===n.name){var c=parseInt(n.pageNumber,10);return isNaN(c)||c<=0?f()("<span/>",{class:"error",text:h.a.t("【エラー: 小説内リンクに指定できないページです】")}):f()("<a/>",{class:"novel-jump",href:"#".concat(c),text:h.a.t("$1ページへ",c),data:{target:c}})}if("jumpuri"===n.name){var l=u(n.title),d=l.map(function(e){return e.text()}).join("");return""!==d&&""!==n.uri&&y(n.uri)?w(n.uri)?f()("<a/>",{href:n.uri}).append(l):f()("<a/>",{href:"/jump.php?".concat(encodeURIComponent(n.uri)),target:"_blank"}).append(l):f()(document.createTextNode(d))}return Object(v.i)(n)})},u=l,d=f()("<p/>").append(l(a.tree));return x(d).each(function(e,t){var n;if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var a=t.nodeValue.split(/([“„〝"].+?[”“〟〞"])/);if(!(a.length<2)){var r=a.map(function(e,t){if(t%2==1){var n=e.slice(1,-1);return(n.match(/[\x00-\x7F]/g)||[]).length/n.length>.5?[f()("<span/>",{text:e.slice(0,1),class:"vtoken",data:{vertical:"“",horizontal:e.slice(0,1)}}),document.createTextNode(n),f()("<span/>",{text:e.slice(-1),class:"vtoken",data:{vertical:"”",horizontal:e.slice(-1)}})]:[f()("<span/>",{text:e.slice(0,1),class:"vtoken",data:{vertical:"〝",horizontal:e.slice(0,1)}}),document.createTextNode(n),f()("<span/>",{text:e.slice(-1),class:"vtoken",data:{vertical:"〟",horizontal:e.slice(-1)}})]}return[document.createTextNode(e)]});f()(t).replaceWith((n=[]).concat.apply(n,Object(c.a)(r)))}}}),x(d).each(function(e,t){var n;if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var a=t.nodeValue.split(/([`‘‚｀‵].+?[`’｀′])/);if(!(a.length<2)){var r=a.map(function(e,t){if(t%2==1){var n=e.slice(1,-1);return(n.match(/[\x00-\x7F]/g)||[]).length/n.length>.5?[f()("<span/>",{text:e.slice(0,1),class:"vtoken",data:{vertical:"‘",horizontal:e.slice(0,1)}}),document.createTextNode(n),f()("<span/>",{text:e.slice(-1),class:"vtoken",data:{vertical:"’",horizontal:e.slice(-1)}})]:[f()("<span/>",{text:e.slice(0,1),class:"vtoken",data:{vertical:"‵",horizontal:e.slice(0,1)}}),document.createTextNode(n),f()("<span/>",{text:e.slice(-1),class:"vtoken invert",data:{vertical:"′",horizontal:e.slice(-1)}})]}return[document.createTextNode(e)]});f()(t).replaceWith((n=[]).concat.apply(n,Object(c.a)(r)))}}}),x(d).each(function(e,t){if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var n=t.nodeValue.split(/([\d０-９]+)/);if(!(n.length<2)){var a=n.map(function(e,n,a){return n%2==1?(a[n-1]?a[n-1].slice(-1):f()(t).prev().text()?(f()(t).prev().data("vertical")||f()(t).prev().text()).slice(-1):"").match(/[\x00-\x7F]/)?f()("<span/>",{text:e,class:"vtoken",data:{vertical:r(e),horizontal:e}}):2===e.length||3===e.length?f()("<span/>",{text:e,class:"vtoken combine",data:{vertical:r(e),horizontal:e}}):f()("<span/>",{text:e,class:"vtoken",data:{vertical:function(e){return e.replace(/[\d０-９]/g,function(e){return{0:"０",1:"１",2:"２",3:"３",4:"４",5:"５",6:"６",7:"７",8:"８",9:"９","０":"０","１":"１","２":"２","３":"３","４":"４","５":"５","６":"６","７":"７","８":"８","９":"９"}[e]})}(e),horizontal:e}}):document.createTextNode(e);function r(e){return e.replace(/[\d０-９]/g,function(e){return{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9"}[e]})}});f()(t).replaceWith(a)}}}),x(d).each(function(e,t){if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var n=t.nodeValue.split(/([｢｣､｡￩￪￫￬･])/);if(!(n.length<2)){var a=n.map(function(e,t){return t%2==1?f()("<span/>",{text:e,class:"vtoken",data:{vertical:{"｢":"「","｣":"」","､":"、","｡":"。","￩":"←","￪":"↑","￫":"→","￬":"↓","･":"・"}[e],horizontal:e}}):document.createTextNode(e)});f()(t).replaceWith(a)}}}),x(d).each(function(e,t){if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var n=t.nodeValue.split(/([—―])/);if(!(n.length<2)){var a=n.map(function(e,t){return t%2==1?f()("<span/>",{text:e,class:"vtoken",data:{vertical:"─",horizontal:e}}):document.createTextNode(e)});f()(t).replaceWith(a)}}}),x(d).each(function(e,t){if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var n=t.nodeValue.split(/([,.，．])/);if(!(n.length<2)){var a=n.map(function(e,n,a){if(n%2==1){var r=a[n-1]?a[n-1].slice(-1):f()(t).prev().text()?(f()(t).prev().data("vertical")||f()(t).prev().text()).slice(-1):"",i=""===r||r.match(/[\x00-\x7F]/)?e.replace(/[，．]/g,function(e){return{"，":",","．":"."}[e]}):e.replace(/[,.]/g,function(e){return{",":"，",".":"．"}[e]});return f()("<span/>",{text:e,class:"vtoken",data:{vertical:i,horizontal:e}})}return document.createTextNode(e)});f()(t).replaceWith(a)}}}),x(d).each(function(e,t){if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var n=t.nodeValue.split(/([!?！？]+)/);if(!(n.length<2)){var a=n.map(function(e,n,a){if(n%2==1){var r=a[n-1]?a[n-1].slice(-1):f()(t).prev().text()?(f()(t).prev().data("vertical")||f()(t).prev().text()).slice(-1):"",i=a[n+1]?a[n+1].slice(0,1):f()(t).next().text()?(f()(t).next().data("vertical")||f()(t).next().text()).slice(0,1):"";if(r.match(/[\x00-\x7F]/)){var o=e.replace(/[！？]/g,function(e){return{"！":"!","？":"?"}[e]});return f()("<span/>",{text:e,class:"vtoken",data:{vertical:o,horizontal:e}})}var s=new Set(["vtoken"]);2!==e.length&&3!==e.length||s.add("combine");var l=2===e.length||3===e.length?e.replace(/[！？]/g,function(e){return{"！":"!","？":"?"}[e]}):e.replace(/[!?]/g,function(e){return{"!":"！","?":"？"}[e]});return""===i||"　"===i||i.match(/^[\u0029\u005d\u007d\u0f3b\u0f3d\u169c\u2046\u207e\u208e\u2309\u230b\u232a\u2769\u276b\u276d\u276f\u2771\u2773\u2775\u27c6\u27e7\u27e9\u27eb\u27ed\u27ef\u2984\u2986\u2988\u298a\u298c\u298e\u2990\u2992\u2994\u2996\u2998\u29d9\u29db\u29fd\u2e23\u2e25\u2e27\u2e29\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\ufd3e\ufe18\ufe36\ufe38\ufe3a\ufe3c\ufe3e\ufe40\ufe42\ufe44\ufe48\ufe5a\ufe5c\ufe5e\uff09\uff3d\uff5d\uff60\uff63]$/)||s.add("margin-after"),f()("<span/>",{text:e,class:Object(c.a)(s).join(" "),data:{vertical:l,horizontal:e}})}return document.createTextNode(e)});f()(t).replaceWith(a)}}}),x(d).each(function(e,t){if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var n=t.nodeValue.split(/([A-Za-zＡ-Ｚａ-ｚ]+)/);if(!(n.length<2)){var a=n.reduce(function(e,t,n,a){if(0===n)return[t];if(n%2==1){var r=a[n+1];return 2===t.length?e.concat(t,r):e.slice(0,-1).concat(e[e.length-1]+t+r)}return e},[]);if(!(a.length<2)){var r=a.map(function(e,a){if(a%2==1){var r=n[a-1]?n[a-1].slice(-1):f()(t).prev().text()?(f()(t).prev().data("vertical")||f()(t).prev().text()).slice(-1):"",i=n[a+1]?n[a+1].slice(0,1):f()(t).next().text()?(f()(t).next().data("vertical")||f()(t).next().text()).slice(0,1):"";return r.match(/[\x00-\x2F\x3A-\x7F]/)||i.match(/[\x00-\x2F\x3A-\x7F]/)?document.createTextNode(e):f()("<span/>",{text:e,class:"vtoken combine",data:{vertical:function(e){return e.replace(/[Ａ-Ｚａ-ｚ]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})}(e),horizontal:e}})}return document.createTextNode(e)});f()(t).replaceWith(r)}}}}),x(d).each(function(e,t){if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var n=t.nodeValue.split(/([A-Z]+)/);if(!(n.length<2)){var a=n.map(function(e,n,a){if(n%2==1){var r=a[n-1]?a[n-1].slice(-1):f()(t).prev().text()?(f()(t).prev().data("vertical")||f()(t).prev().text()).slice(-1):"",i=a[n+1]?a[n+1].slice(0,1):f()(t).next().text()?(f()(t).next().data("vertical")||f()(t).next().text()).slice(0,1):"";return r.match(/[\x00-\x7F’]/)||i.match(/[\x00-\x7F’]/)?document.createTextNode(e):f()("<span/>",{text:e,class:"vtoken",data:{vertical:function(e){return e.replace(/[A-Z]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+65248)})}(e),horizontal:e}})}return document.createTextNode(e)});f()(t).replaceWith(a)}}}),x(d).each(function(e,t){if(!f()(t).parent().hasClass("vtoken")&&!f()(t).parent().hasClass("combine")){var n=t.nodeValue.split(/(.[゛ﾞ゜ﾟ])/);if(!(n.length<2)){var a=n.map(function(e,t){if(t%2==1){var n=Object(s.a)(e,2),a=n[0],r={"゛":"゛","ﾞ":"゛","゜":"゜","ﾟ":"゜"}[n[1]]+a;return f()("<span/>",{text:e,class:"vtoken",data:{vertical:r,horizontal:e}})}return document.createTextNode(e)});f()(t).replaceWith(a)}}}),d.is(":empty")?void 0:o.push(d)}),n.append(o),n.find("span.novelimage").length>0&&this.loadIllusts()}}}},{key:"generate",value:function(){var e=this;if(""===this.rawBody)return!1;var t=this.rawBody,n=new PixivNovelParser.Parser;t.split("[newpage]").forEach(function(t,a){var r=0;n.parse(t),n.tree.map(function(t){if("text"!==t.type&&"chapter"===t.name){var n=t.title[0],i="";"text"===n.type?i=n.val:"rb"===n.name&&(i=n.rubyBase),""!==i&&(e.chapters=e.chapters.concat({title:i,page:a,chapter:r++}))}});var i=f()("<div/>",{class:"novel-page",id:"page-".concat(a+1)});return i.data("unparsedText",t),i.hide(),a>0&&e.$text.before(f()("<hr>",{class:"novel-page-split","data-page":a+1})),e.$text.before(i)}),this.$text.remove(),this.$textWrapper.css("display","inline-block"),this.niceScrollEnabled||this.$textWrapper.addClass("normal-scroll"),this.$pages=this.$textWrapper.find(".novel-page"),this.pagesize=this.$pages.length,this.$root.find("span.novel-jump").each(function(t,n){var a=f()(n),r=parseInt(a.data("target"),10);(isNaN(r)||r<=0||e.pagesize<r)&&a.replaceWith(f()("<span/>",{class:"error",text:h.a.t("【エラー: 小説内リンクに指定できないページです】")}))})}},{key:"loadIllusts",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve(g.d(this.meta.workId,this.meta.userId,m.default.context.updated||+new Date/1e3,this.illustIds,this.meta.explicit,this.meta.permission));case 2:return t=e.sent,this.onIllustLoad(t),e.abrupt("return",t);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onIllustLoad",value:function(e){var t=this;e&&Array.isArray(e)&&e.forEach(function(e){t.$pixivimages.filter(function(t,n){return f()(n).data("illust_id")===e.id}).replaceWith(e.html)})}},{key:"updateChapters",value:function(){var e=this;this.chapters.forEach(function(t){return e.$chapterList.find(".novel-outline").append(f()("<li/>").append([f()("<a/>",{href:"#chapter_".concat(t.page,"_").concat(t.chapter),text:t.title}),f()("<em/>",{text:t.page+1})]))}),this.chapters.length>0&&this.$chapterList.show()}},{key:"bind",value:function(){var e=this;this.$root.on("click",function(t){e.onClick(t.target)}),h.a.w.on("hashchange.novel",function(){e.onHashChange()}),h.a.w.on("scroll.novel",function(){e.updateScrollFollower()}),this.$pagerPrev.on("click",function(){e.countUpClick("pager"),e.pagePrev()}),this.$pagerNext.on("click",function(){e.countUpClick("pager"),e.pageNext()}),this.$quitFullscreenButton.on("click",function(){e.disableFullscreen()}),this.$writingModeController.on("click",function(){e.countUpClick("writingMode"),f()(".vertical-new").hide(),e.toggleWritingMode()}),this.$fontController.on("click",function(){e.countUpClick("font"),e.toggleFont()}),this.$sizeChoices.on("click",function(t){e.countUpClick("size"),e.setSize(f()(t.target).data("size"))}),this.$lineChoices.on("click",function(t){e.countUpClick("line"),e.setLine(f()(t.target).data("line"))}),this.$scrollModeChoices.on("click",function(t){e.countUpClick("scrollMode"),e.setScrollMode(f()(t.target).data("scroll-mode"))}),this.$themeChoices.on("click",function(t){e.countUpClick("theme"),e.setTheme(f()(t.target).data("theme"))}),this.$markerController.on("click",function(){e.toggleMarkerTooltip()}),this.$insertMarkerButton.on("click",function(){e.setMarker(e.page)}),this.$destroyMarkerButton.on("click",function(){e.destroyMarker()}),this.$followMarkerButton.on("click",function(){"number"==typeof e.marker&&e.pageTo(e.marker)}),this.$configController.on("click",function(){e.toggleConfigTooltip()}),this.$bodyMarker.on("click",function(){e.$bodyMarker.hasClass("active")?e.destroyMarker():e.setMarker(e.page)}),this.$scrollerPrev.on("click",function(){return e.countUpClick("scroller"),e.$scrollerPrev.hasClass("pager-mode")?e.pagePrev({scrollToBottom:!0}):e.pageUp()}),this.$scrollerNext.on("click",function(){e.countUpClick("scroller"),e.$scrollerNext.hasClass("pager-mode")?e.pageNext():e.pageDown()}),this.$pages.on("scroll",function(){e.updateScrollers(!0)}),this.$enableFullscreenButton.on("click",function(){!1===e.fullscreen&&(e.countUpClick("fullscreen"),e.enableFullscreen())}),this.$textWrapper.on("scroll",function(){!0===e.fullscreen&&e.onFullscreenScroll()}),this.$body.on("scroll",function(){!0===e.fullscreen&&e.onFullscreenScroll()}),h.a.w.on("unload.novel",function(){return h.a.storage.localStorage("novel_click_counter",e.clickCounter)}),h.a.w.on("popstate.novel",function(){return e.updateFullscreenState()}),h.a.w.on("resize.novel",function(){return e.updateScrollFollower()})}},{key:"onClick",value:function(e){function t(t){return t.get(0)===e||0!==t.has(e).length}t(this.$markerTooltip)||t(this.$markerController)||this.hideMarkerTooltip(),t(this.$configTooltip)||t(this.$configController)||this.hideConfigTooltip()}},{key:"onHashChange",value:function(){var e=this.getHash();null!==e&&("object"===Object(a.a)(e)&&this.chapterTo(e[0],e[1],{preventHashChange:!0}),"number"==typeof e&&this.page!==e&&this.pageTo(e,{preventHashChange:!0}))}},{key:"toggleMarkerTooltip",value:function(){this.$markerController.hasClass("active")?this.hideMarkerTooltip():this.showMarkerTooltip()}},{key:"showMarkerTooltip",value:function(){null===this.markers&&this.loadMarkers(),this.$markerController.addClass("active"),this.$markerTooltip.show()}},{key:"hideMarkerTooltip",value:function(){this.$markerController.removeClass("active"),this.$markerTooltip.hide()}},{key:"toggleConfigTooltip",value:function(){this.$configController.hasClass("active")?this.hideConfigTooltip():this.showConfigTooltip()}},{key:"showConfigTooltip",value:function(){this.$configController.addClass("active"),this.$configTooltip.show()}},{key:"hideConfigTooltip",value:function(){this.$configController.removeClass("active"),this.$configTooltip.hide()}},{key:"toggleFullscreen",value:function(){this.fullscreen?this.disableFullscreen():this.enableFullscreen()}},{key:"enableFullscreen",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!1===this.sentEvent.enableFullscreen&&(this.sentEvent.enableFullscreen=!0,h.a.ga.trackEvent(["novel","enable_fullscreen",this.config.theme])),!1===this.fullscreen&&(!t.preventPushState&&window.history.state?window.history.back():(this.updateReadChars(),this.fullscreen=!0,f()('meta[name="viewport"]').attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),f()("<div/>",{class:"novel-fade-screen"}).appendTo("body").css({opacity:0,backgroundColor:this.$body.css("background-color")}).animate({opacity:1},200,function(){if(f()("html").addClass("_no-scroll"),e.$root.addClass("novel-fullscreen"),!t.preventPushState){var n=h.a.query.replace({fullscreen:"on"},!1,!0);window.history.pushState("","",n)}e.updateScrollFollower(),h.a.w.on("resize",e.onResizeInFullscreen).trigger("resize"),e.loadReadChars(),setTimeout(function(){e.$textWrapper.getNiceScroll().each(function(){return this.onResize()}),e.$pages.getNiceScroll().each(function(){return this.onResize()})},200),f()(".novel-fade-screen").animate({opacity:0},function(){f()(this).remove()}),e.$textWrapper.getNiceScroll().each(function(){this.wheelprevented=!1})})))}},{key:"disableFullscreen",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!0===this.fullscreen&&(!t.preventPushState&&window.history.state?window.history.back():(this.updateReadChars(),this.fullscreen=!1,f()('meta[name="viewport"]').attr("content","width=1080"),f()("<div/>",{class:"novel-fade-screen"}).appendTo("body").css({opacity:1080,backgroundColor:this.$body.css("background-color")}).animate({opacity:1},200,function(){if(f()("html").removeClass("_no-scroll"),e.$root.removeClass("novel-fullscreen"),!t.preventPushState){var n=h.a.query.replace({fullscreen:null},!1,!0);window.history.pushState("","",n)}e.updateScrollFollower(),e.$body.height("auto"),h.a.w.off("resize",e.onResizeInFullscreen),e.loadReadChars(),f()(".novel-fade-screen").animate({opacity:0},function(){f()(this).remove()}),e.$textWrapper.getNiceScroll().each(function(){this.wheelprevented=!0})})))}},{key:"onResizeInFullscreen",value:function(){this.$body.height(h.a.w.height()-this.$body.position().top)}},{key:"onFullscreenScroll",value:function(){var e=this;if(!this.$root.hasClass("novel-loading")){var t=Math.max(0,Math.min(this.pagesize-1,Array.from(this.$pages).reduce(function(t,n,a){var r=n.getClientRects()[0];if(void 0===r)return t;if("horizontal"===e.config.writingMode){if(r.bottom<h.a.w.height()/2)return a+1}else if(r.left>h.a.w.width()/2)return a+1;return t},0)));t!==this.page&&this.pageTo(t,{preventNavigation:!0}),this.updateScrollers(!1)}}},{key:"updateFullscreenState",value:function(){!0===("on"===h.a.query.parse().fullscreen)?this.enableFullscreen({preventPushState:!0}):this.disableFullscreen({preventPushState:!0})}},{key:"pagePrev",value:function(e){this.pageTo(Math.max(0,this.page-1),e)}},{key:"pageNext",value:function(e){this.pageTo(Math.min(this.pagesize-1,this.page+1),e)}},{key:"pageTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.page>e&&e>0&&this.parseSinglePage(e-1),this.page<e&&this.parseSinglePage(e+1),this.parseSinglePage(e),this.page=e;var n=this.$pages.eq(e);if(this.orientVtokens(n,this.config.writingMode),!t.preventNavigation)if(!1===this.fullscreen)this.$pages.hide(),n.show(),n.getNiceScroll().length<1&&this.niceScrollEnabled&&this.niceScroll.push(n.niceScroll(this.niceScrollProps));else if("horizontal"===this.config.writingMode){var a=0===this.page?void 0:this.$pages.eq(this.page-1),r=0===this.page?this.$pages.eq(this.page).offset().top:a.offset().top+a.height();this.$body.scrollTop(this.$body.scrollTop()+r-this.$body.offset().top)}else{var i=0===this.page?this.$pages.eq(this.page).offset().left+this.$pages.eq(this.page).width():this.$pages.eq(this.page-1).offset().left;j(this.$textWrapper,!0,j(this.$textWrapper,!0)+i-this.$textWrapper.offset().left-this.$textWrapper.width())}if(this.$pagerPrev.css({visibility:this.page<=0?"hidden":"visible"}),this.$pagerNext.css({visibility:this.page>=this.pagesize-1?"hidden":"visible"}),this.$pagerPage.text(this.page+1+"/"+this.pagesize),this.$bodyMarker.text(this.page+1+"/"+this.pagesize),!0!==t.preventHashChange&&window.location.replace("#"+(this.page+1)),!0!==t.preventScroll){var o=this.$pages.eq(this.page);!0===t.scrollToBottom?"horizontal"===this.config.writingMode?h.a.w.scrollTop(this.$root.offset().top+this.$root.height()-h.a.w.height()):j(o,!0,0):"horizontal"===this.config.writingMode?h.a.w.scrollTop(this.$root.offset().top):j(o,!0,o.get(0).scrollWidth)}this.updateMarker(),t.preventNavigation||this.updateScrollers(!1)}},{key:"chapterTo",value:function(e,t,n){if(this.pageTo(e,{preventHashChange:n.preventHashChange,preventScroll:!0}),!0!==n.preventHashChange){var a=history.state;!0===n.preventScroll?window.location.replace("#chapter_".concat(e,"_").concat(t)):window.location.hash="#chapter_".concat(e,"_").concat(t),history.replaceState(a,"")}else!0!==n.preventScroll&&h.a.w.scrollTop(f()("#chapter_".concat(e,"_").concat(t)).offset().top)}},{key:"getHash",value:function(){if(0===location.hash.length)return null;var e=location.hash.match(/^#chapter_(\d+)_(\d+)$/);if(e)return[parseInt(e[1],10),parseInt(e[2],10)];var t=parseInt(location.hash.substr(1),10);return isNaN(t)||t>this.pagesize||t<=0?null:t-1}},{key:"onMousewheel",value:function(e){return"horizontal"===this.config.writingMode||(this.countUpClick("wheel"),"scroll"===this.config.scrollMode||((e.wheelDelta||e.deltaX||-e.deltaY)>0?this.pageUp():this.pageDown(),e.preventDefault(),!1))}},{key:"pageUp",value:function(){var e,t;!1!==this.fullscreen&&this.niceScrollEnabled?(t=this.$pages,e="vertical"===this.config.writingMode?this.$textWrapper:this.$body):e=t=this.$pages.eq(this.page);var n=t.howmuchread({baseline:.2,borderline:"before",getMetric:!0,parent:e,writingMode:{vertical:"vertical"===this.config.writingMode,horizontal:"horizontal"===this.config.writingMode,ttb:!0,rtl:"vertical"===this.config.writingMode}});if(null===n.top)if("vertical"===this.config.writingMode)if(this.niceScrollEnabled)e.getNiceScroll(0).doScrollLeftBy(-e.width());else{var a=e.width(),r=e.scrollLeft()+a;e[0].scroll({left:r,behavior:"smooth"})}else this.niceScrollEnabled&&e.getNiceScroll(0).doScrollBy(-e.height());else if("vertical"===this.config.writingMode)if(this.niceScrollEnabled)e.getNiceScroll(0).doScrollLeftBy(e.offset().left-n.left-n.blockSize);else{var i=n.left-e.offset().left+n.blockSize,o=e.scrollLeft()+i;e[0].scroll({left:o,behavior:"smooth"})}else this.niceScrollEnabled&&e.getNiceScroll(0).doScrollBy(e.offset().top+e.height()-n.top-n.blockSize)}},{key:"pageDown",value:function(){var e,t;!1!==this.fullscreen&&this.niceScrollEnabled?(e=this.$pages,t="vertical"===this.config.writingMode?this.$textWrapper:this.$body):t=e=this.$pages.eq(this.page);var n=e.howmuchread({baseline:.8,borderline:"after",getMetric:!0,parent:t,writingMode:{vertical:"vertical"===this.config.writingMode,horizontal:"horizontal"===this.config.writingMode,ttb:!0,rtl:"vertical"===this.config.writingMode}});if(null===n.top)if("vertical"===this.config.writingMode)if(this.niceScrollEnabled)t.getNiceScroll(0).doScrollLeftBy(t.width());else{var a=t.width(),r=t.scrollLeft()-a;t[0].scroll({left:r,behavior:"smooth"})}else this.niceScrollEnabled&&t.getNiceScroll(0).doScrollBy(t.height());else if("vertical"===this.config.writingMode)if(this.niceScrollEnabled)t.getNiceScroll(0).doScrollLeftBy(t.offset().left+t.width()-n.left-n.blockSize);else{var i=t.offset().left+t.width()-n.left-n.blockSize,o=t.scrollLeft()+n.blockSize-i;t[0].scroll({left:o,behavior:"smooth"})}else this.niceScrollEnabled&&t.getNiceScroll(0).doScrollBy(t.offset().top-n.top)}},{key:"disableScroller",value:function(e){switch(e){case"prev":var t=this.$scrollerPrev.css("visibility");"visible"!==t&&"inherit"!==t||this.$scrollerPrev.css({visibility:"hidden"});break;case"next":var n=this.$scrollerNext.css("visibility");"visible"!==n&&"inherit"!==n||this.$scrollerNext.css({visibility:"hidden"});break;default:Object(v.i)(e)}}},{key:"enableScroller",value:function(e){switch(e){case"prev":"hidden"===this.$scrollerPrev.css("visibility")&&this.$scrollerPrev.css({visibility:"visible"});break;case"next":"hidden"===this.$scrollerNext.css("visibility")&&this.$scrollerNext.css({visibility:"visible"});break;default:Object(v.i)(e)}}},{key:"enablePagerMode",value:function(e,t){var n="prev"===e?this.$scrollerPrev:"next"===e?this.$scrollerNext:Object(v.i)(e);if(n.hasClass("pager-mode"))t||(n.stop(),"vertical"===this.config.writingMode?n.children(".icon").css({transform:"rotate(-90deg)"}):n.children(".icon").css({transform:"rotate(-180deg)"}));else{n.addClass("pager-mode");var a=this.config.writingMode;t?n.css({minWidth:0}).animate({minWidth:1},{duration:200,step:function(e){"vertical"===a?f()(this).children(".icon").css({transform:"rotate(".concat(-90*e,"deg)")}):f()(this).children(".icon").css({transform:"rotate(".concat(-90*e-90,"deg)")}),f()(this).children(".label").css({opacity:e,top:10*(1-e)})}}):(n.stop(),"vertical"===this.config.writingMode?n.children(".icon").css({transform:"rotate(-90deg)"}):n.children(".icon").css({transform:"rotate(-180deg)"}),n.children(".label").css({opacity:1,top:0}))}}},{key:"disablePagerMode",value:function(e,t){var n="prev"===e?this.$scrollerPrev:"next"===e?this.$scrollerNext:Object(v.i)(e);if(!n.hasClass("pager-mode"))return n.children(".label").css({opacity:0}),void(!1===t&&(n.stop(),"vertical"===this.config.writingMode?n.children(".icon").css({transform:"rotate(0deg)"}):n.children(".icon").css({transform:"rotate(-90deg)"})));n.removeClass("pager-mode");var a=this.config.writingMode;t?n.css({minWidth:1}).animate({minWidth:0},{duration:200,step:function(e){return"vertical"===a?f()(this).children(".icon").css({transform:"rotate(".concat(-90*e,"deg)")}):f()(this).children(".icon").css({transform:"rotate(".concat(-90*e-90,"deg)")}),f()(this).children(".label").css({opacity:e,top:10*(1-e)})}}):(n.stop(),"vertical"===this.config.writingMode?n.children(".icon").css({transform:"rotate(0deg)"}):n.children(".icon").css({transform:"rotate(-90deg)"}),n.children(".label").css({opacity:0,top:10}))}},{key:"updateScrollers",value:function(e){if(!0===this.fullscreen&&"horizontal"===this.config.writingMode)return this.disableScroller("next"),void this.disableScroller("prev");var t=this.fullscreen&&this.niceScrollEnabled?"vertical"===this.config.writingMode?this.$textWrapper:this.$body:this.$pages.eq(this.page),n=function(e,t){if("horizontal"===e){var n=t.height(),a=t.get(0).scrollHeight,r=t.scrollTop();return{scrollBefore:r,scrollAfter:a-r-n}}var i=t.width(),o=t.get(0).scrollWidth,s=j(t,!0);return{scrollBefore:o-s-i,scrollAfter:s}}(this.config.writingMode,t),a=n.scrollBefore,r=n.scrollAfter;return a<=1?this.page-1>=0&&!1===this.fullscreen?(this.enableScroller("prev"),this.enablePagerMode("prev",e)):(this.disableScroller("prev"),this.disablePagerMode("prev",e)):(this.enableScroller("prev"),this.disablePagerMode("prev",e)),r<=0?this.page+1<this.pagesize&&!1===this.fullscreen?(this.enableScroller("next"),this.enablePagerMode("next",e)):(this.disableScroller("next"),this.disablePagerMode("next",e)):(this.enableScroller("next"),this.disablePagerMode("next",e))}},{key:"toggleWritingMode",value:function(){"horizontal"===this.config.writingMode?this.setWritingMode("vertical"):(this.config.writingMode,this.setWritingMode("horizontal"))}},{key:"setWritingMode",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.preventReadCharsSync||this.updateReadChars();var a=f()("html").hasClass("no-verticaltext")?"horizontal":"horizontal"===e||"vertical"===e?e:"horizontal";this.$root.removeClass(function(e,t){return t.split(" ").filter(function(e){return/^novel-writing-mode-/.test(e)}).join(" ")}),"vertical"===a?(this.niceScrollEnabled&&this.niceScroll.show(),this.$body.scrollTop(0)):this.niceScrollEnabled&&(this.niceScroll.hide(),this.$pages.each(function(e,t){var n=f()(t).getNiceScroll(0);n&&(n.rail.scrollable=!1)})),this.$root.addClass("novel-writing-mode-".concat(a)),this.$writingModeController.attr("data-writing-mode",a),this.saveConfig("writingMode",a,n),this.orientVtokens(this.$pages.eq(this.page),a),n.preventReadCharsSync||this.loadReadChars(),setTimeout(function(){return t.$textWrapper.getNiceScroll().each(function(){return this.onResize()}),t.$pages.getNiceScroll().each(function(){return this.onResize()})},200)}},{key:"orientVtokens",value:function(e,t){e.find(".vtoken").each(function(e,n){"vertical"===t?f()(n).text(f()(n).data("vertical")):f()(n).text(f()(n).data("horizontal"))})}},{key:"toggleFont",value:function(){"sans-serif"===this.config.font?this.setFont("serif"):(this.config.font,this.setFont("sans-serif"))}},{key:"setFont",value:function(e){this.$root.removeClass(function(e,t){return t.split(" ").filter(function(e){return/^novel-font-/.test(e)}).join(" ")});var t="serif"===e||"sans-serif"===e?e:"sans-serif";this.$root.addClass("novel-font-".concat(t)),this.$fontController.attr("data-font",t),this.saveConfig("font",t)}},{key:"setSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.preventReadCharsSync||this.updateReadChars(),this.$root.removeClass(function(e,t){return t.split(" ").filter(function(e){return/^novel-size-/.test(e)}).join(" ")});var n="small"===e||"medium"===e||"big"===e?e:"medium";this.$root.addClass("novel-size-".concat(n)),this.$sizeChoices.filter(function(e,t){return f()(t).data("size")===n}).prop("checked",!0),t.preventReadCharsSync||!this.fullscreen&&"horizontal"===this.config.writingMode||this.loadReadChars(),this.saveConfig("size",n)}},{key:"setLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.preventReadCharsSync||this.updateReadChars(),this.$root.removeClass(function(e,t){return t.split(" ").filter(function(e){return/^novel-line-/.test(e)}).join(" ")});var n="narrow"===e||"normal"===e?e:"normal";this.$root.addClass("novel-line-".concat(n)),this.$lineChoices.filter(function(e,t){return f()(t).data("line")===n}).prop("checked",!0),t.preventReadCharsSync||!this.fullscreen&&"horizontal"===this.config.writingMode||this.loadReadChars(),this.saveConfig("line",n)}},{key:"setTheme",value:function(e){function t(e,t){return t.split(" ").filter(function(e){return/^novel-theme-/.test(e)}).join(" ")}this.$root.removeClass(t),this.$extendedBackground.removeClass(t);var n="white"===e||"gray"===e||"black"===e||"blue"===e||"yellow"===e?e:"white";this.$root.addClass("novel-theme-".concat(n)),this.$extendedBackground.addClass("novel-theme-".concat(n)),this.$themeChoices.removeClass("active"),this.$themeChoices.filter(".novel-theme-".concat(n)).addClass("active"),this.saveConfig("theme",n)}},{key:"setScrollMode",value:function(e){this.$root.removeClass(function(e,t){return t.split(" ").filter(function(e){return/^novel-scroll-mode-/.test(e)}).join(" ")});var t="page"===e||"scroll"===e?e:"scroll";this.$root.addClass("novel-scroll-mode-".concat(t)),this.$scrollModeChoices.filter(function(e,n){return f()(n).data("scroll-mode")===t}).prop("checked",!0),this.saveConfig("scrollMode",t)}},{key:"setHorizontalView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.preventReadCharsSync||this.updateReadChars(),this.$root.removeClass(function(e,t){return t.split(" ").filter(function(e){return/^novel-horizontal-view-/.test(e)}).join(" ")});var n="classic"===e||"scroll"===e?e:"classic";this.$root.addClass("novel-horizontal-view-".concat(n)),t.preventReadCharsSync||!1===this.fullscreen&&"horizontal"===this.config.writingMode||this.loadReadChars(),this.saveConfig("horizontalView",n)}},{key:"setInstantFullscreen",value:function(e){this.$root.removeClass(function(e,t){return t.split(" ").filter(function(e){return/^novel-instant-fullscreen-/.test(e)}).join(" ")});var t="boolean"!=typeof e||e;this.$root.addClass("novel-instant-fullscreen-".concat(t?"on":"off")),this.saveConfig("instantFullscreen",t)}},{key:"saveConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.config[e]=t,!n.preventStoreConfig){var a=h.a.storage.localStorage("novel_config")||{};a[e]=t,h.a.storage.localStorage("novel_config",a)}}},{key:"countUpClick",value:function(e){this.clickCounter[e]=(this.clickCounter[e]||0)+1}},{key:"updateReadChars",value:function(){var e=this,t={vertical:"vertical"===this.config.writingMode,horizontal:"horizontal"===this.config.writingMode,ttb:!0,rtl:"vertical"===this.config.writingMode};if(!1===this.fullscreen){var n=this.$pages.filter(function(t){return t<e.page}),a=this.$pages.eq(this.page),r="horizontal"===this.config.writingMode&&"classic"===this.config.horizontalView?window:a;this.readChars=n.howmuchread("getLength")+a.howmuchread({parent:r,writingMode:t})}else{var i="horizontal"===this.config.writingMode?this.$body:this.$textWrapper;this.readChars=this.$pages.howmuchread({parent:i,writingMode:t})}}},{key:"loadReadChars",value:function(){var e=this,t={vertical:"vertical"===this.config.writingMode,horizontal:"horizontal"===this.config.writingMode,ttb:!0,rtl:"vertical"===this.config.writingMode};if(!1===this.fullscreen){var n=0,a=0;this.$pages.each(function(t,r){var i=f()(r).howmuchread("getLength");n<=e.readChars&&e.readChars<n+i&&(e.pageTo(t,{preventScroll:!0}),a=e.readChars-n),n+=i});var r=this.$pages.eq(this.page),i="horizontal"===this.config.writingMode&&"classic"===this.config.horizontalView?window:r;r.howmuchread("scrollTo",a,{parent:i,writingMode:t})}else{var o="horizontal"===this.config.writingMode?this.$body:this.$textWrapper;this.$pages.howmuchread("scrollTo",this.readChars,{parent:o,writingMode:t})}}},{key:"setMarker",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="number"==typeof t?t:parseInt(t,10),!(isNaN(n)||n<0||this.pagesize<=n)){e.next=3;break}return e.abrupt("return");case 3:if(this.marker===n){e.next=16;break}return this.marker=n,this.$markerTooltip.addClass("loading"),this.$bodyMarker.addClass("loading"),e.prev=7,e.next=10,Promise.resolve(g.k(this.id,m.default.user.id,n+1));case 10:return this.updateMarker(),e.next=13,this.loadMarkers();case 13:return e.prev=13,this.$bodyMarker.removeClass("loading"),e.finish(13);case 16:case"end":return e.stop()}},e,this,[[7,,13,16]])}));return function(t){return e.apply(this,arguments)}}()},{key:"destroyMarker",value:function(){var e=Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.marker){e.next=8;break}return this.marker=null,this.$markerTooltip.addClass("loading"),e.next=5,Promise.resolve(g.i(this.id,m.default.user.id));case 5:return this.updateMarker(),e.next=8,this.loadMarkers();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadMarkers",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$markerTooltip.addClass("loading"),e.prev=1,e.next=4,Promise.resolve(g.f(m.default.user.id));case 4:t=e.sent,this.markers=t,this.updateMarkerList();case 7:return e.prev=7,this.$markerTooltip.removeClass("loading"),e.finish(7);case 10:case"end":return e.stop()}},e,this,[[1,,7,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"updateMarker",value:function(){null==this.marker?this.$markerTooltip.addClass("no-marker"):(this.$followMarkerButton.text(h.a.t("続き($1ページ)から読む",this.marker+1)),this.$markerTooltip.removeClass("no-marker")),this.marker===this.page?this.$bodyMarker.addClass("active").attr("data-tooltip",h.a.t("しおりをはずす")):this.$bodyMarker.removeClass("active").attr("data-tooltip",h.a.t("このページにしおりをはさむ"))}},{key:"updateMarkerList",value:function(){this.$markerList.empty(),null!==this.markers&&0!==this.markers.length?this.$markerList.append(this.markers.map(function(e){return f()("<li/>",{class:"marker-novel"}).append(f()("<a/>",{class:"marker-link",href:"/novel/show.php?id=".concat(e.id,"#").concat(e.marked_scene)}).append(f()("<div/>",{class:"marker-novel-main"}).append(f()("<p/>",{class:"marker-novel-title",text:e.title})).append(f()("<p/>",{class:"marker-novel-author"}).append(document.createTextNode("by ")).append(f()("<span>",{href:"/novel/member.php?id=".concat(e.user_id),class:"marker-novel-authorlist",text:e.user_name})))).append(f()("<div/>",{class:"marker-novel-sub"}).append(f()("<img/>",{class:"marker-novel-thumbnail",src:e.url,alt:e.title})).append(f()("<p/>",{class:"marker-novel-status",text:h.a.t("$1/$2ページ",e.marked_scene,e.scene)}))))})):this.$markerList.append(f()("<div/>",{class:"no-marked-novel-message",text:h.a.t("しおりはまだはさまれておりません")}))}},{key:"updateScrollFollower",value:function(){var e=h.a.w.scrollTop(),t=this.$body.offset(),n=(this.$body.outerWidth(),this.$body.outerHeight()),a=!0===this.fullscreen?"fullscreen":e<=t.top?"top":e<=t.top+n?"fixed":"bottom";if(!this.$scrollFollower.hasClass(a))switch(this.$scrollFollower.removeClass("top fixed bottom fullscreen").addClass(a),a){case"fullscreen":this.$scrollFollower.removeAttr("style").css({position:"fixed",top:"70px",right:"30px"}).children().removeAttr("style").css({position:"absolute",top:"0",right:"0"});break;case"top":this.$scrollFollower.removeAttr("style").css({position:"absolute",top:"0",right:"0"}).children().removeAttr("style").css({top:"0"});break;case"fixed":this.$scrollFollower.removeAttr("style").css({position:"fixed",top:0,right:"".concat(h.a.w.width()-t.left-this.$body.outerWidth(),"px")}).children().removeAttr("style").css({top:"0"});break;case"bottom":this.$scrollFollower.removeAttr("style").css({position:"absolute",top:"auto",right:"0",bottom:"0"}).children().removeAttr("style").css({top:"0"});break;default:Object(v.i)(a)}}}]),e}()},412:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(2),o=n(10),s=n(293);r()(function(){c.setup()});var c={setup:function(){var e=this;i.a.d.on("click","._balloon-menu-opener",function(t){e.open(t)}).on("click","._balloon-menu-popup ._balloon-menu-closer",function(t){e.close(t)}).on("uimodalclose","._balloon-menu-popup",function(e){e.preventDefault(),e.stopPropagation(),r()("._balloon-menu-opener.opened").removeClass("opened")}),i.a.w.on("resize",Object(s.a)(function(){e.close()}))},open:function(e){if(0===e.button&&!(r()(e.currentTarget).find("._balloon-menu-popup").first().find(e.target).length>0)){e.preventDefault();var t=r()(e.target).closest("a.share");if(t.length>0)this.openWindowToShare(t);else if(r()(e.currentTarget).hasClass("opened"))this.close();else{this.close();var n,a=r()(e.currentTarget),s=!1;if(this.popup=a.children("._balloon-menu-popup"),this.popup.length<1&&(this.popup=a.siblings("._balloon-menu-popup")),this.popup.length<1){var c=a.dataset("id");n=a.dataset("type");var l=a.dataset("role"),u=a.dataset("caption"),d=a.dataset("user-id"),h=a.dataset("user-name"),p=a.dataset("permalink");this.data={id:c,type:n,userId:d,is_bookmarked:a.hasClass("on"),is_following:a.hasClass("following"),reportable:"share"!==l&&d!==o.default.user.id,blockable:"share"!==l&&d!==o.default.user.id&&"user"===n,likable:("illust"===n||"novel"===n)&&"share"!==l,followable:"user"===n,shareable:"share"===l,muteable:"share"!==l&&d!==o.default.user.id,message_url:"/messages.php?receiver_id=".concat(c),report_url:function(){switch(n){case"illust":return"/illust_infomsg.php?illust_id=".concat(c);case"novel":return"/support.php?type=5";case"user":return"/user_infomsg.php?id=".concat(d);default:return""}}(),block_url:"/user_infomsg.php?id=".concat(d,"#block"),tweet_url:"https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(null!=u?"".concat(u," | ").concat(h):h),"&url=").concat(encodeURIComponent(p),"&hashtags=").concat(encodeURIComponent("pixiv")),facebook_url:"https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(p)),line_url:"https://lineit.line.me/share/ui?url=".concat(encodeURIComponent(p))},s=!0,this.popup=r()(i.a.template("balloon-menu-popup",this.data))}var f=a.closest("._work-modal > .modal-scroll-wrapper"),m=0!==f.length,v=0!==a.closest(".item-container").length,g=0!==a.closest("._cover-image").length,b=0!==a.closest(".featured-entries").length;if(v&&m){s&&f.append(this.popup);var y=a.offset();i.a.ui.popupPosition(this.popup,null,{top:f.scrollTop()+y.top-f.offset().top+a.outerHeight(),left:y.left,width:a.outerWidth(),margin:0,forceUnderTarget:!0})}else if(v||g||b)s&&r()("body").append(this.popup),i.a.ui.popupPosition(this.popup,a,{margin:0,forceUnderTarget:!0});else{var k=!1,w=a.find("._balloon-menu-anchor");0===w.length&&(k=!0,w=a);var _=w.position().left;s?a.append(this.popup):0===a.children("._balloon-menu-popup").length&&(k=!1),k&&(_=0),this.popup.is("._balloon-menu-left-align")?this.popup.css("left","".concat(_+w.outerWidth()-this.popup.outerWidth(),"px")):this.popup.is("._balloon-menu-right-align")?this.popup.css("left","".concat(_,"px")):this.popup.css("left","".concat(_+(w.outerWidth()-this.popup.outerWidth())/2,"px"))}this.popupId=i.a.ui.modal.push(this.popup,{disposable:s,zIndex:m||"user"!==n?10:void 0}),null!=o.default.WorkModal&&this.popup.on("click",".like-action",o.default.WorkModal.actionLike),a.addClass("opened")}}},close:function(e){e&&e.stopPropagation(),null!=this.popupId&&(i.a.ui.modal.close(this.popupId),delete this.popup,delete this.popupId)},openWindowToShare:function(e){var t,n,a={twitter:{width:550,height:420},facebook:{width:670,height:650},line:{width:503,height:510}}[e.data("type")];null!=window.screenX&&window.screenX>=0&&window.screenY>=0?(t=(window.screen.availWidth-a.width)/2,n=(window.screen.availHeight-a.height)/2):null!=window.screenLeft&&window.screenLeft>=0&&window.screenTop>=0?(t=(window.screen.availWidth-a.width)/2,n=(window.screen.availHeight-a.height)/2):(t=0,n=0);var r="width=".concat(a.width,",height=").concat(a.height,",left=").concat(t,",top=").concat(n,",resizable=yes,scrollbars=no,chrome=yes,centerscreen=yes"),i=e.attr("href");window.open(i,null,r)}}},415:function(e,t,n){"use strict";var a=n(11),r=n(9),i=n(82),o=n(0),s=n.n(o),c=(n(346),n(23)),l=Object(c.a)("ui.expander");function u(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=s()(e),n=Array.from(s()(".ui-expander-container",t),function(e){return s()(e)}),a=0;a<n.length;a++){var r=n[a],i=s()(".expand",r),o=s()(".ui-expander-target",r).outerHeight(!0),c=r.height();l.debug("height",o,c),o>c&&(r.dataset("uiExpanderEnabled","true"),r.hasClass("expanded")?d(r[0]):i.show())}}function d(e){var t=s()(e).closest(".ui-expander-container");if("true"===t.dataset("uiExpanderEnabled")){var n=s()(".ui-expander-target",t);t.addClass("expanded").css("max-height","").css("max-height",n.outerHeight(!0)).trigger("expand"),l.debug("expand",n.outerHeight(!0))}}var h=Object(c.a)("colon.ui",2).getLevel();r.default.ui={popupPosition:function(e,t,n){var a,i,o,c,l,u,d=s()(e),h=n||{},p=h.space||5,f=h.margin||0,m=r.default.w.scrollTop(),v=r.default.w.scrollLeft(),g=r.default.w.width(),b=r.default.w.height(),y=v+g,k=d.outerWidth(),w=d.outerHeight();t?(o=(i=(a=s()(t)).offset()).top,c=i.left,l=a.outerWidth(),u=a.outerHeight()):(o=h.top,c=h.left,l=h.width,u=0);var _,x=void 0===h.offset?Math.max(c+(l-k)/2,v+p):Math.max(c+h.offset,v)+p;if(x+k+p>y&&c-v>y-(c+l)&&(x=y-k-p),h.forceUnderTarget||m+w+p+f>o&&o+u+w+p+f<=m+b?(_=o+u+f,d.addClass("under-target")):(_=o-w-f,d.removeClass("under-target")),h.nipple){var j=s()(h.nipple,d),O=h.nippleMargin||0,C=j.outerWidth();if(x+k-c<C+2*O||c+l-x<C+2*O)j.addClass("_hidden");else{var S=l/2;S+=c-x,j.removeClass("_hidden").css("left",Math.max(S,O+C/2))}}d.css({top:_,left:x})}},r.default.ui.expander={setup:function(){s()(document).on("click",".ui-expander-container .expand",function(e){d(e.target)}).on("click",".ui-expander-container .collapse",function(e){!function(e){var t=s()(e).closest(".ui-expander-container");"true"===t.dataset("uiExpanderEnabled")&&t.css("max-height","").trigger("collapse").removeClass("expanded").find(".expand").show()}(e.target)}),u()},add:u},r.default.ui.Counter=function(e,t){var n=this,a=this.container=s()(e);this.target=s()("input, textarea",this.container).eq(0),this.counter=s()(".count",this.container),Object.assign(this.options,{limit:+this.target.attr("maxlength")},this.target.dataset(),t),this.target.on("keyup blur",function(){n.update()}).on("focus",function(){a.addClass("focused")}).on("blur",function(){a.removeClass("focused")}),this.count()&&this.update()},r.default.ui.Counter.setup=function(e){s()(".ui-counter",e).each(function(){new r.default.ui.Counter(this)})},r.default.ui.Counter.prototype={options:{limit:140},container:null,target:null,counter:null,over:!1,update:function(){var e=this.count();this.counter.text(e),this.over?e<=this.options.limit&&(this.over=!1,this.ok()):e>this.options.limit&&(this.over=!0,this.ng())},count:function(){return this.target.val().length},ok:function(){this.container.removeClass("ng").addClass("ok")},ng:function(){this.container.removeClass("ok").addClass("ng")}},r.default.ui.Tag={},r.default.ui.Tag.split=function(e){var t=r.default.ui.Tag.trim(e);return t?t.split(/[\s\xA0　]+/):[]},r.default.ui.Tag.find=function(e,t){for(var n=r.default.ui.Tag.trim(e).toLowerCase(),a=0,i=t.length;a<i;++a)if(n===t[a].toLowerCase())return a;return-1},r.default.ui.Tag.match=function(e,t,n){var a,i=r.default.ui.Tag.trim(e).toLowerCase(),o=/^"(.+)"$/.exec(i),s=[];o&&(i=o[1]);for(var c=0,l=t.length;c<l;++c)a=r.default.ui.Tag.trim(t[c]).toLowerCase(),(o&&a===i||-1!==a.indexOf(i))&&(a=n?n(a):a)&&s.push(a);return s.length?s:null},r.default.ui.Tag.normalize=function(e){return e.replace(/^"(.+)"$/,"$1")},r.default.ui.Tag.trim=function(e){return e?e.toString().replace(/^[\s\xA0　]+/,"").replace(/[\s\xA0　]+$/,""):""},r.default.ui.toggleSwitch={setup:function(){r.default.d.on("click.uiswitch","._ui-switch",function(){var e,t=s()(this);t.hasClass("_disabled")||(e=!t.hasClass("on"),Object(c.a)("colon.ui.toggleSwitch",h).debug(e?"on":"off"),e?t.removeClass("off").addClass("on").trigger("uiswitch",[e]):t.removeClass("on").addClass("off").trigger("uiswitch",[e]),s()("input",this).prop("checked",e))})}},r.default.ui.shortcut={keyList:{DELETE:8,RETURN:13,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,"←":37,"↑":38,"→":39,"↓":40},keys:null,pausedKeys:[],setup:function(){var e=this;this.keys=[],r.default.d.on("keydown.uiShortcut",function(t){var n=[t.which,t.ctrlKey,t.altKey,t.shiftKey];if(!e.paused(n)){var a=t.target.nodeName;return t.which===e.keyList.ESC||t.which===e.keyList.DELETE||"INPUT"!==a&&"TEXTAREA"!==a&&!t.metaKey?(Object(c.a)("colon.ui.shortcut",h).debug("push",t.which,t),e.trigger(n,t)):void 0}})},terminate:function(){r.default.d.off("keydown.uiShortcut"),this.keys=null},parse:function(e,t){var n,a,r,i=[],o=e;if("string"!=typeof o)return[o];Object(c.a)("colon.ui.shortcut",h).debug("parse",o),o=(""+o).split(/\s+/);for(var s,l,u=0;s=o[u];++u)null!==(n=/([^+]+?)(?:\..+)?$/.exec(s)[1])&&(a=this.keyList[n]?this.keyList[n]:"number"==typeof n?+n:n.charCodeAt(0),r=s.slice(1).split(".").slice(1),l=[a,/ctrl/i.test(s),/alt/i.test(s),/shift/i.test(s),r.length?r:void 0],i.push(l),t&&t.call(this,l));return i},pause:function(e){this.parse(e,function(e){Object(c.a)("colon.ui.shortcut",h).debug("pause",e),this.pausedKeys.push(e)})},paused:function(e){return this.find(this.pausedKeys,this.parse(e)[0])},restart:function(e){var t=this.pausedKeys;this.parse(e,function(e){this.find(t,e,function(e,n){Object(c.a)("colon.ui.shortcut",h).debug("restart",e),t.splice(n,1)})})},bind:function(e,t,n){this.keys||this.setup();var a=t.bind(n||this);return this.parse(e,function(e,t){Object(c.a)("colon.ui.shortcut",h).debug("bind",t,e),e&&(e.push(a),this.keys.push(e))}),this},unbind:function(e){var t=this.keys;return this.parse(e,function(e){this.find(t,e,function(e,n){Object(c.a)("colon.ui.shortcut",h).debug("unbind",e),t.splice(n,1)})}),t.length||this.terminate(),this},trigger:function(e,t){var n,a=this.parse(e)[0];return this.find(this.keys,a,function(e){Object(c.a)("colon.ui.shortcut",h).debug("trigger "+(e[1]?"Ctrl+":"")+(e[2]?"Alt+":"")+(e[3]?"Shift+":"")+e[0],e[4]),n=e[5](t)}),n},find:function(e,t,n){var a,r,i=[];for(a=e.length-1;r=e[a];--a)!t[0]&&!t[4]||t[0]&&(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3])||t[4]&&!this.findNamespace(e,r[4]||[],t)||(i.push(a),n&&n.call(this,r,a));return i.length?i:void 0},findNamespace:function(e,t,n){var a,r,i,o=[],s=n;for(a=0;i=t[a];++a)if(s){if(s[4].includes(i))return!0}else for(r=0;s=e[r];++r)s[4].includes(i)&&o.push(r);return o.length?o:void 0}},r.default.ui.modal={modals:[],blockModals:[],hashStack:[],clickTarget:null,initialized:!1,paused:!1,baseZIndex:1e4,setup:function(){r.default.d.on("click",".ui-modal-trigger[data-target]",function(){var e=s()(this).dataset();r.default.ui.modal.push("."+e.target,Object(a.a)({block:!0},e))})},initialize:function(){var e=this;r.default.d.on("click.colonUiModal",function(t){e.click(t)}),r.default.ui.shortcut.bind("ESC.uimodal",this.esc,this),this.initialized=!0},terminate:function(){r.default.d.off("click.colonUiModal"),r.default.ui.shortcut.unbind("ESC.uimodal"),this.initialized=!1},esc:function(){return!1!==this.get().options.esc&&this.pop(),!1},get:function(e,t){var n=this.modals;if(e){var a=this.find(n,e);return-1!==a?t?n.splice(a,1)[0]:n[a]:null}return t?n.pop():n[n.length-1]},find:function(e,t){for(var n,a=0;n=e[a];++a)if(n.id===t)return a;return-1},scrollTop:function(){var e=this.blockModals.slice(-1)[0];return e?e.target.scrollTop()-r.default.w.scrollTop():null},block:function(e){this.blockModals.length||r.default.h.addClass("_no-scroll"),this.blockModals.push(e)},unblock:function(e){e?this.blockModals.splice(this.find(this.blockModals,e),1):this.blockModals.pop(),this.blockModals.length||r.default.h.removeClass("_no-scroll")},pause:function(){Object(c.a)("colon.ui.modal",h).debug("pause"),this.paused=!0},restart:function(){Object(c.a)("colon.ui.modal",h).debug("restart"),this.paused=!1},click:function(e){var t,n,a;this.paused||0!==e.button||(n=(t=s()(e.target)).closest(".ui-modal-trigger")[0],a=this.get(),Object(c.a)("colon.ui.modal",h).debug("click",this,t,n,a),(t.hasClass("ui-modal-close")||t.closest(".ui-modal-close-box").length||this.modals.length&&!n&&!t.closest(a.target).length&&!1!==a.options.esc)&&(Object(c.a)("colon.ui.modal",h).debug("click","match"),this.pop()))},toggle:function(e,t,n){if(!this.paused){var a=s()(e)[0];if(this.modals.length&&a===this.clickTarget)return Object(c.a)("colon.ui.modal",h).debug("toggle","close"),this.pop(),!1;var r=this.push(t,n);return this.clickTarget=a,r}},push:function(e,t){var n,a,o=s()(e);if(this.paused||!o.length)return null;n=r.default.id();var l=t||{};this.modals.length&&(this.get().options.block||this.get().options.stackable)||this.pop(),this.initialized||this.initialize();var u={id:n,target:o,options:l};if(a=this.modals.push(u),u.originalZIndex=o.css("z-index"),o.css("z-index",this.baseZIndex+a),l.block&&(i.a.add(".ui-scroll-view",o),i.a.watch(o),this.block(this.modals[a-1])),Object(c.a)("colon.ui.modal",h).debug("push",n,o,l,this.blockModals),l.urlHash){var d="#".concat(l.urlHash);window.location.hash&&d!==window.location.hash&&this.hashStack.push(window.location.hash),window.history.replaceState(null,"",d)}return l.effect?l.effect(o):o.show().removeClass("_hidden"),o.trigger("uimodalopen"),n},pop:function(e){this.close(null,e)},next:function(e,t){return this.pop(!1),this.push(e,t)},close:function(e,t){var n,a,r;this.paused||(this.clickTarget=null,this.modals.length&&(n=e?this.get(e,!0):this.modals.pop())&&(a=n.target,r=n.options,a.css("z-index",n.originalZIndex),r.block&&(i.a.remove(".ui-scroll-view",a),i.a.unwatch(a),this.unblock(e)),Object(c.a)("colon.ui.modal",h).debug("pop",e,a,r,t,this.blockModals),r.urlHash&&(this.hashStack.length>0?window.history.replaceState(null,"",this.hashStack.pop()):window.history.replaceState(null,"",window.location.pathname+window.location.search)),this.modals.length||this.terminate(),!1!==t&&a.trigger("uimodalclose")[r.disposable?"remove":"hide"]()))},clear:function(){for(var e=this.modals.length;e--;)this.pop()}}},42:function(e,t,n){"use strict";var a,r=n(58),i=n(1),o=n(164),s=n(7),c=n(8),l=n(14),u=n(12),d=n(13),h=n(18),p=n.n(h),f=n(4),m=n.n(f),v=n(55),g=n(201),b=n(151);var y,k=Object(v.b)(function(e){return{spa:e.spa}})(((a=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).apply(this,arguments))).handleBackgroundClick=function(t){if(t.target===t.currentTarget){var n=e.props.onBackgroundClick;n&&n()}},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.dark,a=e.white,r=e.show,o=e.flex,s=e.onDispose,c=p()(b.background,n&&b.dark,o&&b.flex,a&&b.white,!this.props.spa&&b.classic);return Object(i.a)(g.a,{show:r,onDispose:s},void 0,Object(i.a)("div",{className:c,onClick:this.handleBackgroundClick},void 0,t))}}]),t}(m.a.Component)).defaultProps={dark:!0,flex:!1},a)),w=n(316),_=n(107);!function(e){e.Left="left",e.Right="right"}(y||(y={}));var x=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).apply(this,arguments))).handleWrapperClick=function(t){var n=e.props,a=n.onClick,r=n.onBackgroundClick;a&&a(t),!t.isDefaultPrevented()&&r&&t.target===t.currentTarget&&r()},e.handleEsc=function(){var t=e.props.onBackgroundClick;t&&t()},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.show,a=e.aside,s=e.asidePosition,c=e.onDispose,l=e.onBackgroundClick,u=e.borderRadius,d=Object(o.a)(e,["children","show","aside","asidePosition","onDispose","onBackgroundClick","borderRadius"]);return Object(i.a)(k,{show:n,flex:!0,onDispose:c,onBackgroundClick:l},void 0,m.a.createElement(j,Object(r.a)({},d,{onClick:this.handleWrapperClick}),void 0!==a&&Object(i.a)("aside",{className:p()(_.aside,s===y.Right&&_.rightAside)},void 0,a),Object(i.a)("section",{className:_.body,style:{borderRadius:u}},void 0,t)),Object(i.a)(w.default,{vk:"Escape",disabled:!n||this.props.ignoreEsc,onShortcut:this.handleEsc}))}}]),t}(m.a.Component);x.defaultProps={asidePosition:y.Left,isForm:!0,action:void 0,method:void 0};var j=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).apply(this,arguments))).bindSubmit=function(t){null!==t&&t.addEventListener("submit",e.handleSubmit)},e.handleSubmit=function(t){e.props.method||function(e){e.stopPropagation(),e.preventDefault()}(t)},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props;return e.isForm?m.a.createElement("form",{action:e.action||"",method:e.method,ref:e.onSubmit?void 0:this.bindSubmit,onSubmit:e.onSubmit,onClick:e.onClick,className:p()(_.wrapper,e.topAlign&&_.topAlign),style:{width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}},e.children):Object(i.a)("div",{className:p()(_.wrapper,e.topAlign&&_.topAlign),style:{width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth},onClick:e.onClick},void 0,e.children)}}]),t}(m.a.Component);j.defaultProps={topAlign:!1};var O=n(279),C=n(209),S=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return Object(i.a)("div",{className:C.header},void 0,Object(i.a)("h1",{className:C.title},void 0,this.props.children),!this.props.hideCloseButton&&Object(i.a)("button",{type:"button",className:C.closeButton,onClick:this.props.onCloseClick},void 0,Object(i.a)(O.a,{})))}}]),t}(m.a.Component);S.defaultProps={hideCloseButton:!1};var T=n(15),I=n(127),M=n(150),E=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.okButtonLabel,n=void 0===t?Object(T.d)("OK"):t,a=e.cancelButtonLabel,r=void 0===a?Object(T.d)("キャンセル"):a;if(this.props.extraButtons){var o=!0,s=!1,c=void 0;try{for(var l,u=this.props.extraButtons[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var d=l.value;if(d.type!==I.a)throw new Error("Only Button instances are allowed");if(d.props.primary)throw new Error("Additional Buttons cannot be primary")}}catch(e){s=!0,c=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw c}}}return Object(i.a)("div",{className:M.footer},void 0,this.props.extraButtons&&this.props.extraButtons.length?Object(i.a)("div",{className:M.extraButtonContainerWrapper},void 0,Object(i.a)("div",{className:M.extraButtonContainer},void 0,this.props.extraButtons)):null,Object(i.a)("div",{className:M.buttonContainerWrapper},void 0,Object(i.a)("div",{className:M.buttonContainer},void 0,this.props.okButton&&Object(i.a)(I.a,{disabled:this.props.okButtonDisabled,primary:"submit"===this.props.okButtonType,onClick:this.props.onOkClick},void 0,n),this.props.cancelButton&&Object(i.a)(I.a,{onClick:this.props.onCancelClick},void 0,r))))}}]),t}(m.a.Component);E.defaultProps={okButton:!0,okButtonType:"submit",okButtonDisabled:!1,cancelButton:!0};var N=n(298);n.d(t,"d",function(){return x}),n.d(t,!1,function(){}),n.d(t,"c",function(){return S}),n.d(t,"b",function(){return E}),n.d(t,"a",function(){return N.a})},431:function(e,t,n){},436:function(e,t,n){var a={"./en.json":[742,55],"./ko.json":[741,54],"./zh-tw.json":[740,53],"./zh.json":[739,52]};function r(e){var t=a[e];return t?n.e(t[1]).then(function(){var e=t[0];return n.t(e,3)}):Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}r.keys=function(){return Object.keys(a)},r.id=436,e.exports=r},441:function(e,t,n){},46:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return g});var a,r=n(1),i=n(16),o=n(7),s=n(8),c=n(14),l=n(12),u=n(13),d=n(18),h=n.n(d),p=n(4),f=n.n(p),m=n(173),v=n(71);!function(e){e.BrowserDefault="default",e.PreferNewline="preferNewline",e.PreferSubmit="preferSubmit"}(a||(a={}));var g=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).apply(this,arguments))).state={},e.saveRef=function(t){e.ref=t},e.saveWidgetsRef=function(t){e.widgetsRef=t},e.handleClickClearButton=function(){e.props.onChange("")},e.handleClickCounter=function(){e.props.multiline||e.focus()},e.handleChange=function(t){e.triggerChange(t.currentTarget.value)},e.handleKeyDown=function(t){if("Enter"===t.key&&!t.nativeEvent.isComposing&&e.props.multiline&&e.props.multilineEnterBehavior!==a.BrowserDefault){var n=t.ctrlKey&&!t.shiftKey&&!t.altKey&&!t.metaKey||!t.ctrlKey&&!t.shiftKey&&!t.altKey&&t.metaKey,r=!t.ctrlKey&&!t.shiftKey&&t.altKey&&!t.metaKey||!t.ctrlKey&&t.shiftKey&&!t.altKey&&!t.metaKey,i=e.props.multilineUseCtrl?n:r;if(e.props.multilineEnterBehavior===a.PreferNewline&&!i||e.props.multilineEnterBehavior===a.PreferSubmit&&i)return t.preventDefault(),t.stopPropagation(),void e.insertText("\n");var o=t.currentTarget.form;if(o){var s=Array.from(o.elements),c=s.find(b);if(void 0!==c)c.click();else if(!function(e){return e.some(function(e){return"INPUT"===e.nodeName&&y.has(e.type)})}(s)){var l=document.createElement("button");l.type="submit",l.style.display="none",l.addEventListener("click",k,!1);try{o.appendChild(l),l.click()}finally{o.removeChild(l)}}}}},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"focus",value:function(){this.ref.focus()}},{key:"insertText",value:function(e,t,n,a){var r=this,i=this.ref;if(null!==i&&""!==e){this.focus();var o=!0;try{o=document.queryCommandEnabled("insertText")}catch(e){o=!1}var s=i.value,c=i.selectionStart,l=i.selectionEnd,u=c,d=l,h="",p="",f="";if(o||(p=s.slice(0,c),f=s.slice(l)),t)if(c!==l){var m=s.slice(c,l);2===t.length&&n&&(u+=t[0].length,d+=t[0].length,o?document.execCommand("insertText",!1,"".concat(t[0]).concat(m).concat(t[1])):h="".concat(p).concat(t[0]).concat(m).concat(t[1]).concat(f)),3===t.length&&n&&a&&(u+=t[0].length+m.length+t[1].length,d+=t[0].length+t[1].length+a.length,o?document.execCommand("insertText",!1,"".concat(t[0]).concat(m).concat(t[1]).concat(a).concat(t[2])):h="".concat(p).concat(t[0]).concat(m).concat(t[1]).concat(a).concat(t[2]).concat(f))}else 2===t.length&&n&&(u+=t[0].length,d+=t[0].length+n.length,o?document.execCommand("insertText",!1,"".concat(t[0]).concat(n).concat(t[1])):h="".concat(p).concat(t[0]).concat(n).concat(t[1]).concat(f)),3===t.length&&n&&a&&(u+=t[0].length,d+=t[0].length+n.length,o?document.execCommand("insertText",!1,"".concat(t[0]).concat(n).concat(t[1]).concat(a).concat(t[2])):h="".concat(p).concat(t[0]).concat(n).concat(t[1]).concat(a).concat(t[2]).concat(f));else o?document.execCommand("insertText",!1,e):h="".concat(p).concat(e).concat(f),d=u+=e.length;o||(i.value=h),i.setSelectionRange(u,d),requestAnimationFrame(function(){r.focus()}),this.triggerChange(i.value),this.props.multiline&&this.updateHeight(i.value)}}},{key:"componentDidMount",value:function(){var e=this;this.props.multiline&&this.updateHeight(this.props.value),this.props.autoFocus&&requestAnimationFrame(function(){e.focus()})}},{key:"componentDidUpdate",value:function(e){this.props.multiline&&e.value!==this.props.value&&this.updateHeight(e.value)}},{key:"render",value:function(){var e,t,n,a={paddingRight:""};return this.widgetsRef&&!this.props.multiline&&(a.paddingRight=this.widgetsRef.offsetWidth+16+"px"),Object(r.a)("div",{className:h()(v.wrapper,(e={},Object(i.a)(e,v.fullHeight,this.props.fullHeight),Object(i.a)(e,v.externalCounter,this.props.multiline&&this.props.showMaxLength),e))},void 0,f.a.createElement("div",{ref:this.saveWidgetsRef,className:v.widgets,onClick:this.handleClickCounter},this.props.showMaxLength&&Object(r.a)("span",{},void 0,this.props.value.length,"/",this.props.maxLength),this.props.showClearButton&&Object(r.a)("span",{onClick:this.handleClickClearButton},void 0,Object(r.a)(m.a,{}))),this.props.multiline?f.a.createElement("textarea",{id:this.props.id,name:this.props.name,placeholder:this.props.placeholder,value:this.props.value,onBlur:this.props.onBlur,onChange:this.handleChange,onFocus:this.props.onFocus,onKeyDown:this.handleKeyDown,disabled:this.props.disabled,maxLength:this.props.maxLength,className:h()(v.input,(n={},Object(i.a)(n,v.transparent,this.props.transparent),Object(i.a)(n,v.autoHeight,this.props.autoHeight),Object(i.a)(n,v.invalid,!!this.props.minLength&&this.props.value.length<this.props.minLength),Object(i.a)(n,v.horizontalResize,this.props.horizontalResize),n)),style:{height:this.state.height},rows:this.props.rows,cols:this.props.cols,ref:this.saveRef}):f.a.createElement("input",{id:this.props.id,type:"text",name:this.props.name,placeholder:this.props.placeholder,value:this.props.value,autoComplete:this.props.autoComplete,onBlur:this.props.onBlur,onChange:this.handleChange,onFocus:this.props.onFocus,disabled:this.props.disabled,className:h()(v.input,(t={},Object(i.a)(t,v.transparent,this.props.transparent),Object(i.a)(t,v.invalid,!!this.props.minLength&&this.props.value.length<this.props.minLength),t)),maxLength:this.props.maxLength,ref:this.saveRef,style:a}))}},{key:"triggerChange",value:function(e){(0,this.props.onChange)(e)}},{key:"updateHeight",value:function(e){var t=this.ref;if(null!==t&&this.props.autoHeight){var n=t.style.height;t.value.length<e.length&&(t.style.height="auto"),t.scrollHeight!==this.state.height?this.setState({height:t.scrollHeight}):t.value.length<e.length&&(t.style.height=n)}}}]),t}(f.a.Component);function b(e){return("INPUT"===e.nodeName||"BUTTON"===e.nodeName)&&"submit"===e.type}g.defaultProps={multiline:!1,multilineEnterBehavior:a.BrowserDefault,multilineUseCtrl:!1,autoHeight:!1,fullHeight:!1,horizontalResize:!1,disabled:!1,transparent:!1,rows:1};var y=new Set(["text","search","tel","url","email","password","date","month","week","time","datetime-local","number"]);function k(e){e.stopPropagation()}},463:function(e,t,n){},468:function(e,t,n){},47:function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"first",function(){return b}),n.d(a,"addTag",function(){return y}),n.d(a,"getBackTag",function(){return k}),n.d(a,"clear",function(){return w}),n.d(a,"lockTag",function(){return _}),n.d(a,"infoTag",function(){return x}),n.d(a,"history",function(){return j}),n.d(a,"delTag",function(){return O});var r=n(3),i=n.n(r),o=n(7),s=n(8),c=n(6),l=n(52),u=n(0),d=n.n(u),h=n(10),p=n(2),f=n(31),m=n(21),v=n(11),g=function(e,t,n,a,r,i){return m.b("rpc_tag_edit.php",Object(v.a)({},r,{mode:e,i_id:t,u_id:n,e_id:a}),i)},b=function(e,t,n){return g("first",e,t,n)},y=function(e,t,n,a){return g("add_tag",e,t,n,{value:a})},k=function(e,t,n,a){return g("add_tag",e,t,n,{type:"getback",tag:a})},w=function(e,t,n){return g("clear",e,t,n)},_=function(e,t,n,a,r){return g("lock_tag",e,t,n,{lock:a,tag:r},{ajaxSettings:{dataType:"text"}})},x=function(e,t,n,a,r){return g("info_tag",e,t,n,{num:a,tag:r},{ajaxSettings:{dataType:"text"}})},j=function(e,t,n){return g("history",e,t,n,void 0,{ajaxSettings:{dataType:"text"}})},O=function(e,t,n,a){return g("del_tag",e,t,n,{tag:a})},C=function(e,t,n){return m.a("rpc_comment_history.php",{i_id:e,u_id:t,p:n},{ajaxSettings:{dataType:"json"}})},S=function(e,t,n,a,r,i){return m.b("/rpc_event_map.php",{mode:"save",e_id:e,u_id:t,d_id:n,f_id:a,h_id:r||void 0,value:i.join(",")})},T=function(e,t,n,a,r,i){return m.b("/rpc_event_map.php",{mode:"delete",e_id:e,u_id:t,d_id:n,f_id:a,h_id:r||void 0,id:i})},I=function(){return m.b("/rpc/popular_search_trial.php",{mode:"start"})},M=n(30);function E(){d()(".content_upload_tags .tagCloud").each(function(){var e=d()(this),t=[];if(p.a.test.storage)try{(t=JSON.parse(localStorage["recent_tags"+h.default.user.id])).length||(t=[])}catch(e){t=[]}var n=e.find(".tag_orig");n.remove();for(var a=function(){if(d()(this||window).text()===i)return e.prepend(this||window),o=!0,!1},r=t.length;--r>=0;){var i=t[r],o=!1;e.find("li").each(a),o||t.splice(r,1)}var s=n.text();e.find("li").each(function(){if(d()(this).text()===s)return n=d()(this),d()(this).remove(),!1}),e.prepend(n),p.a.test.storage&&e.parents("form").on("submit",function(){var e=d()(this).find('input[name="tag[]"]').prop("value"),n=e.trim().split(/ +/).reverse();d()(n).each(function(e,n){var a=t.indexOf(n);a>=0&&t.splice(a,1),t.unshift(n)}),t=t.slice(0,30),localStorage["recent_tags"+h.default.user.id]=JSON.stringify(t)});var c=null;function l(){clearTimeout(c),c=setTimeout(function(){e.animate({"max-height":"150"},150)},400)}e.hover(function(){clearTimeout(c),c=setTimeout(function(){e.animate({"max-height":e.get(0).scrollHeight},150)},200)},l),e.css({"max-height":e.get(0).scrollHeight}),l(),e.css("overflow-y","hidden")}),function(){var e=d()("#input_tag0");if(!e.length)return;Z(e.val().split(/\s+|　+/))}(),function(){if(!h.default.user.id||!p.a.test.storage||!(("/member_illust.php"===location.pathname&&location.search.indexOf("illust_id=")>=0||"/novel/show.php"===location.pathname)&&location.search.indexOf("id=")>=0))return;var e;try{e=JSON.parse(localStorage["recently_viewed"+h.default.user.id])}catch(t){e=[]}for(var t,n=h.default.context.illustId,a=Date.now?Date.now():+new Date,r=e.length;--r>=0;){var i=e[r];(i.id===n||a-i.time>864e5)&&(e.splice(r,1),r--)}if("/member_illust.php"===location.pathname)(t=d()('meta[property="og:image"]').attr("content"))&&e.push({type:"illust",img:t,time:a,id:n,author:h.default.context.userName});else if("/novel/show.php"===location.pathname)try{(t=document.querySelector('a[href$="mode=cover"] img').src)&&e.push({type:"novel",img:t,time:a,id:n,author:h.default.context.userName})}catch(e){}e=e.slice(-20),p.a.storage.localStorage("recently_viewed"+h.default.user.id,e)}(),function(){var e=h.default.context.popular_search_trial_cookie_name;if(!h.default.context.popular_search_trial_is_target_user||!{"/tags.php":!0,"/search.php":!0,"/novel/search.php":!0,"/novel/tags.php":!0,"/":!0}[location.pathname])return;d()(".popular-search-trial-start").on("click",function(){I().done(function(e){e.success?window.location.reload():alert(e.message)})});var t=function(){var t=p.a.storage.cookie(e);if(!t)return null;var n=t.split("_"),a=+n[0],r=n[1],i=+n[2];if(!isFinite(a))return null;return{time:a,blob:r,status:i}}();if(t&&0===t.status){var n=Math.floor(t.time-new Date/1e3);n>=0?d()(".popular-search-trial-time-left").each(function(){d()(this).text(Math.floor(n/60))}):(t.status=1,function(t){t?p.a.storage.cookie(e,t.time+"_"+t.blob+"_"+t.status,{expires:2592e6}):p.a.storage.cookie(e,"",{expires:-1})}(t),M.e.open("#popular-search-trial-end-introduction-modal"),p.a.ga.trackEvent(["premium_introduction","modal","popular_search"]))}}(),d()(".js-legacy-toggle-caption").on("click",function(e){e.preventDefault(),function(e){var t=d()(e.currentTarget).dataset("id"),n=d()("#".concat(t,"_caption_short")),a=d()("#".concat(t,"_caption_long")),r=!n.hasClass("_hidden");n.toggleClass("_hidden",r),a.toggleClass("_hidden",!r)}(e)}),d()(".js-legacy-toggle-bookmark-list").on("click",function(e){e.preventDefault(),function(e){var t,n,a,r,i,o,s=document.getElementById("bookmark_list").getElementsByTagName("ul");if("flat"===e){if(""!==s[0].className){var c;for(t=document.getElementById("bookmark_list").getElementsByTagName("li"),a=0;a<t.length;++a)n=t[a],c=a%2==0?"bg_white":"bg_gray","level0"===n.className?n.style.display="list-item":n.getElementsByTagName("a")[0].getElementsByTagName("span")[0].className="",d()(n).removeClass("bg_white bg_gray").addClass(c);"none"===document.getElementById("bookmark_list").style.display&&(document.getElementById("bookmark_list").style.display="block"),s[0].className="",document.getElementById("bookmark_list").style.padding="0",document.getElementById("book_outlist").style.display="none",(r=document.getElementById("bookmark_toggle_btn").getElementsByTagName("a"))[0].getElementsByTagName("span")[0].className="book_flat_on",r[1].getElementsByTagName("span")[0].className="book_cloud_off",i="."+location.hostname.replace(/(\w+)\./,""),(o=new Date).setTime(o.getTime()+2592e6),o=o.toGMTString(),document.cookie="bookToggle=flat; expires="+o+"; domain="+i+"; path=/"}}else if("cloud"===e&&"tagCloud"!==s[0].className){for(t=document.getElementById("bookmark_list").getElementsByTagName("li"),a=0;a<t.length;a++)t[a].className=t[a].className.replace(/bg_white|bg_gray/g,""),t[a].className=t[a].className.replace(/ /g,""),"level0"===t[a].className?t[a].style.display="none":t[a].getElementsByTagName("a")[0].getElementsByTagName("span")[0].className="cnt";s[0].className="tagCloud",document.getElementById("book_outlist").style.display="block",(r=document.getElementById("bookmark_toggle_btn").getElementsByTagName("a"))[0].getElementsByTagName("span")[0].className="book_flat_off",r[1].getElementsByTagName("span")[0].className="book_cloud_on",i="."+location.hostname.replace(/(\w+)\./,""),(o=new Date).setTime(o.getTime()+2592e6),o=o.toGMTString(),document.cookie="bookToggle=cloud; expires="+o+"; domain="+i+"; path=/"}}(d()(e.currentTarget).dataset("type"))}),d()(".js-legacy-show-tag-area").on("click",function(e){e.preventDefault(),function(){var e=d()("#view_tag0"),t=d()("#btn_show0"),n=d()("#btn_hide0");"none"===e.css("display")?(e.show(),t.hide(),n.show()):(e.hide(),t.show(),n.hide())}()}),d()(".js-legacy-mark-all").on("click",function(e){e.preventDefault(),V(!0)}),d()(".js-legacy-unmark-all").on("click",function(e){e.preventDefault(),V(!1)}),d()(".js-legacy-handle-new-folder").on("change",function(e){var t=e.currentTarget;"new"===t.value&&1===t.selectedIndex&&function(e){var t=prompt("新規フォルダー名を指定してください","");if(null==t)e.selectedIndex=0;else{var n=t.replace(/[ 　]+/g,"");if(""===n)e.selectedIndex=0;else{var a="未分類"===n?"":n,r=Array.from(e.options),i=r.find(function(e){return e.value===a});if(null!=i)i.selected=!0;else{var o=new Option(a,a);e.insertBefore(o,r.length>2?r[2]:null),o.selected=!0}}}}(t)}),d()(".js-legacy-tag-cloud-tag").on("click",function(e){e.preventDefault();var t=e.currentTarget.textContent,n=d()("#input_tag0"),a=p.a.ui.Tag.split(n.val()),r=a.includes(t)?a.filter(function(e){return e!==t}):Object(l.a)(a).concat([t]);n.val(r.join(" ").trim()),Z(r)}),d()(".js-legacy-update-input-tag").on("keyup",function(e){Z(d()(e.currentTarget).val().split(/\s+|　+/))})}n.d(t,"q",function(){return E}),n.d(t,"b",function(){return N}),n.d(t,"r",function(){return P}),n.d(t,"s",function(){return L}),n.d(t,"a",function(){return U}),n.d(t,"c",function(){return z}),n.d(t,"g",function(){return A}),n.d(t,"h",function(){return R}),n.d(t,"k",function(){return F}),n.d(t,"i",function(){return B}),n.d(t,"e",function(){return H}),n.d(t,"o",function(){return Y}),n.d(t,"d",function(){return J}),n.d(t,"j",function(){return Q}),n.d(t,"n",function(){return ee}),n.d(t,"f",function(){return te}),n.d(t,"l",function(){return re}),n.d(t,"p",function(){return ie}),n.d(t,"m",function(){return se}),n.d(t,"t",function(){return ce});var N={setup:function(){d()(".comment-show-button").on("click",function(){var e=d()(this).closest(".comment-area");C(h.default.context.illustId,h.default.context.userId).done(function(t){t.error||(e.addClass("comment-open"),t.data.html_array&&(t.data.html_array.length?e.find(".comment-list").append(t.data.html_array.join("")):e.addClass("comment-none")),t.data.more?e.addClass("comment-more"):e.removeClass("comment-more"))})});var e=1;d()(".comment-more-button").on("click",function(){var t=d()(this).closest(".comment-area");C(h.default.context.illustId,h.default.context.userId,++e).done(function(e){e.error||(e.data.html_array&&e.data.html_array.length&&t.find(".comment-list").append(e.data.html_array.join("")),e.data.more?t.addClass("comment-more"):t.removeClass("comment-more"))})}),d()(".comment-area").on("click",".comment-delete-icon",function(){if(confirm("コメントを削除しますか？")){var e=d()(this).closest(".comment-item");(function(e,t){return m.b("rpc_delete_comment.php",{i_id:e,del_id:t},{ajaxSettings:{dataType:"json"}})})(h.default.context.illustId,e.dataset("commentId")).done(function(t){t.error||e.remove()})}})}};var D={tags:null,container:"#tag-editor",tagContainer:".work-tags",show:function(e){this.tags=e.tags;var t=d()(this.container).html(e.html);t.is(":hidden")&&(d()(this.tagContainer).slideUp("fast"),t.slideDown("fast"))},update:function(){this.tags&&d()(this.tagContainer+" .tags-container").html(p.a.template("work-tags",{tags:this.tags})),this.tags=null}};function P(){a.first(h.default.context.illustId,h.default.context.userId,h.default.user.id).done(function(e){D.show(e)})}function L(e){if(e&&e.preventDefault(),a.history(h.default.context.illustId,h.default.context.userId,h.default.user.id).done(function(e,t,n){!function(e){(new W).display(e)}(n)}),!e)return!1}function U(){var e=d()("#add_tag").val();e&&(d()("#add_tag_area").html("Loading ..."),a.addTag(h.default.context.illustId,h.default.context.userId,h.default.user.id,e).done(function(e){D.show(e)}))}function z(e){var t=d()("#tag"+e).text();if(t){if("novel"!==d()("#rpc_t_id").text()&&!confirm("このタグを削除しますか？\n*投稿者にユーザーIDが通知されます。"))return;d()("#del_btn_"+e).text("Loading ..."),G(),a.delTag(h.default.context.illustId,h.default.context.userId,h.default.user.id,t).done(function(e){D.show(e)})}}function A(e){var t=d()("#h_tag"+e).text();t&&(d()("#getback_btn_"+e).text("Loading ..."),G(),a.getBackTag(h.default.context.illustId,h.default.context.userId,h.default.user.id,t).done(function(e){D.show(e)}))}function R(){d()("#history_clear_btn").text("Loading ..."),G(),a.clear(h.default.context.illustId,h.default.context.userId,h.default.user.id).done(function(e){D.show(e)})}function F(e){var t=Number(d()("#lock_tag"+e).prop("checked")),n=d()("#tag"+e).text();a.lockTag(h.default.context.illustId,h.default.context.userId,h.default.user.id,t,n).done(function(e,t,n){})}function B(){return $.apply(this,arguments)}function $(){return($=Object(c.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d()("#infotag").val(),n=d()("#tag"+t).text(),r=d()("#info_tag_result"),t){e.next=7;break}r.css("display","block").text("選択してください"),e.next=17;break;case 7:if(!n){e.next=17;break}return r.css("display","block").text("Loading ..."),G(),e.prev=10,e.next=13,a.infoTag(h.default.context.illustId,h.default.context.userId,h.default.user.id,t,n);case 13:r.text("報告しました");case 14:return e.prev=14,K(),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[10,,14,17]])}))).apply(this,arguments)}var W=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,[{key:"display",value:function(e){for(var t=JSON.parse(e.responseText),n="",a=0;a<t.html.length;a++)n+=t.html[a];d()("#tag_history").html(n),d()("#tag_history").is(":hidden")&&d()("#tag_history").slideDown("fast"),d()("#tag_history_btn").html('<a href="#">閉じる</a>').children("a").on("click",q)}}]),e}();function H(){var e=d()("#tag-editor");e.is(":visible")&&(D.update(),e.slideUp("fast"),d()(".work-tags").slideDown("fast"))}function q(e){e.preventDefault(),d()("#tag_history").is(":visible")&&d()("#tag_history").slideUp("fast"),d()("#tag_history_btn").html('<a href="#">表示する</a>').children("a").on("click",L)}function G(){var e,t,n=document.getElementById("rpc").getElementsByTagName("tr");document.getElementById("add_tag_area").getElementsByTagName("input").length>0&&(document.getElementById("add_tag_area").getElementsByTagName("input")[0].disabled=!0,document.getElementById("add_tag_area").getElementsByTagName("input")[1].disabled=!0),document.getElementById("infoTagArea")&&document.getElementById("infoTagArea").getElementsByTagName("input")[0]&&(document.getElementById("infoTagArea").getElementsByTagName("input")[0].disabled=!0),document.getElementById("info_tag_btn")&&document.getElementById("info_tag_btn").getElementsByTagName("input")[0]&&(document.getElementById("info_tag_btn").getElementsByTagName("input")[0].disabled=!0);for(var a=0;a<n.length;a++){e=n[a].getElementsByTagName("input").length;for(var r=0;r<e;r++)!(t=n[a].getElementsByTagName("input")[r])||"checkbox"!==t.type&&"radio"!==t.type&&"button"!==t.type&&"submit"!==t.type||(t.disabled=!0)}return!0}function K(){var e,t,n=d()("#rpc tr");d()("#add_tag_area input").prop("disabled",!1),d()("#history_clear_btn input").prop("disabled",!1);for(var a=0;a<n.length;a++){e=n[a].getElementsByTagName("input").length;for(var r=0;r<e;r++)!(t=n[a].getElementsByTagName("input")[r])||"checkbox"!==t.type&&"radio"!==t.type&&"button"!==t.type&&"submit"!==t.type||(t.disabled=!1)}return!0}function V(e){d()(".js-legacy-mark-unmark-list").find('input[type="checkbox"]').prop("checked",e)}function Y(e,t){e=d()("string"==typeof e?"#"+e:e),t=d()("string"==typeof t?"#"+t:t),e[0].checked&&t.is(":hidden")?t.stop(!0,!0).slideDown("fast"):t.stop(!0,!0).slideUp("fast")}function Z(e){e=d.a.grep(e,function(e){return e});var t=d()("#bookmark_add_alert")[0],n=d()("#bookmark_tag_count")[0],a=e.length;a>10?(t.style.display="block",n.style.color="#ff0000"):(t.style.display="none",n.style.color="#666666"),n.innerHTML=a}function J(e,t){return f.b.deleteImage(t,e).then(function(e){"ok"===e.result&&("big"===e.type?d()("#big_img").html('<input name="big" type="file" size="30">'):d()("#small_img").html('<input name="small" type="file" size="30">'))})}function Q(e,t){return d()("#calendar").text("Loading..."),f.b.calendar(e,t).then(function(e){var t=e.year,n=e.month;d()("#calendar_now").text(t+"/"+n).attr("href","?d="+t+n),d()("#calendar_prev")[0].onclick=function(){Q(e.prev_year,e.prev_month)},d()("#calendar_next")[0].onclick=function(){Q(e.next_year,e.next_month)},d()("#calendar").html(e.calendar)})}function X(e,t){return Array.isArray(e)?S(h.default.context.eventId,h.default.user.id,t.day||h.default.context.day,t.floor||h.default.context.floor,t.hall,e):T(h.default.context.eventId,h.default.user.id,t.day||h.default.context.day,t.floor||h.default.context.floor,t.hall,e)}var ee={setup:function(){d()("input.add-my-list").on("click",ee.add),d()("input.remove-my-list").on("click",ee.remove)},add:function(){var e=Object(c.a)(i.a.mark(function e(){var t,n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d()(this),n=[t.dataset("circle-id")],a={hall:t.dataset("hall"),day:t.dataset("day")},e.next=5,X(n,a);case 5:t.replaceWith(['<a href="/event_member.php?event_id='+h.default.context.eventId+'&amp;mode=mylist">',t.dataset("complete"),"</a>"].join(""));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),remove:function(){var e=Object(c.a)(i.a.mark(function e(){var t,n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d()(this),n=t.dataset("circle-id"),a={hall:t.dataset("hall"),day:t.dataset("day")},e.next=5,X(n,a);case 5:t.replaceWith(t.dataset("complete"));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()};function te(e,t){var n=ne(e=d()("#"+e)[0]);if(n)return ae(e,"<"+t+">"+n+"</"+t+">"),!1}function ne(e){if(document.selection)return e.focus(),document.selection.createRange().text;e.focus();var t=e.textLength,n=e.selectionStart,a=e.selectionEnd;return 1!==a&&2!==a||(a=t),e.value.substring(n,a)}function ae(e,t){if(document.selection){e.focus(),document.selection.createRange().text=t}else{var n=e.textLength,a=e.selectionStart,r=e.selectionEnd;1!==r&&2!==r||(r=n),e.value=e.value.substring(0,a)+t+e.value.substr(r,n),e.selectionStart=a+t.length,e.selectionEnd=a+t.length}e.focus()}function re(e){for(var t=["#000000","#7f7f7f","#bfbfbf","#fe3a20","#febc15","#bfbd00","#53c900","#00c1ff","#f97ff8","#8d0000","#d9944f","#867c2f","#008e46","#303acc","#bf2d96","#3e027d"],n=0,a=0,r=0,i="";n<4;){for(;a<4;)i+='<div class="color">',i+='<a href="#" data-idx="'+r+'">',i+='<img src="https://s.pximg.net/source/images/spacer.gif" border="0" width="14" height="14" style="background-color:'+t[r]+'">',i+="</a></div>",r++,a++;i+='<div class="clear"></div>',a=0,n++}var o="";o+='<div class="title">パレット</div>',o+='<div class="close"><a href="#"><img src="https://s.pximg.net/source/images/close3.gif"></a></div>',o+='<div class="clear"></div>',o+='<div class="palette">'+(i+="</table>")+"</div>";var s=d()("#color_palette");s.html(o),s.find(".title").off(".palette").on("click.palette",oe),s.find(".close > a").off(".palette").on("click.palette",oe),s.find(".color > a").off(".palette").on("click.palette",function(n){var a=d()(n.currentTarget).dataset("idx");return function(e,t){var n=ne(e=d()("#"+e)[0]);if(n)return ae(e,'<span style="color:'+t+';">'+n+"</span>"),oe(),!1}(e,t[a])})}function ie(){var e=d()("#color_palette");"none"===e.css("display")?(e.css("left",30),e.show()):e.hide()}function oe(){d()("#color_palette").hide()}function se(e){for(var t,n=document.getElementById(e).getElementsByTagName("tr"),a=0;a<n.length;a++)(t=n[a].getElementsByTagName("input")[0])&&"checkbox"===t.type&&(t.checked||(t.checked=!0));return!0}function ce(e){for(var t,n=document.getElementById(e).getElementsByTagName("tr"),a=0;a<n.length;a++)(t=n[a].getElementsByTagName("input")[0])&&"checkbox"===t.type&&t.checked&&(t.checked=!1);return!0}},470:function(e,t,n){},48:function(e,t,n){"use strict";n.d(t,"k",function(){return u}),n.d(t,"a",function(){return d}),n.d(t,"l",function(){return h}),n.d(t,"c",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"m",function(){return v}),n.d(t,"f",function(){return g}),n.d(t,"n",function(){return b}),n.d(t,"d",function(){return y}),n.d(t,"p",function(){return k}),n.d(t,"b",function(){return w}),n.d(t,"e",function(){return _}),n.d(t,"i",function(){return x}),n.d(t,"j",function(){return j}),n.d(t,"h",function(){return O}),n.d(t,"o",function(){return C});var a=n(28),r=n(11),i=n(29),o=n(9),s=n(0),c=n.n(s),l=n(23);function u(e,t){try{var n=JSON.parse(e);return!1!==t&&null!=n&&"object"===Object(i.a)(n)?h(n):n}catch(t){return e}}function d(e,t){return{data:e,expires:t instanceof Date?t:+new Date+(t||0)}}function h(e){var t=e.expires;return t||0===t?+new Date>t?void 0:e.data:e}var p=(/[-a-z]+\.[a-z]+$/.exec(location.hostname)||[])[0];function f(e,t,n){return function(a,i,s){var c=o.default.letterCase((e?"".concat(e,"_"):"")+a,"cookie"),l=Object(r.a)({expires:7776e6,path:"/",domain:p},t,s);return n&&!1===n.update||void 0!==i?y(c,i,l):k(c,l)}}function m(e){return function(t,n,a){var r=e[t];switch(n){case void 0:return r?h(r):void 0;case null:delete e[t];break;default:e[t]=a?d(n,a):n}}}function v(e,t){return b("session",e,t)}function g(e,t,n){var a=t,r=n;if(null!==a&&void 0!==a){if(!r&&null!==r){var i=u(b("local",e),!1);i&&i.expires&&(r=i.expires)}r&&(a=d(a,r))}return b("local",e,a)}function b(e,t,n){if(o.default.test.storage&&t){var a="session"===e?window.sessionStorage:"local"===e?window.localStorage:void 0;if(a)switch(n){case null:a.removeItem(t);break;case void 0:return u(a[t]);default:try{a.removeItem(t),a.setItem(t,JSON.stringify(n))}catch(e){Object(l.a)("colon.storage").error(e)}}}}function y(e,t,n){if(e){var r=t,i=n;switch(r){case void 0:var o=document.cookie;if(o){var s=o.split(";").map(function(e){return e.trim()}).find(function(t){return t&&t.startsWith("".concat(e,"="))});if(s)return decodeURIComponent(s.substr(e.length+1))}break;default:i=i||{},null===r&&(r="",i.expires=-1);var c={expires:i.expires?new Date(+new Date+i.expires).toUTCString():void 0,path:i.path,domain:i.domain},l=Object.entries(c).filter(function(e){return!!Object(a.a)(e,2)[1]}).map(function(e){var t=Object(a.a)(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)});i.secure&&l.push("secure"),l.unshift(encodeURIComponent(r)),document.cookie="".concat(e,"=").concat(l.join(";"))}}}function k(e,t){var n=y(e);return void 0!==n&&(y(e,null),y(e,n,t)),n}function w(){if(o.default.test.storage){var e,t,n,a=[];for(e=0,t=window.localStorage.length;e<t;++e)a[e]=window.localStorage.key(e);for(e=0,t=a.length;e<t;++e)n=a[e],void 0===u(window.localStorage.getItem(n))&&g(n,null)}}function _(e){return e.replace(/(_+)/g,"$1_").replace(/\./g,"_")}function x(e,t,n){var a;o.default.w[n?"one":"on"]("storage.".concat(_(e)),function(n){var r=n.originalEvent;r.key===e&&null!==(a=u(r.newValue))&&(Object(l.a)("colon.storage").debug("trigger",r.key,a),t(a,"storage",r))})}function j(e,t){return x(e,t,!0)}function O(e){o.default.w.off("storage.".concat(_(e)))}function C(e,t){var n,a;switch(Object(i.a)(e)){case"function":if(e.done)return e;e.done=!0,n=e;break;case"object":n=m(e);break;case"number":a=e,n=g;break;default:n=!0===e?v:null}var r=function(e){return Object(l.a)("colon.storage").debug("storageObject",t,e,a),n(t,e,a)};return r.update=function(e){r(c.a.extend(!0,r(),e))},r}},50:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d});var a=n(7),r=n(14),i=n(12),o=n(13),s=n(143),c=n(15),l=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(i.a)(t).call(this,Object(c.d)(e)))).name="PixivApiError",n}return Object(o.a)(t,e),t}(s.BaseError),u=function(e){function t(e,n){var o;return Object(a.a)(this,t),(o=Object(r.a)(this,Object(i.a)(t).call(this,"".concat(e,": ").concat(n)))).name="HttpError",o.code=e,o}return Object(o.a)(t,e),t}(s.BaseError),d=function(e){function t(e,n,o,s){var c;return Object(a.a)(this,t),(c=Object(r.a)(this,Object(i.a)(t).call(this,"Status ".concat(o,": ").concat(e," ").concat(n).concat(s?" (".concat(s,")"):"")))).name="RequestError",c}return Object(o.a)(t,e),t}(s.BaseError)},54:function(e,t,n){"use strict";n.d(t,"g",function(){return d}),n.d(t,"c",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"b",function(){return f}),n.d(t,"d",function(){return m}),n.d(t,"f",function(){return v}),n.d(t,"h",function(){return b});var a,r,i=n(11),o=n(32),s=n(19),c=n(36),l=(n(53),n(96)),u=n(145);function d(e){return{type:a.Import,payload:e}}function h(e,t){return{type:a.MuteUserId,payload:{value:e,premium:t}}}function p(e){return{type:a.UnmuteUserId,payload:e}}function f(e,t){return{type:a.MuteTag,payload:{value:e,premium:t}}}function m(e){return{type:a.UnmuteTag,payload:e}}n.d(t,"i",function(){return u}),function(e){e.Import="pixiv/mute/IMPORT",e.MuteTag="pixiv/mute/MUTE_TAG",e.UnmuteTag="pixiv/mute/UNMUTE_TAG",e.MuteUserId="pixiv/mute/MUTE_USER_ID",e.UnmuteUserId="pixiv/mute/UNMUTE_USER_ID"}(a||(a={})),function(e){e[e.Tag=0]="Tag",e[e.User=1]="User"}(r||(r={})),t.a=function(e,t){var n=e;if(void 0===n)n={tags:[],userIds:[],modal:u.default(void 0,t)};else{var o=u.default(n.modal,t);o!==n.modal&&(n=Object(i.a)({},n,{modal:o}))}switch(t.type){case a.Import:var l=[],d=[],h=!0,p=!1,f=void 0;try{for(var m,v=t.payload[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=m.value;0,g.type===r.Tag?l.push({value:g.value,premium:g.premiumSlot}):g.type===r.User?d.push({value:g.value,premium:g.premiumSlot}):Object(s.i)(g.type)}}catch(e){p=!0,f=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw f}}return Object(i.a)({},n,{tags:l,userIds:d});case a.MuteTag:var b=t.payload,y=b.value,k=b.premium;return n.tags.some(function(e){return e.value===y})?n:Object(i.a)({},n,{tags:n.tags.concat({value:y,premium:k})});case a.UnmuteTag:var w=t.payload,_=n.tags.filter(function(e){return e.value!==w});return _.length===n.tags.length?n:Object(i.a)({},n,{tags:_});case a.MuteUserId:var x=t.payload,j=x.value,O=x.premium;return n.userIds.some(function(e){return e.value===j})?n:Object(i.a)({},n,{userIds:n.userIds.concat({value:j,premium:O})});case a.UnmuteUserId:var C=t.payload,S=n.userIds.filter(function(e){return e.value!==C});return S.length===n.userIds.length?n:Object(i.a)({},n,{userIds:S});default:Object(c.b)(t)}return n};var v=Object(o.createSelector)(function(e){return e.mute},function(e){return e.tags.length>0||e.userIds.length>0}),g=Object(o.createSelector)(l.a,l.b,function(e){return e.mute.userIds},function(e){return e.mute.tags},function(e,t,n,a){return function(r,i){return function(e,t,n,a,r,i){if(r.userId===e)return!1;var o=void 0!==i?i.tags.map(function(e){return e.tag}):Object(s.c)(r.tags);return function(e,t,n){return e.some(function(e){return e.value===n&&(t||!e.premium)})}(n,t,r.userId)||o.some(function(e){return function(e,t,n){return e.some(function(e){return e.value===n&&(t||!e.premium)})}(a,t,e)})}(e,t,n,a,r,i)}}),b=Object(o.createSelector)(g,function(e,t){return t},function(e,t,n){return n},function(e,t,n){return e(t,n)})},56:function(e,t,n){e.exports={recommendUser:"_1xrb_Xu",carousel:"_3_QFbWe",userContainer:"_1WkEsqC",userMetaContainer:"_1C0KBug",userIconContainer:"_0ILCzd",userIcon:"_2H1q3qG",userNameContainer:"_2tp9rfS",userName:"_3TXLewh",followButtonContainer:"_2zhAeXl",thumbnail:"_2zvwa6t",thumbnailContainer:"_2xEt0e8",novel:"_1WDtuok",muted:"_3kIbj_b",current:"_36W8ZfB",mutedText:"v72YHkw"}},57:function(e,t,n){e.exports={guideWrapper:"WvvV_bj",title:"_28SSOHu",guide:"_2kXk_1D",example:"OitlPNX",fromMenuExample:"_2XGYvsi",fromFormExample:"_3KZeEgz",text:"_2_-1UHQ","_icon-dot":"kKggUHd",twoColumnGuide:"_3XqVxxx",guideColumn:"uPn16VH"}},576:function(e,t,n){"use strict";var a=n(11),r=n(9),i=n(0),o=n.n(i),s=n(22),c=n.n(s),l=n(23);r.default.truncate=function(e,t){var n=e||"";return n.length>t?n.slice(0,t)+"...":n};var u=/^(-?\d+)(\d{3})/;r.default.format=function(e){for(var t=e.toString();t!==(t=t.replace(u,"$1,$2")););return t},r.default.padding=function(e,t){for(var n=t||2,a=e,r=a.toString().split(".")[0].length;r++<n;)a="0"+a;return a},r.default.unique=function(e){e.filter(function(e,t,n){return n.indexOf(e)===t})},r.default.template=function(e,t){var n=r.default.config.templates[e];if(Object(l.a)("deprecated template",!1).trace(e,n),!n){var a=o()("#template-"+e).html();if(!a)throw new Error("Could not find template '".concat(e,"'"));n=c.a.compile(a),r.default.config.templates[e]=n}return"".concat(n(t)).trim().replace(/^[\x20\t]+/gm,"").replace(/[\x20\t]+$/gm,"").replace(/[\r\n]+/g,"")};r.default.query={slim:function(e){var t,n,a={};for(t in e)null!==(n=e[t])&&void 0!==n&&(a[t]=n);return a},build:function(e,t){var n,a=window.encodeURIComponent,i=[],o=e,s=t;for(n in 1===arguments.length&&(s=o,o=location.pathname),s=r.default.query.slim(s))i.push(a(n)+"="+a(s[n]));return Object(l.a)("colon.query",!1).debug("build",o,i),o+((i=i.join("&")).length?(-1===o.indexOf("?")?"?":"&")+i:"")},replace:function(e,t,n){var i=r.default.query.build(Object(a.a)({},r.default.query.parse(),e))+(!1!==n?location.hash:"");return i!==location.href&&t&&window.history.replaceState&&window.history.replaceState(null,"",i),i},parse:function(e){var t,n,a,r=(e||window.location.search).replace(/^[^?]*\?/,"").replace(/\+/g," ").split("&"),i=window.decodeURIComponent,o=/^([^=]+)=(.*)$/,s={};for(t=0;n=r[t];++t)(a=o.exec(n)||[])[1]&&(s[i(a[1])]=a[2]&&i(a[2]));return Object(l.a)("colon.query",!1).debug("parse",s),s}},r.default.query.base=r.default.query.parse(),r.default.lazyImage=function(e){var t=o()("._lazy-image",e);if(!t.closest(e).is(e))return!1;t.each(function(){var e=o()(this);e.attr("src",e.dataset("src")).removeClass("_lazy-image")})},r.default.html={escape:function(e){return e.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescape:function(e){return e.toString().replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},iframe:function(e,t){var n=r.default.query.build(e,t);return o()('<iframe src="'+n+'" marginwidth="0" marginheight="0" frameborder="0" allowtransparency="true" scrolling="no"></iframe>')}}},577:function(e,t,n){"use strict";var a=n(0),r=n.n(a);r.a.easing.easeOutExpo=function(e){return 1===e?1:1-Math.pow(2,-10*e)},r.a.fn.reverse=function(){return r()(this.get().reverse())}},578:function(e,t,n){"use strict";var a=n(9),r=n(22),i=n.n(r);i.a.registerHelper("is",function(e,t,n,a){return("=="===t?e==n:"!="===t?e!=n:"<"===t?e<n:"<="===t?e<=n:">"===t?e>n:">="===t?e>=n:"&&"===t?e&&n:"||"===t&&(e||n))?a.fn(this):a.inverse(this)}),i.a.registerHelper("eq",function(e,t,n){return e==t?n.fn(this):n.inverse(this)}),i.a.registerHelper("ne",function(e,t,n){return e!=t?n.fn(this):n.inverse(this)}),i.a.registerHelper("t",function(){return a.default.t.apply(a.default,arguments)}),i.a.registerHelper("url_encode",function(e){return encodeURIComponent(e)}),i.a.registerHelper("comma",function(e){return a.default.format(e)}),i.a.registerHelper("format",function(e){return a.default.format(e)}),i.a.registerHelper("truncate",function(e,t){return a.default.truncate(e,t)}),i.a.registerHelper("join",function(e,t){var n=t.fn,a=t.inverse,r=[];if(e&&e.length){for(var i=0,o=e.length;i<o;++i)r[i]=n(e[i]);r=r.join(t.hash.separator)}else r=a(this);return r}),i.a.registerHelper("get_thumbnail_classes",function(e,t,n,a){var r=" _work";return"1"===t?r+=" manga":"2"===t&&(r+=" ugoku-illust"),parseInt(n)>1&&(r+=" multiple","1"===a?r+=" rtl":"2"===a&&(r+=" ltr")),r})},579:function(e,t,n){"use strict";n(29),n(52);var a=n(9),r=n(23);a.default.ga={setup:function(){this.trackEvent()},track:function(e){Object(r.a)("colon.ga").debug("track",e);try{_gaq.push(e)}catch(e){}},trackEvent:function(e){var t=a.default.storage.localStorage("refs")||[];Object(r.a)("colon.ga").debug("refs",t);var n=e?[e].concat(t):t,i=!0,o=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var u=c.value;u.unshift("_trackEvent"),a.default.ga.track(u)}}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}a.default.storage.localStorage("refs",null)},trackPageview:function(e){a.default.ga.track(["_trackPageview",e])},later:function(e){var t=a.default.storage.localStorage("refs")||[];t.push(e.filter(function(e){return void 0!==e})),Object(r.a)("colon.ga").debug("later",t),a.default.storage.localStorage("refs",t)}}},580:function(e,t,n){"use strict";var a=n(9),r=n(0),i=n.n(r);a.default.fallback={setup:function(){a.default.ua.ie&&a.default.fallback.focus()}},a.default.fallback.focus=function(){i()("input[autofocus]:last").trigger("focus")}},581:function(e,t,n){"use strict";var a=n(9),r=n(0),i=n.n(r);a.default.$={},a.default.$.find=function(e,t){var n=i()(e,t);return!!n.length&&n}},582:function(e,t,n){"use strict";var a=n(29),r=n(9),i=n(23),o=Object(i.a)("dispatch",2);r.default.dispatcher={location:window.location,stash:[],connect:function(e,t,n,r){if(e||0===e){var i=e.valueOf();("object"!==Object(a.a)(i)||i instanceof RegExp)&&(i={pathname:i}),this.stash.push([i,t,n,r])}return this},and:function(){var e=this.stash,t=e.length;return t&&(e[t-1][3]=!0),this},dispatch:function(e){for(var t,n=e||this.location,a=this.stash,r={},i=0;t=a[i];++i){var s=t[0],c=t[1],l=t[2],u=t[3],d=!1;for(var h in s){var p=s[h],f=n[h];if(f){var m=this.match(p,f);if(!(d=!!m))break;o.debug("matched",m),r[h]=m}}if(d&&(c&&c.call(l,r),!u))break}return this.clear(),this},match:function(e,t){var n=e;return o.debug("compare",n,t),n instanceof RegExp?n.exec(t)||!1:(n=n.toString())===t&&n},clear:function(){return this.stash=[],this}}},61:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return u});var a=n(2),r=n(48),i="colon.broadcast",o=new Map;function s(e,t){o.has(e)||o.set(e,new Set),o.get(e).add(t)}function c(e,t){if(t){var n=o.get(e);n&&(n.delete(t),0===n.size&&o.delete(e))}else o.delete(e)}function l(e,t){a.a.test.storage&&(r.f(i,{name:e,data:t}),r.f(i,null))}function u(){a.a.test.storage&&r.i(i,function(e){!function(e,t){var n=o.get(e);if(n){var a=!0,r=!1,i=void 0;try{for(var s,c=n[Symbol.iterator]();!(a=(s=c.next()).done);a=!0)(0,s.value)(t)}catch(e){r=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}}}(e.name,e.data)})}},62:function(e,t,n){e.exports={container:"_1aIx0AU",header:"_2zunBj9",settingsLink:"_2iotWRI",filter:"_2UKzsco",current:"_2b8aaPV",scrollArea:"C0UcBEZ",notificationList:"_2q1SB7Q",staticNotifications:"_3wbRDOx",staticNotificationIcon:"_2RjJLAZ",loadingArea:"_1hbk4hB",nothing:"_1pwwkTf",footer:"_lZyt6S"}},63:function(e,t,n){"use strict";var a=n(94);n.d(t,"b",function(){return a.b}),n.d(t,"c",function(){return a.c});var r=n(159);n.d(t,"a",function(){return r.a})},65:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return m});var a,r=n(1),i=n(7),o=n(8),s=n(14),c=n(12),l=n(13),u=n(4),d=n.n(u),h=n(15),p=n(106);!function(e){e.Optional="オプション"}(a||(a={}));var f=0,m=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(s.a)(this,Object(c.a)(t).apply(this,arguments))).uniqueId=f++,e}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e="form-section-".concat(this.uniqueId,"-label");return Object(r.a)("div",{className:p.section,role:this.props.role,"aria-labelledby":e},void 0,Object(r.a)("div",{className:p.titleWrapper},void 0,Object(r.a)("h2",{id:e,className:p.title},void 0,this.props.title),void 0!==this.props.badge&&Object(r.a)(v,{},void 0,this.props.badge),this.props.auxLabel&&Object(r.a)("span",{className:p.auxLabel},void 0,this.props.auxLabel),this.props.detailsButtonLabel&&!this.props.detailsButtonLink&&Object(r.a)("button",{className:p.detailsButton,type:"button",onClick:this.props.detailsButtonClick,disabled:this.props.detailsButtonDisabled},void 0,this.props.detailsButtonLabel),this.props.detailsButtonLabel&&this.props.detailsButtonLink&&Object(r.a)("a",{className:p.detailsButtonLink,href:this.props.detailsButtonLinkUrl,target:"_blank",rel:"noopener"},void 0,this.props.detailsButtonLabel)),this.props.children)}}]),t}(d.a.Component);function v(e){var t=e.children;return Object(r.a)("span",{role:"note",className:p.badge},void 0,Object(h.d)(t))}m.defaultProps={role:"group"}},66:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return u});var a=n(7),r=n(8),i=n(16),o=n(0),s=n.n(o);function c(e,t){var n,a={},r=new RegExp("^(".concat(e,")([A-Z].+)?$"));for(var i in t)(n=r.exec(i))&&n[1]===e&&(n[2]?a[n[2].charAt(0).toLowerCase()+n[2].slice(1)]=t[i]:a[n[1]]=t[i],delete t[i]);return a}function l(e){var t="function"==typeof e?e(document.title,l.original):e;t!==document.title&&(document.title=null===t?l.original:t||"")}var u=function(){function e(t,n){Object(a.a)(this,e),Object(i.a)(this,"finished",!1),Object(i.a)(this,"type","loading-indicator"),this.container=s()(t),n&&(this.type="".concat(this.type,"-").concat(n))}return Object(r.a)(e,[{key:"start",value:function(){return this.finished?this:(s()(".".concat(this.type),this.container).length||s()('<div class="'.concat(this.type,'"></div>')).appendTo(this.container),this.container.addClass("_loading"),this)}},{key:"stop",value:function(){return this.container.removeClass("_loading"),this}},{key:"finish",value:function(){return this.stop(),s()(".".concat(this.type),this.container).remove(),this.finished=!0,this}}]),e}()},68:function(e,t,n){"use strict";var a,r=n(28),i=n(7),o=n(8),s=n(2),c=n(0),l=n.n(c),u=n(10),d=n(89),h=n(3),p=n.n(h),f=n(11),m=n(6),v=n(29),g=n(14),b=n(12),y=n(13),k=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(g.a)(this,Object(b.a)(t).apply(this,arguments))).name="ZipImagePlayerError",e}return Object(y.a)(t,e),t}(n(143).BaseError);!function(e){e[e.Initial=0]="Initial",e[e.Loading=1]="Loading",e[e.Done=2]="Done"}(a||(a={}));var w=function(){function e(){Object(i.a)(this,e),this.listeners=new Map}return Object(o.a)(e,[{key:"addEventListener",value:function(e,t,n){this.listeners.set(t,{type:e,once:"object"===Object(v.a)(n)&&!!n.once})}},{key:"createEvent",value:function(e,t,n){if("undefined"!=typeof CustomEvent){if(x){var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,!1,t,n),a}return new CustomEvent(e,{bubbles:!1,cancelable:t,detail:n})}var r=Object.defineProperty(document.createEvent("Event"),"detail",{value:n,enumerable:!0});return r.initEvent(e,!1,t),r}},{key:"dispatchEvent",value:function(e){Object.defineProperties(e,{target:{value:this,enumerable:!0},currentTarget:{value:this,enumerable:!0}});var t=!0,n=!0,a=!1,i=void 0;try{for(var o,s=this.listeners[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=Object(r.a)(o.value,2),l=c[0],u=c[1];u.type===e.type&&(l.call(this,e),e.cancelable&&(t=t&&!e.defaultPrevented),u.once&&this.removeEventListener(e.type,l))}}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return t}},{key:"removeEventListener",value:function(e,t,n){var a=!0,i=!1,o=void 0;try{for(var s,c=this.listeners[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=Object(r.a)(s.value,2),u=l[0],d=l[1];u===t&&d.type===e&&this.listeners.delete(u)}}catch(e){i=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(i)throw o}}}}]),e}(),_=Object.prototype.toString.call(HTMLElement).indexOf("Constructor")>=0,x=navigator.userAgent.indexOf("Trident")>=0,j="undefined"!=typeof chrome,O=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(g.a)(this,Object(b.a)(t).call(this))).op=e,n._maxLoadAhead="undefined"==typeof URL?(n._debugLog("No URL support! Will use slower data: URLs."),10):0,n._loadingState=a.Initial,n._dead=!1,n._context=n.op.canvas.getContext("2d"),n._files={},n._frameCount=n.op.metadata.frames.length,n._frame=0,n._loadFrame=0,n._frameImages=[],n._paused=!1,n._loadTimer=null,n._trailerBytes=3e4,n._failed=!1,n._debugLog("Frame count: "+n._frameCount),n._startLoad(),n.op.autoStart?n.play():n._paused=!0,n}return Object(y.a)(t,e),Object(o.a)(t,[{key:"_mkerr",value:function(e){var t=this;return function(){return t._error(e)}}},{key:"_error",value:function(e){throw this._failed=!0,new k(e)}},{key:"_debugLog",value:function(e){this.op.debug&&console.log(e)}},{key:"_load",value:function(){var e=Object(m.a)(p.a.mark(function e(t,n){var a,r,i,o,s,c,l;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Headers,void 0!==t&&void 0!==n&&(r=t+n,a.append("Range","bytes="+t+"-"+(r-1)),_&&(a.append("Cache-Control","no-cache"),a.append("If-None-Match",Math.random().toString()))),e.prev=2,i=new Request(this.op.source,Object(f.a)({mode:"cors",headers:a},_?{cache:"no-cache"}:void 0)),e.prev=4,e.next=7,fetch(i);case 7:o=e.sent,e.next=17;break;case 10:if(e.prev=10,e.t0=e.catch(4),!(j&&e.t0 instanceof TypeError)){e.next=16;break}return e.next=15,new Promise(function(e){return setTimeout(e,200)});case 15:return e.abrupt("return",this._load(t,n));case 16:throw e.t0;case 17:if(!this._dead){e.next=19;break}return e.abrupt("return",void 0);case 19:if(this._debugLog("Load: "+t+" "+n+" status="+o.status),200!==o.status){e.next=30;break}return this._debugLog("Range disabled or unsupported, complete load"),e.next=24,o.arrayBuffer();case 24:return s=e.sent,c=s.byteLength,this._len=c,this._buf=s,this._bytes=new Uint8Array(this._buf),e.abrupt("return",{off:t||0,len:c});case 30:return 206!==o.status&&this._error("Unexpected HTTP status "+o.status),e.next=33,o.arrayBuffer();case 33:return(l=e.sent).byteLength!==n&&this._error("Unexpected length "+l.byteLength+" (expected "+n+")"),this._bytes.set(new Uint8Array(l),t),e.abrupt("return",{off:t,len:n});case 39:e.prev=39,e.t1=e.catch(2),this._mkerr("Fetch failed");case 42:case"end":return e.stop()}},e,this,[[2,39],[4,10]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"_startLoad",value:function(){var e=Object(m.a)(p.a.mark(function e(){var t,n,a,r,i,o,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.op.source){e.next=3;break}return this._loadNextFrame(),e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch(this.op.source,{method:"HEAD"});case 6:if((t=e.sent).ok){e.next=9;break}throw t;case 9:if(!this._dead){e.next=11;break}return e.abrupt("return");case 11:if(this._pHead=0,this._pNextHead=0,this._pFetch=0,n=parseInt(t.headers.get("Content-Length"),10)){e.next=27;break}return this._debugLog("HEAD request failed: invalid file length."),this._debugLog("Falling back to full file mode."),e.next=20,this._load(void 0,void 0);case 20:if(void 0!==(a=e.sent)){e.next=23;break}return e.abrupt("return");case 23:return r=a.len,this._pTail=0,this._pHead=r,e.abrupt("return",this._findCentralDirectory());case 27:return this._debugLog("Len: "+n),this._len=n,this._buf=new ArrayBuffer(n),this._bytes=new Uint8Array(this._buf),(i=n-this._trailerBytes)<0&&(i=0),this._pTail=n,e.next=36,this._load(i,n-i);case 36:if(void 0!==(o=e.sent)){e.next=39;break}return e.abrupt("return");case 39:return s=o.off,this._pTail=s,e.abrupt("return",this._findCentralDirectory());case 44:e.prev=44,e.t0=e.catch(3),this._mkerr("Length fetch failed");case 47:case"end":return e.stop()}},e,this,[[3,44]])}));return function(){return e.apply(this,arguments)}}()},{key:"_findCentralDirectory",value:function(){var e=Object(m.a)(p.a.mark(function e(){var t,n,a,r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(101010256!==(t=new DataView(this._buf,this._len-22,22)).getUint32(0,!0)&&this._error("End of Central Directory signature not found"),n=t.getUint16(10,!0),a=t.getUint32(12,!0),!((r=t.getUint32(16,!0))<this._pTail)){e.next=9;break}return e.next=8,this._load(r,this._pTail-r);case 8:this._pTail=r;case 9:this._readCentralDirectory(r,a,n);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_readCentralDirectory",value:function(e,t,n){for(var a=new DataView(this._buf,e,t),r=0,i=0;i<n;i++){33639248!==a.getUint32(r,!0)&&this._error("Invalid Central Directory signature");var o=a.getUint16(r+10,!0),s=a.getUint32(r+24,!0),c=a.getUint16(r+28,!0),l=a.getUint16(r+30,!0),u=a.getUint16(r+32,!0),d=a.getUint32(r+42,!0);0!==o&&this._error("Unsupported compression method"),r+=46;for(var h=new Uint8Array(this._buf,e+r,c),p="",f=0;f<c;f++)p+=String.fromCharCode(h[f]);r+=c+l+u,this._files[p]={off:d,len:s}}this._pHead>=this._pTail?(this._pHead=this._len,this.dispatchEvent(this.createEvent("loadProgress",!1,{fraction:this._pHead/this._len})),this._loadNextFrame()):(this._loadNextChunk(),this._loadNextChunk())}},{key:"_loadNextChunk",value:function(){var e=Object(m.a)(p.a.mark(function e(){var t,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._pFetch>=this._pTail)){e.next=2;break}return e.abrupt("return");case 2:return t=this._pFetch,n=this.op.chunkSize,this._pFetch+n>this._pTail&&(n=this._pTail-this._pFetch),this._pFetch+=n,e.next=8,this._load(t,n);case 8:return t===this._pHead?(this._pNextHead?(this._pHead=this._pNextHead,this._pNextHead=0):this._pHead=t+n,this._pHead>=this._pTail&&(this._pHead=this._len),this.dispatchEvent(this.createEvent("loadProgress",!1,{fraction:this._pHead/this._len})),this._loadTimer||this._loadNextFrame()):this._pNextHead=t+n,e.abrupt("return",this._loadNextChunk());case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_fileDataStart",value:function(e){var t=new DataView(this._buf,e,30);return e+30+t.getUint16(26,!0)+t.getUint16(28,!0)}},{key:"_isFileAvailable",value:function(e){var t=this._files[e];return t||this._error("File "+e+" not found in ZIP"),!(this._pHead<t.off+30)&&this._pHead>=this._fileDataStart(t.off)+t.len}},{key:"_loadNextFrame",value:function(){if(!this._dead){var e=this._loadFrame;if(!(e>=this._frameCount)){var t=this.op.metadata.frames[e];if(!this.op.source)return this._loadFrame+=1,void this._loadImage(e,t.file,!1);if(this._isFileAvailable(t.file)){this._loadFrame+=1;var n,a=this._fileDataStart(this._files[t.file].off),r=a+this._files[t.file].len,i=this.op.metadata.mime_type||"image/png";if(URL){var o,s;if(this._buf.slice)o=this._buf.slice(a,r);else o=new ArrayBuffer(this._files[t.file].len),new Uint8Array(o).set(this._bytes.subarray(a,r));try{s=new Blob([o],{type:i})}catch(e){this._debugLog("Blob constructor failed. Trying BlobBuilder... ("+e.message+")");var c=new MSBlobBuilder;c.append(o),s=c.getBlob()}n=URL.createObjectURL(s),this._loadImage(e,n,!0)}else n="data:"+i+";base64,"+function(e,t,n){for(var a="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(e),o=n%3,s=t+n-o,c=t;c<s;c+=3){var l=i[c]<<16|i[c+1]<<8|i[c+2],u=(16515072&l)>>18,d=(258048&l)>>12,h=(4032&l)>>6,p=63&l;a+=r[u]+r[d]+r[h]+r[p]}if(1===o){var f=i[s],m=(252&f)>>2,v=(3&f)<<4;a+=r[m]+r[v]+"=="}else if(2===o){var g=i[s]<<8|i[s+1],b=(64512&g)>>10,y=(1008&g)>>4,k=(15&g)<<2;a+=r[b]+r[y]+r[k]+"="}return a}(this._buf,a,r-a),this._loadImage(e,n,!1)}}}}},{key:"_loadImage",value:function(e,t,n){var r=this,i=new Image,o=this.op.metadata.frames[e];i.addEventListener("load",function(){r._debugLog("Loaded "+o.file+" to frame "+e),n&&URL.revokeObjectURL(t),r._dead||(r._frameImages[e]=i,r.dispatchEvent(r.createEvent("frameLoaded",!1,{frame:e})),r._loadingState===a.Initial&&r._displayFrame(),e>=r._frameCount-1?(r._setLoadingState(a.Done),r._buf=null,r._bytes=null):!r._maxLoadAhead||e-r._frame<r._maxLoadAhead?r._loadNextFrame():r._loadTimer||(r._loadTimer=window.setTimeout(function(){r._loadTimer=null,r._loadNextFrame()},200)))}),i.src=t}},{key:"_setLoadingState",value:function(e){e!==this._loadingState&&(this._loadingState=e,this.dispatchEvent(this.createEvent("loadingStateChanged",!1,{state:e})))}},{key:"_displayFrame",value:function(){var e=this;if(!this._dead){var t=this.op.metadata.frames[this._frame];this._debugLog("Displaying frame: "+this._frame+" "+t.file);var n=this._frameImages[this._frame];if(!n)return this._debugLog("Image not available!"),void this._setLoadingState(a.Initial);this.op.autosize&&(this._context.canvas.width===n.width&&this._context.canvas.height===n.height||(this._context.canvas.width=n.width,this._context.canvas.height=n.height)),this._loadingState!==a.Loading&&this._setLoadingState(a.Loading),this._context.clearRect(0,0,this.op.canvas.width,this.op.canvas.height),this._context.drawImage(n,0,0),this.dispatchEvent(this.createEvent("frame",!1,{frame:this._frame})),this._paused||(this._timer=window.setTimeout(function(){e._timer=void 0,e._nextFrame()},t.delay))}}},{key:"_nextFrame",value:function(){if(this._frame>=this._frameCount-1){if(!this.op.loop)return void this.pause();this._frame=0}else this._frame+=1;this._displayFrame()}},{key:"play",value:function(){if(!this._dead&&this._paused){if(!this.dispatchEvent(this.createEvent("play",!0,{frame:this._frame})))return;this._paused=!1,this._displayFrame()}}},{key:"pause",value:function(){if(!this._dead&&!this._paused){if(!this.dispatchEvent(this.createEvent("pause",!0,{frame:this._frame})))return;this._timer&&clearTimeout(this._timer),this._paused=!0}}},{key:"rewind",value:function(){this._dead||(this._frame=0,this._timer&&clearTimeout(this._timer),this._displayFrame())}},{key:"stop",value:function(){this._debugLog("Stopped!"),this._dead=!0,this._timer&&clearTimeout(this._timer),this._loadTimer&&clearTimeout(this._loadTimer),this._frameImages=[],this._buf=null,this._bytes=null,this.dispatchEvent(this.createEvent("stop",!1,{}))}},{key:"getCurrentFrame",value:function(){return this._frame}},{key:"getLoadedFrames",value:function(){return this._frameImages.length}},{key:"getFrameCount",value:function(){return this._frameCount}},{key:"hasError",value:function(){return this._failed}}]),t}(w);n.d(t,"a",function(){return C});var C=function(){function e(t,n){var a=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,e),this.data=n,this.options=r,this.paused=!0,this.container=l()(t),e.supported?(r.autoSize||(this.size=e.size(n.size,r.maxWidth||r.maxSize,r.maxHeight||r.maxSize)||void 0),this.container.on("click.ugokuillustplayer",".play",function(){a.play()}).on("click.ugokuillustplayer",".pause",function(){a.pause()}).on("click.ugokuillustplayer",".toggle",function(){a.toggle()}).on("click.ugokuillustplayer",".stop",function(){a.stop()}).addClass("ready"),r.autoStart&&Object(d.a)().then(function(){a.play()})):this.container.addClass("outdated")}return Object(o.a)(e,[{key:"dispose",value:function(){this.container.off(".ugokuillustplayer").removeClass("ready"),l()(".player",this.container).empty()}},{key:"createCanvas",value:function(){return this.canvas=l()("<canvas>"),this.options.autoSize||this.canvas.attr({width:this.data.size[0],height:this.data.size[1]}).css({width:this.size[0],height:this.size[1]}),this.canvas.appendTo(l()(".player",this.container).empty()),this.canvas[0]}},{key:"load",value:function(){var t=this;if(!this.player){this.data.src,this.data,this.container.addClass("loading"),this.player=new O({canvas:this.createCanvas(),source:this.data.src,metadata:this.data,chunkSize:3e5,loop:!1!==this.options.loop,autoStart:!0,debug:!!u.default.development,autosize:!!this.options.autoSize}),this.player.addEventListener("loadingStateChanged",function(n){if(n.detail.state===a.Loading){t.container.removeClass("loading"),t.options.autoSize&&(t.size=e.size([t.canvas[0].width,t.canvas[0].height],t.options.maxWidth||t.options.maxSize,t.options.maxHeight||t.options.maxSize),t.canvas.css({width:t.size[0],height:t.size[1]}));var r=t.data.originalSize||u.default.context.illustSize;r&&(t.fullscreenSize=e.size(r,1920,1080)),t.fullscreenSize&&(t.fullscreenSize[0]>600||t.fullscreenSize[1]>600)?t.container.on("click",".full-screen",function(){return t.fullscreen()}):l()(".full-screen",t.container).remove()}});var n=this.options.effect;n&&this.player.addEventListener("frame",function(e){var a=e.detail.frame;n.call(t,a,t.canvas[0].getContext("2d"))}),this.onload&&this.onload.call(this)}}},{key:"fullscreen",value:function(){var t=this,n=this.container.next("._full-screen-container");if(0!==n.length){for(var a=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen",null],r=0;r<a.length;r++){var i=a[r];if(null===i)return void this.pause();if(n[0][i]){n[0][i]();break}}if(this.pause(),!s.a.ua.ie){if(this.fullscreenActive=!0,l()(document.documentElement).addClass("_full-screen"),!this.fullscreenPlayer){var o=this.fullscreenSize[0]<=600&&this.fullscreenSize[1]<=600?this.data:this.options.fullscreenData;if(void 0===o)return!1;o.size=this.fullscreenSize,n.on("click",".exit-full-screen",function(){return t.exitFullscreen()}),s.a.d.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){t.fullscreenActive&&(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?(t.fullscreenPlayer=void 0!==t.fullscreenPlayer?t.fullscreenPlayer:new e(l()("._ugoku-illust-player-container",n),o,{maxWidth:1920,maxHeight:1080}),t.fullscreenPlayer.play(),l()(".player",n).css({marginTop:Math.max(window.screen.height/2-o.size[1]/2,0)})):t.exitFullscreen())})}return!1}}}},{key:"exitFullscreen",value:function(){void 0!==this.fullscreenPlayer&&this.fullscreenPlayer.pause();for(var e=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen",null],t=0;t<e.length;t++){var n=e[t];if(null===n)return;if(document[n]){document[n]();break}}return this.fullscreenActive=!1,l()(document.documentElement).removeClass("_full-screen"),this.play(),!1}},{key:"play",value:function(){this.paused=!1,this.container.addClass("playing").removeClass("pausing"),this.player?this.player.play():this.load()}},{key:"pause",value:function(){this.player&&(this.paused=!0,this.container.removeClass("playing").addClass("pausing"),this.player.pause())}},{key:"toggle",value:function(){this.paused?this.play():this.pause()}},{key:"stop",value:function(){this.player&&(this.pause(),this.player.rewind())}}],[{key:"fullscreen",value:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement}},{key:"data",value:function(e,t){return l.a.extend(!0,{src:e.srcs[t]},e)}},{key:"size",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e)return null;var a=Object(r.a)(e,2),i=a[0],o=a[1],s=i/o,c=t/n,l=s>=c?Math.min(i,t):Math.min(o,n);return s>=c?[l,l/s]:[l*s,l]}}]),e}();C.supported="undefined"!=typeof File&&"undefined"!=typeof FileReader&&"undefined"!=typeof FormData},69:function(e,t,n){e.exports={wrapper:"_3im4cMX",checkmark:"VwYLz11",select:"_1r5f2lk",transparent:"_3GuNTFM",menuOption:"yyaRQQ1",focused:"_1QYG8NT",disabled:"_3AxNNlK",arrow:"_1sQZy5q",separator:"LmR9-HZ"}},70:function(e,t,n){e.exports={searchCustomTermDateContainer:"_3Boe00a",searchCustomTermDateButton:"X9s_V0M",searchCustomTermDateButtonSelected:"_2Bgzd2z",searchCustomTermDateBetween:"_2hUzxmE",searchCustomTermNoticeContainer:"_3L-Z8ly",searchCustomTermCalendar:"_2pyVpoh",searchCustomTermEnterButtonContainer:"bgY8b1A",searchCustomTermEnter:"_9Nc9iW0"}},71:function(e,t,n){e.exports={wrapper:"qQK2CNR",widgets:"_3oaNWfF",externalCounter:"_1I7El27",input:"_3QoUzhi",invalid:"_10m0Y4n",transparent:"_1gTFSRu",horizontalResize:"_1arm1QT",autoHeight:"_3dti9h3",doubleSpaced:"_2TbztyW",fullHeight:"_1g8N6pT"}},72:function(e,t,n){e.exports={icon:"ku0DouP",item:"_19dv-oE",unread:"_2bEtZRD",link:"_17dNNky",contentContainer:"_97lRcxG",name:"_17Bw1M6",text:"_3aq3qB9",date:"D6aFxOQ",fanboxSubscribingBadge:"-I-e63s",officialBadge:"C4sZiCS",systemBadge:"_1eaARjw"}},737:function(e,t,n){"use strict";n(736),n(735),n(734),n(731),n(730),n(729),n(255),n(726),n(725),n(723),n(722),n(721),n(719),n(718),n(383),n(717),n(716),n(715),n(714),n(713),n(712),n(711),n(710),n(708),n(707),n(706),n(705),n(704),n(703),n(702),n(701),n(700),n(699),n(698),n(697),n(696),n(695),n(694),n(693),n(692),n(691),n(689),n(687),n(686),n(685),n(684),n(683),n(682),n(681),n(680),n(679),n(678),n(677),n(676),n(675),n(673),n(672),n(671),n(414),n(670),n(669),n(668),n(375),n(371),n(666),n(665),n(663),n(662),n(661),n(660),n(659),n(658),n(657),n(656),n(655),n(654),n(653),n(652),n(370),n(651),n(650),n(649),n(648),n(647),n(369),n(368),n(239),n(645),n(644),n(643),n(642),n(641),n(640),n(639),n(638),n(637),n(636),n(635),n(634),n(633),n(632),n(631),n(630),n(629),n(628),n(627),n(626),n(625),n(624),n(623),n(622),n(362),n(621),n(620),n(619),n(618),n(617),n(616),n(615),n(614),n(613),n(360),n(235),n(155),n(359),n(612),n(611)},78:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return s});var a,r,i=navigator.userAgent.includes("Trident/");function o(){if(void 0!==a)return a;a=!1;try{var e=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",t,e),window.removeEventListener("test",t)}catch(e){}return a;function t(){}}function s(){if(void 0!==r)return r;try{var e="__featureTest";(r="undefined"!=typeof localStorage&&(localStorage.setItem(e,e),localStorage.getItem(e)===e))&&localStorage.removeItem(e)}catch(e){r=!1}return r}}).call(this,n(77))},79:function(e,t,n){e.exports={button:"aZZT97B",forceBubbling:"_2fiIWaC",alt:"_2Rmicyf aZZT97B",bright:"_3mLf5lc",inverted:"a6emH90",primary:"_3HT4qAA aZZT97B",linkLike:"ou8BMHg aZZT97B",spaLinkLike:"_3Yz5Id2 ou8BMHg aZZT97B",danger:"_192p15s aZZT97B",big:"_3sVYVKo",middle:"_3cBmgzb",wide:"_1oy-IpC"}},82:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return d});var a=n(7),r=n(8),i=n(0),o=n.n(i),s=n(9),c=(n(349),n(23)),l=/\s+/;function u(){d.update()}var d=new(function(){function e(){Object(a.a)(this,e),this.filters=Object.create(null),this.selector=".ui-scroll-view"}return Object(r.a)(e,[{key:"add",value:function(e,t){var n=this,a="string"==typeof e?o()(e,t):o()(e);if(!a.length)return this;Object(c.a)("scrollView").debug("add target",a);var r=this.targets,i=!!r;return this.targets=(i?r.add(a):a).not(this.doneTargets),i||this.watch(),setTimeout(function(){return n.process()}),this}},{key:"remove",value:function(e,t){var n="string"==typeof e?o()(e,t):o()(e);return n.length&&this.targets?(this.targets=this.targets.not(n),0===this.targets.length&&this.clear(),this):this}},{key:"done",value:function(e,t){var n="string"==typeof e?o()(e,t):o()(e);return this.remove(n),this.doneTargets=this.doneTargets?this.doneTargets.add(n):n,this}},{key:"clear",value:function(){this.unwatch(),this.targets=void 0}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selector;return this.doneTargets&&(this.doneTargets=this.doneTargets.not(e)),this.add(e)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selector;this.add(e)}},{key:"watch",value:function(e){var t=this;e?o()(e).on("scroll.scroll-view",s.default.throttle(function(){return t.process()})):s.default.w.on("scroll.scroll-view resize.scroll-view",s.default.throttle(function(){return t.process()}))}},{key:"unwatch",value:function(e){e?o()(e).off(".scroll-view"):s.default.w.off(".scroll-view")}},{key:"process",value:function(){if(this.targets){var e=Array.from(this.targets),t=s.default.w,n=this.filters,a=t.scrollLeft(),r=a+t.width(),i=t.scrollTop(),c=i+t.height(),u=[],d=!0,h=!1,p=void 0;try{for(var f,m=e.map(function(e){return o()(e)})[Symbol.iterator]();!(d=(f=m.next()).done);d=!0){var v=f.value,g=v.data();if(g){var b=g.filter;if(b){var y=v.offset();if(y.left>=a&&y.left<r&&y.top>=i-200&&y.top<c+500){var k=!0,w=!1,_=void 0;try{for(var x,j=b.split(l)[Symbol.iterator]();!(k=(x=j.next()).done);k=!0){var O=x.value;if(n[O]&&!0===n[O](v))break}}catch(e){w=!0,_=e}finally{try{k||null==j.return||j.return()}finally{if(w)throw _}}u.push(v[0])}}}}}catch(e){h=!0,p=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw p}}this.done(u)}}},{key:"registerFilter",value:function(e,t,n){return this.filters[e]=t?n?t.bind(n):t:function(t){Object(c.a)("scrollView").debug("fire","".concat(s.default.letterCase(e,"prop")," (").concat(e,")"),t),t.triggerHandler(s.default.letterCase(e,"prop"))},this}},{key:"unregisterFilter",value:function(e){return delete this.filters[e],this}}]),e}())},83:function(e,t,n){e.exports={item:"_2vQlgA5",new:"_3gdn42t",unread:"_369OGU3",highlight:"_2pKmK0u",link:"_3N4EtQ-",content:"_13hSZOu",icon:"doXxRvY",profile:"_29d8rpv",contentContainer:"_2R4BdP5",date:"_393PPqL"}},88:function(e,t,n){e.exports={carouselContainer:"_31lQOb1",itemsContainer:"nqY8CtA",carousel:"_3wQcLdv",button:"_1LRb7F7",buttonContainer:"szP2TNK",right:"_3aS3hsj",left:"_2EXmid3"}},89:function(e,t,n){"use strict";function a(){return new Promise(function(e,t){setImmediate(e)})}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(t){setTimeout(t,e)})}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r})},9:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return c});var a=n(29),r=n(0),i=n.n(r),o=n(207),s=n(23),c={w:i()(window),d:i()(document),h:i()("html"),ua:o,config:{templates:{},timeout:3e4,apiCache:3e4}};c.id=function(e){var t=0;return function(){return t+++"."+ +new Date}}(),c.test={storage:function(){try{return!(!window.sessionStorage||!window.localStorage)}catch(e){return!1}}(),file:window.File&&window.FileReader&&window.FileList&&window.Blob},c.log=s.b,c.logger=s.a.bind(),c.logger.loggers=s.c,c.letterCase=function(e,t){var n=e.replace(/_([-A-Z\d]+)/g,"$1").replace(/(^|.)([-A-Z\d]+)/g,"$1_$2").replace(/([A-Z]+)([A-Z][a-z0-9])/g,"$1_$2").replace(/-/g,"");switch(t){case"css":n=n.replace(/_{2,}/g,"").replace(/_/g,"-").toLowerCase();break;case"class":n=(n=n.replace(/_([a-z]|[0-9])/gi,function(e,t){return t.toUpperCase()})).charAt(0).toUpperCase()+n.slice(1);break;case"prop":n=n.replace(/_([a-z]|[0-9])/gi,function(e,t){return t.toUpperCase()}).replace(/^[A-Z]+/,function(e,t){return t.toLowerCase()});break;default:n=n.toLowerCase()}return s.a("letterCase").debug(n),n},i()(function(){var e,t,n=i()("#init-config"),a=n.length?JSON.parse(n.val()):{};for(t in a){for(var r=t.split("."),o=window,s=0;s<r.length;s++)s===r.length-1?o[e=r[s]]="":(void 0===o[r[s]]&&(o[r[s]]={}),o=o[r[s]]);o[e]=a[t]}}),i.a.fn.values=function(e){var t=i()(this).find(":input").get(),n=e;if("object"!==Object(a.a)(n)){n={};var r=!0,o=!1,s=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var u=c.value;u.name&&!u.disabled&&(u.checked||/select|textarea/i.test(u.nodeName)||/text|hidden|password/i.test(u.type))&&(n[u.name]=i()(u).val())}}catch(e){o=!0,s=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}return n}var d=!0,h=!1,p=void 0;try{for(var f,m=t[Symbol.iterator]();!(d=(f=m.next()).done);d=!0){var v=f.value;v.name&&n[v.name]&&("checkbox"===v.type||"radio"===v.type?i()(v).prop("checked",n[v.name]===i()(v).val()):i()(v).val(n[v.name]))}}catch(e){h=!0,p=e}finally{try{d||null==m.return||m.return()}finally{if(h)throw p}}return i()(this)}},94:function(e,t,n){"use strict";n.d(t,"d",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return u});var a,r=n(11),i=n(32),o=n(36),s=n(159);function c(e){return{type:a.SetToken,payload:e}}!function(e){e.SetToken="pixiv/api/SET_TOKEN"}(a||(a={})),t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.SetToken:return Object(r.a)({},e,{token:t.payload});default:Object(o.b)(t)}return e};var l=function(e){return e.api.token||""},u=Object(i.createSelector)(function(e){return e.api.token},function(e){return new s.b(e)})},96:function(e,t,n){"use strict";function a(e){return void 0!==e.userData?void 0!==e.userData.self&&null!==e.userData.self&&e.userData.self.premium:!!pixiv.user.premium}function r(e){return void 0!==e.userData?null===e.userData.self||void 0===e.userData.self?null:e.userData.self.id:pixiv.user.id||null}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r})},97:function(e,t,n){e.exports={cardContainer:"wfQJ1lv",notificationCard:"_2E-trXu",cardEnter:"_3AyJTtN",cardEnterActive:"ejxNwl8",cardExit:"_1-TmwSL",cardExitActive:"SKoPf4B",text:"_1r7X8db",name:"_30yXGhc",userIcon:"sBo_PGf"}}}]);